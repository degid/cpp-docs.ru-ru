---
title: Схемы приемников событий
ms.date: 11/04/2016
helpviewer_keywords:
- event sink maps [MFC]
ms.assetid: a9757eb2-5f4a-45ec-a2cd-ce5eec85b16f
ms.openlocfilehash: 2cbfbc70ae14ccda95c377cb1587bf9d2a1ad3e6
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88837268"
---
# <a name="event-sink-maps"></a>Схемы приемников событий

Когда внедренный элемент управления OLE вызывает событие, контейнер элемента управления получает событие с помощью механизма, который называется "картой приемника событий", предоставляемой MFC. Эта схема приемника событий определяет функции обработчика для каждого конкретного события, а также параметры этих событий. Дополнительные сведения о картах приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="event-sink-maps"></a>Схемы приемников событий

|Имя|Описание|
|-|-|
|[BEGIN_EVENTSINK_MAP](#begin_eventsink_map)|Запускает определение схемы приемника событий.|
|[DECLARE_EVENTSINK_MAP](#declare_eventsink_map)|Объявляет карту приемника событий.|
|[END_EVENTSINK_MAP](#end_eventsink_map)|Завершает определение схемы приемника событий.|
|[ON_EVENT](#on_event)|Определяет обработчик событий для определенного события.|
|[ON_EVENT_RANGE](#on_event_range)|Определяет обработчик событий для определенного события, запускаемого из набора элементов управления OLE.|
|[ON_EVENT_REFLECT](#on_event_reflect)|Получает события, инициированные элементом управления, прежде чем они будут обработаны контейнером элемента управления.|
|[ON_PROPNOTIFY](#on_propnotify)|Определяет обработчик для обработки уведомлений о свойствах из элемента управления OLE.|
|[ON_PROPNOTIFY_RANGE](#on_propnotify_range)|Определяет обработчик для обработки уведомлений о свойствах из набора элементов управления OLE.|
|[ON_PROPNOTIFY_REFLECT](#on_propnotify_reflect)|Получает уведомления свойств, отправленные элементом управления, прежде чем они будут обработаны контейнером элемента управления.|

## <a name="begin_eventsink_map"></a><a name="begin_eventsink_map"></a> BEGIN_EVENTSINK_MAP

Начинает определение схемы приемника событий.

```
BEGIN_EVENTSINK_MAP(theClass, baseClass)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Указывает имя класса элемента управления, который сопоставлен с приемником событий.

*baseClass*<br/>
Задает имя базового класса *секласс*.

### <a name="remarks"></a>Примечания

В файле реализации (. cpp), который определяет функции-члены для класса, запустите карту приемников событий с помощью макроса BEGIN_EVENTSINK_MAP, добавьте записи макросов для каждого события, которое должно получать уведомления, и завершите карту приемника событий с помощью макроса END_EVENTSINK_MAP.

Дополнительные сведения о картах приемников событий и контейнерах элементов управления OLE см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="declare_eventsink_map"></a><a name="declare_eventsink_map"></a> DECLARE_EVENTSINK_MAP

Контейнер OLE может предоставить карту приемников событий для указания событий, о которых будет уведомлен ваш контейнер.

```
DECLARE_EVENTSINK_MAP()
```

### <a name="remarks"></a>Примечания

Используйте макрос DECLARE_EVENTSINK_MAP в конце объявления класса. Затем в. CPP, определяющий функции элементов для класса, использование макроса BEGIN_EVENTSINK_MAP, записей макросов для каждого события, о котором будет уведомлено, и макроса END_EVENTSINK_MAP для объявления конца списка приемников событий.

Дополнительные сведения о картах приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="requirements"></a>Требования

  **Заголовок** AFXWIN.h

## <a name="end_eventsink_map"></a><a name="end_eventsink_map"></a> END_EVENTSINK_MAP

Завершает определение схемы приемника событий.

```
END_EVENTSINK_MAP()
```

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="on_event"></a><a name="on_event"></a> ON_EVENT

Используйте макрос ON_EVENT, чтобы определить функцию обработчика событий для события, запускаемого элементом управления OLE.

```
ON_EVENT(theClass, id, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*идентификатор*<br/>
Идентификатор элемента управления OLE.

*DISPID*<br/>
Идентификатор диспетчеризации события, запускаемого элементом управления.

*пфнхандлер*<br/>
Указатель на функцию-член, которая обрабатывает событие. Эта функция должна иметь тип возвращаемого значения BOOL и типы параметров, соответствующие параметрам события (см. *втспарамс*). Функция должна возвращать значение TRUE, чтобы указать, что событие было обработано; в противном случае — FALSE.

*втспарамс*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Это те же константы, которые используются в записях карт диспетчеризации, таких как DISP_FUNCTION.

### <a name="remarks"></a>Примечания

Аргумент *втспарамс* представляет собой разделенный пробелами список значений из констант **VTS_** . Одно или несколько из этих значений, разделенных пробелами (а не запятыми), задает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Задает список, содержащий короткое целое число, за которым следует логическое значение.

Список констант **VTS_** см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="on_event_range"></a><a name="on_event_range"></a> ON_EVENT_RANGE

Используйте макрос ON_EVENT_RANGE, чтобы определить функцию обработчика событий для события, запускаемого любым элементом управления OLE, имеющим идентификатор элемента управления в непрерывном диапазоне идентификаторов.

```
ON_EVENT_RANGE(theClass, idFirst, idLast, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*идфирст*<br/>
Идентификатор элемента управления первого элемента управления OLE в диапазоне.

*идласт*<br/>
Идентификатор элемента управления последнего элемента управления OLE в диапазоне.

*DISPID*<br/>
Идентификатор диспетчеризации события, запускаемого элементом управления.

*пфнхандлер*<br/>
Указатель на функцию-член, которая обрабатывает событие. Эта функция должна иметь тип возвращаемого значения BOOL, первый параметр типа UINT (для идентификатора элемента управления) и дополнительные типы параметров, соответствующие параметрам события (см. *втспарамс*). Функция должна возвращать значение TRUE, чтобы указать, что событие было обработано; в противном случае — FALSE.

*втспарамс*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Первая константа должна иметь тип VTS_I4 для идентификатора элемента управления. Это те же константы, которые используются в записях карт диспетчеризации, таких как DISP_FUNCTION.

### <a name="remarks"></a>Примечания

Аргумент *втспарамс* представляет собой разделенный пробелами список значений из констант **VTS_** . Одно или несколько из этих значений, разделенных пробелами (а не запятыми), задает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Задает список, содержащий короткое целое число, за которым следует логическое значение.

Список констант **VTS_** см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="example"></a>Пример

В следующем примере показан обработчик событий для события MouseDown, реализованного для трех элементов управления (IDC_MYCTRL1 с помощью IDC_MYCTRL3). Функция обработчика событий ( `OnRangeMouseDown` ) объявляется в файле заголовка класса диалогового окна ( `CMyDlg` ) следующим образом:

[!code-cpp[NVC_MFCAutomation#12](../../mfc/codesnippet/cpp/event-sink-maps_2.h)]

Приведенный ниже код определен в файле реализации класса диалогового окна.

[!code-cpp[NVC_MFCAutomation#13](../../mfc/codesnippet/cpp/event-sink-maps_3.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="on_event_reflect"></a><a name="on_event_reflect"></a> ON_EVENT_REFLECT

Макрос ON_EVENT_REFLECT, используемый в схеме приемника событий класса-оболочки элемента управления OLE, получает события, инициированные элементом управления, прежде чем они будут обработаны контейнером элемента управления.

```
ON_EVENT_REFLECT(theClass,  dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*DISPID*<br/>
Идентификатор диспетчеризации события, запускаемого элементом управления.

*пфнхандлер*<br/>
Указатель на функцию-член, которая обрабатывает событие. Эта функция должна иметь тип возвращаемого значения BOOL и типы параметров, соответствующие параметрам события (см. *втспарамс*). Функция должна возвращать значение TRUE, чтобы указать, что событие было обработано; в противном случае — FALSE.

*втспарамс*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Это те же константы, которые используются в записях карт диспетчеризации, таких как DISP_FUNCTION.

### <a name="remarks"></a>Примечания

Аргумент *втспарамс* представляет собой разделенный пробелами список значений из констант **VTS_** .

Одно или несколько из этих значений, разделенных пробелами (а не запятыми), задает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Задает список, содержащий короткое целое число, за которым следует логическое значение.

Список констант **VTS_** см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="on_propnotify"></a><a name="on_propnotify"></a> ON_PROPNOTIFY

Используйте макрос ON_PROPNOTIFY, чтобы определить запись схемы приемника событий для обработки уведомлений свойств из элемента управления OLE.

```
ON_PROPNOTIFY(theClass, id, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*идентификатор*<br/>
Идентификатор элемента управления OLE.

*DISPID*<br/>
Идентификатор диспетчеризации свойства, участвующего в уведомлении.

*пфнрекуест*<br/>
Указатель на функцию-член, которая обрабатывает `OnRequestEdit` уведомление для этого свойства. Эта функция должна иметь тип возвращаемого значения BOOL и параметр **bool** <strong>\*</strong> . Эта функция должна присвоить параметру значение TRUE, чтобы свойство было изменено, а значение FALSE — запрещено. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

*пфнчанжед*<br/>
Указатель на функцию-член, которая обрабатывает `OnChanged` уведомление для этого свойства. Функция должна иметь тип возвращаемого значения BOOL и параметр UINT. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

### <a name="remarks"></a>Примечания

Аргумент *втспарамс* представляет собой разделенный пробелами список значений из констант **VTS_** . Одно или несколько из этих значений, разделенных пробелами (а не запятыми), задает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Задает список, содержащий короткое целое число, за которым следует логическое значение.

Список констант **VTS_** см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

## <a name="on_propnotify_range"></a><a name="on_propnotify_range"></a> ON_PROPNOTIFY_RANGE

Используйте макрос ON_PROPNOTIFY_RANGE, чтобы определить запись схемы приемника событий для обработки уведомлений о свойствах из любого элемента управления OLE, имеющего идентификатор элемента управления в непрерывном диапазоне идентификаторов.

```

ON_PROPNOTIFY_RANGE(theClass, idFirst, idLast, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*идфирст*<br/>
Идентификатор элемента управления первого элемента управления OLE в диапазоне.

*идласт*<br/>
Идентификатор элемента управления последнего элемента управления OLE в диапазоне.

*DISPID*<br/>
Идентификатор диспетчеризации свойства, участвующего в уведомлении.

*пфнрекуест*<br/>
Указатель на функцию-член, которая обрабатывает `OnRequestEdit` уведомление для этого свойства. Эта функция должна иметь `BOOL` тип возвращаемого значения `UINT` и `BOOL*` Параметры. Функция должна присвоить параметру значение TRUE, чтобы свойство было изменено, а значение FALSE — запрещено. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

*пфнчанжед*<br/>
Указатель на функцию-член, которая обрабатывает `OnChanged` уведомление для этого свойства. Функция должна иметь `BOOL` тип возвращаемого значения и `UINT` параметр. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="on_propnotify_reflect"></a><a name="on_propnotify_reflect"></a> ON_PROPNOTIFY_REFLECT

Макрос ON_PROPNOTIFY_REFLECT, используемый в схеме приемника событий класса-оболочки элемента управления OLE, получает уведомления о свойствах, отправленные элементом управления, прежде чем они будут обработаны контейнером элемента управления.

```

ON_PROPNOTIFY_REFLECT(theClass, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*секласс*<br/>
Класс, к которому принадлежит эта схема приемника событий.

*DISPID*<br/>
Идентификатор диспетчеризации свойства, участвующего в уведомлении.

*пфнрекуест*<br/>
Указатель на функцию-член, которая обрабатывает `OnRequestEdit` уведомление для этого свойства. Эта функция должна иметь тип возвращаемого значения BOOL и параметр **bool** <strong>\*</strong> . Эта функция должна присвоить параметру значение TRUE, чтобы свойство было изменено, а значение FALSE — запрещено. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

*пфнчанжед*<br/>
Указатель на функцию-член, которая обрабатывает `OnChanged` уведомление для этого свойства. Функция должна иметь тип возвращаемого значения BOOL и без параметров. Функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано; в противном случае — FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** афксдисп.h

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
