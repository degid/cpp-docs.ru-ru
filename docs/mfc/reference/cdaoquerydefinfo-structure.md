---
title: Структура CDaoQueryDefInfo
ms.date: 11/04/2016
f1_keywords:
- CDaoQueryDefInfo
helpviewer_keywords:
- DAO (Data Access Objects), QueryDefs collection
- CDaoQueryDefInfo structure [MFC]
ms.assetid: e20837dc-e78d-4171-a195-1b4075fb5d2a
ms.openlocfilehash: e2f0325237a30989637821464c63a4d8b8000b1e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368939"
---
# <a name="cdaoquerydefinfo-structure"></a>Структура CDaoQueryDefInfo

Структура `CDaoQueryDefInfo` содержит информацию об объекте запроса, определяемом для объектов доступа к данным (DAO).

## <a name="syntax"></a>Синтаксис

```
struct CDaoQueryDefInfo
{
    CString m_strName;               // Primary
    short m_nType;   // Primary
    COleDateTime m_dateCreated;      // Secondary
    COleDateTime m_dateLastUpdated;  // Secondary
    BOOL m_bUpdatable;               // Secondary
    BOOL m_bReturnsRecords;          // Secondary
    CString m_strSQL;                // All
    CString m_strConnect;            // All
    short m_nODBCTimeout;            // All
};
```

#### <a name="parameters"></a>Параметры

*m_strName*<br/>
Уникально называет объект querydef. Для получения дополнительной информации, см. Позвоните в [CDao-КуириДеф::GetName,](../../mfc/reference/cdaoquerydef-class.md#getname) чтобы получить это свойство напрямую.

*m_nType*<br/>
Значение, указывававшем рабочий тип объекта запроса. Он может иметь одно из следующих значений:

- `dbQSelect`Выберите — запрос выбирает записи.

- `dbQAction`Действие — запрос перемещает или изменяет данные, но не возвращает записи.

- `dbQCrosstab`Crosstab — запрос возвращает данные в формате, похожем на электронную таблицу.

- `dbQDelete`Удаление — запрос удаляет набор указанных строк.

- `dbQUpdate`Обновление — запрос изменяет набор записей.

- `dbQAppend`Приложение — запрос добавляет новые записи в конец таблицы или запроса.

- `dbQMakeTable`Make-таблица - запрос создает новую таблицу из набора записей.

- `dbQDDL`Определение данных — запрос влияет на структуру таблиц или их частей.

- `dbQSQLPassThrough`Pass-through - заявление S'L передается непосредственно в бэкэнд базы данных, без промежуточной обработки.

- `dbQSetOperation`Соединение — запрос создает объект рекорда типа моментального снимка, содержащий данные из всех указанных записей в двух или более таблицах с удаленными дубликатами записей. Чтобы включить дубликаты, добавьте ключевое слово **ВСЕ** в выписку querydef's S'L.

- `dbQSPTBulk`Используется `dbQSQLPassThrough` для указания запроса, который не возвращает записи.

> [!NOTE]
> Для создания сквозного запроса S'L не `dbQSQLPassThrough` устанавливается константа. Это устанавливается автоматически движком базы данных Microsoft Jet при создании объекта запроса и установке свойства Connect.

Для получения дополнительной информации, см.

*m_dateCreated*<br/>
Дата и время создания запроса. Чтобы непосредственно восстановить дату создания запроса, позвоните функции члена `CDaoTableDef` [GetDateCreated](../../mfc/reference/cdaotabledef-class.md#getdatecreated) объекта, связанного с таблицей. Смотрите Комментарии ниже для получения дополнительной информации. Также смотрите тему "DateCreated, LastUpdated Свойства" в DAO Справка.

*m_dateLastUpdated*<br/>
Дата и время последнего изменения, внесенного в querydef. Чтобы непосредственно получить дату последнего обновления таблицы, позвоните в функцию участника [GetDateLastUpdated](../../mfc/reference/cdaoquerydef-class.md#getdatelastupdated) querydef. Смотрите Комментарии ниже для получения дополнительной информации. И смотрите тему "DateCreated, LastUpdated Свойства" в DAO Помощь.

*m_bUpdatable*<br/>
Указывается, можно ли вносить изменения в объект запроса. Если это свойство является правдой, querydef updatable; в противном случае, это не так. Updatable означает, что определение запроса объекта запроса может быть изменено. Свойство Updatable объекта querydef настроено на истину, если определение запроса может быть обновлено, даже если полученный рекордет не является updatable. Чтобы получить это свойство напрямую, позвоните в функцию [canUpdate](../../mfc/reference/cdaoquerydef-class.md#canupdate) участника querydef. Для получения дополнительной информации, смотрите тему "Updatable собственности" в DAO Помощь.

*m_bReturnsRecords*<br/>
Указывает, возвращает ли сквозной запрос на внешнюю базу данных, возвращает ли сквозной запрос с помощью s'L к внешней базе данных. Если это свойство является правдой, запрос возвращает записи. Чтобы получить это свойство, позвоните в [CDao-EryDef::GetReturnsRecords](../../mfc/reference/cdaoquerydef-class.md#getreturnsrecords). Не все сквозные запросы s'L к внешним базам данных возвращают записи. Например, заявление ОБ **ОБНОВЛЕНИС** З-Л обновляет записи без возврата записей, в то время как заявление S'L **SELECT** возвращает записи. Для получения дополнительной информации, см.

*m_strSQL*<br/>
Выписка, определяющая запрос, выполняемый объектом запроса. Свойство S'L содержит выписку по S'L, которая определяет, как записи подбираются, группируются и упорядочены при выполнении запроса. Запрос можно использовать для выбора записей для включения в объект записи типа динасета или моментального снимка. Можно также определить объемные запросы для изменения данных без возврата записей. Вы можете получить значение этого свойства непосредственно, позвонив в функцию участника [GetS'L](../../mfc/reference/cdaoquerydef-class.md#getsql) querydef.

*m_strConnect*<br/>
Предоставляет информацию об источнике базы данных, используемой в сквозном запросе. Эта информация принимает форму строки подключения. Для получения дополнительной информации о строках подключения, а также для [CDaoDatabase::GetConnect](../../mfc/reference/cdaodatabase-class.md#getconnect) получения информации о получении значения этого свойства непосредственно, см.

*m_nODBCTimeout*<br/>
Количество секунд, в течение чем движок базы данных Microsoft Jet ждет ошибки тайм-аута при запуске запроса в базе данных ODBC. При использовании базы данных ODBC, например, сервера Microsoft S'L Server, возможны задержки из-за сетевого трафика или интенсивного использования сервера ODBC. Вместо того, чтобы ждать бесконечно, можно указать, как долго будет ждать движок Microsoft Jet, прежде чем он производит ошибку. Значение тайм-аута по умолчанию составляет 60 секунд. Вы можете получить значение этого свойства непосредственно, позвонив в функцию участника [GetODBCTimeout](../../mfc/reference/cdaoquerydef-class.md#getodbctimeout) querydef. Для получения дополнительной информации, смотрите тему "ODBCTimeout собственности" в DAO Помощь.

## <a name="remarks"></a>Примечания

Запрос является объектом класса [CDao-КуириДеф](../../mfc/reference/cdaoquerydef-class.md). Ссылки на Первоначальное, Вторичное и Все вышеперечисленное указывает на то, `CDaoDatabase`как информация возвращается функцией участника [Get''sdefInfo](../../mfc/reference/cdaodatabase-class.md#getquerydefinfo) в классе.

Информация, полученная [в CDaoDatabase::Get'ruryDefInfo](../../mfc/reference/cdaodatabase-class.md#getquerydefinfo) `CDaoQueryDefInfo` функция хранится в структуре. Вызов `GetQueryDefInfo` объекта базы данных, в коллекционире которого queryDefs, хранится объект querydef. `CDaoQueryDefInfo`также определяет `Dump` функцию члена в сборках отладок. Содержимое `CDaoQueryDefInfo` `Dump` объекта можно использовать. Класс `CDaoDatabase` также предоставляет функции членов для прямого доступа `CDaoQueryDefInfo` ко всем свойствам, возвращенным `GetQueryDefInfo`в объект, так что вам, вероятно, редко придется звонить.

При добавлении нового объекта поля или параметра к сбору полей или параметров объекта querydef бросается исключение, если базовая база данных не поддерживает тип данных, указанный для нового объекта.

Настройки даты и времени получены из компьютера, на котором был создан или последний обновлялся. В многопользовательской среде пользователи должны получать эти настройки непосредственно с файлового сервера, используя команду **чистого времени,** чтобы избежать расхождений в настройках свойств DateCreated и LastUpdated.

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

## <a name="see-also"></a>См. также раздел

[Структуры, стили, обратные вызовы и схемы сообщений](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)<br/>
[Класс CДао-КуириДеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[CDaoDatabase Класс](../../mfc/reference/cdaodatabase-class.md)
