---
title: CDaoDatabase Класс
ms.date: 09/17/2019
f1_keywords:
- CDaoDatabase
- AFXDAO/CDaoDatabase
- AFXDAO/CDaoDatabase::CDaoDatabase
- AFXDAO/CDaoDatabase::CanTransact
- AFXDAO/CDaoDatabase::CanUpdate
- AFXDAO/CDaoDatabase::Close
- AFXDAO/CDaoDatabase::Create
- AFXDAO/CDaoDatabase::CreateRelation
- AFXDAO/CDaoDatabase::DeleteQueryDef
- AFXDAO/CDaoDatabase::DeleteRelation
- AFXDAO/CDaoDatabase::DeleteTableDef
- AFXDAO/CDaoDatabase::Execute
- AFXDAO/CDaoDatabase::GetConnect
- AFXDAO/CDaoDatabase::GetName
- AFXDAO/CDaoDatabase::GetQueryDefCount
- AFXDAO/CDaoDatabase::GetQueryDefInfo
- AFXDAO/CDaoDatabase::GetQueryTimeout
- AFXDAO/CDaoDatabase::GetRecordsAffected
- AFXDAO/CDaoDatabase::GetRelationCount
- AFXDAO/CDaoDatabase::GetRelationInfo
- AFXDAO/CDaoDatabase::GetTableDefCount
- AFXDAO/CDaoDatabase::GetTableDefInfo
- AFXDAO/CDaoDatabase::GetVersion
- AFXDAO/CDaoDatabase::IsOpen
- AFXDAO/CDaoDatabase::Open
- AFXDAO/CDaoDatabase::SetQueryTimeout
- AFXDAO/CDaoDatabase::m_pDAODatabase
- AFXDAO/CDaoDatabase::m_pWorkspace
helpviewer_keywords:
- CDaoDatabase [MFC], CDaoDatabase
- CDaoDatabase [MFC], CanTransact
- CDaoDatabase [MFC], CanUpdate
- CDaoDatabase [MFC], Close
- CDaoDatabase [MFC], Create
- CDaoDatabase [MFC], CreateRelation
- CDaoDatabase [MFC], DeleteQueryDef
- CDaoDatabase [MFC], DeleteRelation
- CDaoDatabase [MFC], DeleteTableDef
- CDaoDatabase [MFC], Execute
- CDaoDatabase [MFC], GetConnect
- CDaoDatabase [MFC], GetName
- CDaoDatabase [MFC], GetQueryDefCount
- CDaoDatabase [MFC], GetQueryDefInfo
- CDaoDatabase [MFC], GetQueryTimeout
- CDaoDatabase [MFC], GetRecordsAffected
- CDaoDatabase [MFC], GetRelationCount
- CDaoDatabase [MFC], GetRelationInfo
- CDaoDatabase [MFC], GetTableDefCount
- CDaoDatabase [MFC], GetTableDefInfo
- CDaoDatabase [MFC], GetVersion
- CDaoDatabase [MFC], IsOpen
- CDaoDatabase [MFC], Open
- CDaoDatabase [MFC], SetQueryTimeout
- CDaoDatabase [MFC], m_pDAODatabase
- CDaoDatabase [MFC], m_pWorkspace
ms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d
ms.openlocfilehash: 0fbc4ee3f2033f7507a1ed68493fa7e48bc62c51
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754739"
---
# <a name="cdaodatabase-class"></a>CDaoDatabase Класс

Представляет собой подключение к базе данных Access с использованием объектов доступа к данным (DAO). DAO поддерживается через Office 2013. DAO 3.6 является окончательной версией, и он считается устаревшим.

## <a name="syntax"></a>Синтаксис

```
class CDaoDatabase : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase::CDaoDatabase](#cdaodatabase)|Формирует объект `CDaoDatabase`. Вызов `Open` для подключения объекта к базе данных.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase::CanTransact](#cantransact)|Возвращает ненулевой, если база данных поддерживает транзакции.|
|[CDaoDatabase:CanUpdate](#canupdate)|Возвращает ненулевой, если `CDaoDatabase` объект updatable (не только читать).|
|[CDaoDatabase::Закрыть](#close)|Закрывает подключение к базе данных.|
|[CDaoDatabase::Создание](#create)|Создает базовый объект базы данных DAO и инициализирует `CDaoDatabase` объект.|
|[CDaoDatabase::CreateRelation](#createrelation)|Определяет новое отношение между таблицами в базе данных.|
|[CDaoDatabase::Delete'e'e'ryDef](#deletequerydef)|Удаляет объект querydef, сохраненный в коллекции queryDefs базы данных.|
|[CDaoDatabase::DeleteОтношение](#deleterelation)|Удаляет существующую связь между таблицами в базе данных.|
|[CDaoDatabase::DeleteTableDef](#deletetabledef)|Удаляет определение таблицы в базе данных. Это удаляет фактическую таблицу и все ее данные.|
|[CDaoDatabase::Execute](#execute)|Выполняет запрос действия. Вызов `Execute` запроса, который возвращает результаты, выбрасывает исключение.|
|[CDaoDatabase:GetConnect](#getconnect)|Возвращает строку соединения, `CDaoDatabase` используемую для подключения объекта, в базу данных. Используется для ODBC.|
|[CDaoDatabase::GetName](#getname)|Возвращает имя базы данных, которая в настоящее время используется.|
|[CDaoDatabase::Get'ryDefCount](#getquerydefcount)|Возвращает количество запросов, определенных для базы данных.|
|[CDaoDatabase::Get'ruryDefInfo](#getquerydefinfo)|Возвращает информацию об определенном запросе, определенном в базе данных.|
|[CDaoDatabase::Get'ryTimeout](#getquerytimeout)|Возвращает количество секунд, после которых операции запроса базы данных будут тайм-аут. Влияет на все последующие открытые, добавлять новые, обновлять и отсеивать операции и другие операции на источниках данных ODBC (только), таких как `Execute` вызовы.|
|[CDaoDatabase::GetRecordsAffected](#getrecordsaffected)|Возвращает количество записей, затронутых последним обновлением, отображем `Execute`или добавлением операции или вызова.|
|[CDaoDatabase::GetRelationCount](#getrelationcount)|Возвращает количество отношений, определенных между таблицами в базе данных.|
|[CDaoDatabase::GetRelationInfo](#getrelationinfo)|Возвращает информацию об определенном отношении, определенном между таблицами в базе данных.|
|[CDaoDatabase::GetTableDefCount](#gettabledefcount)|Возвращает количество таблиц, определенных в базе данных.|
|[CDaoDatabase::GetTableDefInfo](#gettabledefinfo)|Возвращает информацию об указанной таблице в базу данных.|
|[CDaoDatabase::GetVersion](#getversion)|Возвращает версию движка базы данных, связанную с базой данных.|
|[CDaoDatabase::IsOpen](#isopen)|Возвращает ненулевой, если `CDaoDatabase` объект в настоящее время подключен к базе данных.|
|[CDaoDatabase::Открыто](#open)|Устанавливает подключение к базе данных.|
|[CDaoDatabase::Set'ryTimeout](#setquerytimeout)|Устанавливает количество секунд, после которых операции запроса базы данных (только по источникам данных ODBC) будут тайм-аут. Влияет на все последующие операции, открытые, добавляемые новые, обновляемые и удаляемые операции.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase:::m_pDAODatabase](#m_pdaodatabase)|Указатель на базовый объект базы данных DAO.|
|[CDaoDatabase::m_pWorkspace](#m_pworkspace)|Указатель на объект [CDaoWorkspace,](../../mfc/reference/cdaoworkspace-class.md) содержащий базу данных и определяющий пространство транзакций.|

## <a name="remarks"></a>Примечания

Для получения информации о поддерживаемых [GetName](../../mfc/reference/cdaoworkspace-class.md#getname) форматах баз данных см. Вы можете иметь `CDaoDatabase` один или несколько объектов, активных одновременно в данном "рабочем пространстве", представленном объектом [CDaoWorkspace.](../../mfc/reference/cdaoworkspace-class.md) Рабочее пространство поддерживает коллекцию открытых объектов базы данных, называемых коллекцией баз данных.

## <a name="usage"></a>Использование

При создании объектов записи можно создавать объекты базы данных неявно. Но вы также можете создавать объекты базы данных явно. Чтобы использовать существующую базу `CDaoDatabase`данных явно с , сделайте любой из следующих:

- Создайте объект `CDaoDatabase`, передав указатель на открытый объект [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md).

- Или построить `CDaoDatabase` объект без указания рабочего пространства (MFC создает временный объект рабочего пространства).

Создать новый Microsoft Jet (. MDB) базы данных, построить `CDaoDatabase` объект и вызвать его Функция члена [Создания.](#create) Не *звоните* `Open` после `Create`.

Чтобы открыть существующую базу `CDaoDatabase` данных, постройте объект и вызовите его функцию [Open](#open) member.

Любой из этих методов прикладывает объект базы данных DAO к сбору баз данных рабочего пространства и открывает подключение к данным. При построении [CDaoRecordset,](../../mfc/reference/cdaorecordset-class.md) [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)или объектов [CDao-''''erryDef](../../mfc/reference/cdaoquerydef-class.md) для работы на подключенной базе данных, передайте конструкторам для этих объектов указатель на объект. `CDaoDatabase` Когда вы закончите использовать соединение, позвоните `CDaoDatabase` функции участника [Close](#close) и уничтожьте объект. `Close`закрывает все записи, которые вы не закрывали ранее.

## <a name="transactions"></a>Transactions

Обработка транзакций базы данных поставляется на уровне рабочего пространства - см. функции участников `CDaoWorkspace` [класса BeginTrans,](../../mfc/reference/cdaoworkspace-class.md#begintrans) [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#committrans)и [Rollback.](../../mfc/reference/cdaoworkspace-class.md#rollback)

## <a name="odbc-connections"></a>Подключения ODBC

Рекомендуемый способ работы с источниками данных ODBC заключается в присоединении внешних таблиц к Microsoft Jet (. MDB) базы данных.

## <a name="collections"></a>Коллекции

Каждая база данных поддерживает свои собственные коллекции объектов таблицы, querydef, recordset и соотношения. Класс `CDaoDatabase` поставляет функции участника для манипулирования этими объектами.

> [!NOTE]
> Объекты хранятся в DAO, а не в объекте базы данных MFC. MFC поставляет классы для объектов таблицы, запроса и записи, но не для объектов соотношения.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoDatabase`

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

## <a name="cdaodatabasecantransact"></a><a name="cantransact"></a>CDaoDatabase::CanTransact

Позвоните в эту функцию участника, чтобы определить, позволяет ли база данных транзакции.

```
BOOL CanTransact();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если база данных поддерживает транзакции; в противном случае 0.

### <a name="remarks"></a>Примечания

Транзакции управляются в рабочей области базы данных.

## <a name="cdaodatabasecanupdate"></a><a name="canupdate"></a>CDaoDatabase:CanUpdate

Вызовите эту функцию `CDaoDatabase` участника, чтобы определить, позволяет ли объект обновлять.

```
BOOL CanUpdate();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, `CDaoDatabase` если объект позволяет обновления; в противном случае 0, указывая либо, что `CDaoDatabase` вы прошли правду в *bReadТолько* когда вы открыли объект или что сама база данных читается только. Просмотрите функцию [«Открытый](#open) участник».

### <a name="remarks"></a>Примечания

Для получения информации о updatability базы данных, см.

## <a name="cdaodatabasecdaodatabase"></a><a name="cdaodatabase"></a>CDaoDatabase::CDaoDatabase

Формирует объект `CDaoDatabase`.

```
CDaoDatabase(CDaoWorkspace* pWorkspace = NULL);
```

### <a name="parameters"></a>Параметры

*pWorkspace*<br/>
Указатель на `CDaoWorkspace` объект, который будет содержать новый объект базы данных. Если вы принимаете значение NULL по умолчанию, конструктор создает временный `CDaoWorkspace` объект, который использует рабочее пространство DAO по умолчанию. Вы можете получить указатель на объект рабочего пространства через [m_pWorkspace](#m_pworkspace) членом данных.

### <a name="remarks"></a>Примечания

После построения объекта, если вы создаете новый Microsoft Jet (. MDB) базы данных, вызов функции члена объекта [Create.](#create) Если вместо этого вы открываете существующую базу данных, позвоните в функцию [«Открытая](#open) функция» объекта.

Когда вы закончите с объектом, вы должны вызвать его функцию [Закрыть,](#close) а затем уничтожить `CDaoDatabase` объект.

Возможно, вам будет удобно `CDaoDatabase` встраивать объект в класс документов.

> [!NOTE]
> Объект `CDaoDatabase` также создается неявно, если вы открываете объект [CDaoRecordset,](../../mfc/reference/cdaorecordset-class.md) не передавая указатель на существующий `CDaoDatabase` объект. Этот объект базы данных закрывается при закрытии объекта регистрации.

## <a name="cdaodatabaseclose"></a><a name="close"></a>CDaoDatabase::Закрыть

Вызовите эту функцию участника, чтобы отключиться от базы данных и закрыть все открытые записи, таблицы и запросы, связанные с базой данных.

```
virtual void Close();
```

### <a name="remarks"></a>Примечания

Это хорошая практика, чтобы закрыть эти объекты самостоятельно, прежде чем вы называете эту функцию члена. Закрытие `CDaoDatabase` объекта удаляет его из коллекции баз данных в связанном [рабочем пространстве.](../../mfc/reference/cdaoworkspace-class.md) Поскольку `Close` `CDaoDatabase` объект не разрушается, можно повторно использовать объект, открыв ту же базу данных или другую базу данных.

> [!CAUTION]
> Вызов функции участника [обновления](../../mfc/reference/cdaorecordset-class.md#update) (если есть ожидающие редиксы) и функции `Close` участника на всех открытых объектах набора записей перед закрытием базы данных. Если вы выходите из функции, декларирует [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) или `CDaoDatabase` объекты в стеке, база данных закрывается, все несохраненные изменения теряются, все ожидающие транзакции откатываются, и все ожидающие изменения в ваших данных теряются.

> [!CAUTION]
> Если вы попытаетесь закрыть объект базы данных во время открытия любых объектов записи, или если вы попытаетесь закрыть объект рабочего пространства, пока открыты объекты базы данных, принадлежащие этому конкретному рабочему пространству, эти объекты записи будут закрыты и любые ожидающие обновления или изменения будут отброшены. Если вы попытаетесь закрыть объект рабочего пространства во время открытия любых объектов базы данных, принадлежащих ему, операция закрывает все объекты базы данных, принадлежащие этому конкретному объекту рабочего пространства, что может привести к закрытию незакрытых объектов регистрации. Если вы не закрываете объект базы данных, MFC сообщает о сбое утверждения в сборках отладок.

Если объект базы данных определен вне сферы действия функции и вы выходите из функции, не закрывая ее, объект базы данных будет оставаться открытым до явного закрытия или модуль, в котором он определен, выходит за рамки.

## <a name="cdaodatabasecreate"></a><a name="create"></a>CDaoDatabase::Создание

Создать новый Microsoft Jet (. MDB) базы данных, вызов эту `CDaoDatabase` функцию члена после построения объекта.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int dwOptions = 0);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Выражение строки, которое является именем создаваемого файла базы данных. Это может быть полный путь и имя\\файла, например, "C: MYDB. MDB". Вы должны предоставить имя. Если вы не предоставите расширение файла, . MDB придатим. Если ваша сеть поддерживает единую конвенцию именования (UNC),\\\\\\вы также\\можете\\указать\\сетевой путь, например, «MYSERVER »MYSHARE »MYDIR »MYDB». Только Microsoft Jet (. MDB) файлы базы данных могут быть созданы с помощью этой функции члена. (Двойные задние слэши необходимы в\\строках буквальных, потому что " является c q'побег характер.)

*lpszLocale*<br/>
Выражение строки, используемое для определения порядка коллажа для создания базы данных. Значение по умолчанию — `dbLangGeneral`. Возможны следующие значения:

- `dbLangGeneral`Английский, немецкий, французский, португальский, итальянский и современный испанский

- `dbLangArabic`арабский

- `dbLangCyrillic`русский

- `dbLangCzech`чешский

- `dbLangDutch`нидерландский

- `dbLangGreek`греческий

- `dbLangHebrew`иврит

- `dbLangHungarian`венгерский

- `dbLangIcelandic`исландский

- `dbLangNordic`Скандинавские языки (только версия движка базы данных Microsoft Jet 1.0)

- `dbLangNorwdan`Норвежский и датский

- `dbLangPolish`польский

- `dbLangSpanish`Традиционный испанский

- `dbLangSwedfin`Шведский и финский языки

- `dbLangTurkish`турецкий

*dwOptions*<br/>
Несколько вариантов указаны. Возможны следующие значения:

- `dbEncrypt`Создайте зашифрованную базу данных.

- `dbVersion10`Создайте базу данных с версией базы данных Microsoft Jet 1.0.

- `dbVersion11`Создайте базу данных с версией базы данных Microsoft Jet 1.1.

- `dbVersion20`Создайте базу данных с версией базы данных Microsoft Jet 2.0.

- `dbVersion30`Создайте базу данных с версией базы данных Microsoft Jet 3.0.

Если вы не запустите постоянную шифрование, создается незашифрованная база данных. Можно указать только одну константу версии. Если вы не запустите постоянную версию, создается база данных, используюая версию базы данных Microsoft Jet 3.0.

> [!CAUTION]
> Если база данных не зашифрована, можно, даже если вы реализуете безопасность пользователя/пароля, непосредственно читать файл бинарного диска, который является базой данных.

### <a name="remarks"></a>Примечания

`Create`создает файл базы данных и базовый объект базы данных DAO и инициализирует объект СЗЗ. Объект приобщен к сбору баз данных связанного рабочего пространства. Объект базы данных находится в открытом состоянии; не `Open*` звоните `Create`после .

> [!NOTE]
> С `Create`помощью , вы можете создать только Microsoft Jet (. MDB) баз данных. Нельзя создавать базы данных ISAM или базы данных ODBC.

## <a name="cdaodatabasecreaterelation"></a><a name="createrelation"></a>CDaoDatabase::CreateRelation

Вызовите эту функцию участника, чтобы установить связь между одним или несколько юнными полями в основной таблице в базе данных и одним или несколько полями в иностранной таблице (другая таблица в базе данных).

```cpp
void CreateRelation(
    LPCTSTR lpszName,
    LPCTSTR lpszTable,
    LPCTSTR lpszForeignTable,
    long lAttributes,
    LPCTSTR lpszField,
    LPCTSTR lpszForeignField);

void CreateRelation(CDaoRelationInfo& relinfo);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Уникальное название объекта связи. Имя должно начинаться с буквы и может содержать не более 40 символов. Он может включать числа и подчеркивать символы, но не может включать знаки препинания или пробелы.

*lpszTable*<br/>
Название основной таблицы в соотношении. Если таблицы не существует, MFC бросает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

*lpszForeignTable*<br/>
Название иностранного стола в отношениях. Если таблицы не существует, MFC бросает `CDaoException`исключение типа.

*lАтрибуты*<br/>
Длинное значение, содержащее информацию о типе отношений. Это значение можно использовать для обеспечения, среди прочего, целостности референтов. Вы можете использовать оператора bitwise-OR **(&#124;), **чтобы объединить любое из следующих значений (до тех пор, как комбинация имеет смысл):

- `dbRelationUnique`Отношения – это один на один.

- `dbRelationDontEnforce`Отношения не применяются (без референциальной целостности).

- `dbRelationInherited`Связь существует в нетекущей базе данных, содержащей две прилагаемые таблицы.

- `dbRelationUpdateCascade`Обновления будут каскадом (подробнее о каскадах, см. Замечания).

- `dbRelationDeleteCascade`Удаления будут каскадом.

*lpszField*<br/>
Указатель на нулевую строку, содержащую имя поля в основной таблице (названо *lpszTable).*

*lpszForeignField*<br/>
Указатель на нулевую строку, содержащую название поля в иностранной таблице (названной *lpszForeignTable).*

*relinfo*<br/>
Ссылка на объект [CDaoRelationInfo,](../../mfc/reference/cdaorelationinfo-structure.md) содержащий информацию о отношении, которое вы хотите создать.

### <a name="remarks"></a>Примечания

Связь не может включать запрос или прилагаемую таблицу из внешней базы данных.

Используйте первую версию функции, когда отношение включает в себя одно поле в каждой из двух таблиц. Используйте вторую версию, когда отношение включает в себя несколько полей. Максимальное количество полей в соотношении составляет 14.

Это действие создает базовый объект отношения DAO, но это деталь реализации MFC, так как `CDaoDatabase`инкапсуляция объектов связи MFC содержится в классе. МФЦ не поставляет класс для отношений.

Если вы установите атрибуты объекта связи для активации каскадных операций, движок базы данных автоматически обновляет или удаляет записи в одной или нескольких других таблицах, когда вносятся изменения в связанные основные ключевые таблицы.

Например, предположим, что вы установите отношения каскадного удаления между таблицей Заказчиков и таблицей заказов. При удалении записей из таблицы Заказчиков также удаляются записи в таблице заказов, связанные с этим клиентом. Кроме того, если вы устанавливаете отношения каскадного удаления между таблицей заказов и другими таблицами, записи из этих таблиц автоматически удаляются при удалении записей из таблицы Заказчиков.

Для получения соответствующей информации смотрите тему "СозданиеМетод отношения" в справке DAO.

## <a name="cdaodatabasedeletequerydef"></a><a name="deletequerydef"></a>CDaoDatabase::Delete'e'e'ryDef

Вызовите эту функцию участника, чтобы удалить указанный `CDaoDatabase` запрос - сохраненный запрос - из коллекции queryDefs объекта.

```cpp
void DeleteQueryDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя сохраненного запроса для удаления.

### <a name="remarks"></a>Примечания

После этого этот запрос больше не определяется в базе данных.

Для получения информации о создании [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)объектов запроса см. Объект querydef становится связанным `CDaoDatabase` с определенным объектом при построении `CDaoQueryDef` объекта, передавая его указателем объекту базы данных.

## <a name="cdaodatabasedeleterelation"></a><a name="deleterelation"></a>CDaoDatabase::DeleteОтношение

Вызовите эту функцию участника, чтобы удалить существующее отношение из коллекции отношений объекта базы данных.

```cpp
void DeleteRelation(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Название отношения к удалению.

### <a name="remarks"></a>Примечания

После этого отношения больше не существует.

Для получения соответствующей информации смотрите тему "Метод удаления" в справке DAO.

## <a name="cdaodatabasedeletetabledef"></a><a name="deletetabledef"></a>CDaoDatabase::DeleteTableDef

Вызовите эту функцию участника, чтобы удалить `CDaoDatabase` указанную таблицу и все ее данные из коллекции TableDefs объекта.

```cpp
void DeleteTableDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Название таблицы удалить.

### <a name="remarks"></a>Примечания

После этого эта таблица больше не определяется в базе данных.

> [!NOTE]
> Будьте очень осторожны, чтобы не удалить системные таблицы.

Для получения информации о создании [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)объектов таблицы, см. Объект таблицы становится связанным `CDaoDatabase` с определенным объектом при построении `CDaoTableDef` объекта, передавая его указателем объекту базы данных.

Для получения соответствующей информации смотрите тему "Метод удаления" в справке DAO.

## <a name="cdaodatabaseexecute"></a><a name="execute"></a>CDaoDatabase::Execute

Вызов ифункции этого элемента для выполнения запроса действия или выполнения оператора S'L в базе данных.

```cpp
void Execute(
    LPCTSTR lpszSQL,
    int nOptions = dbFailOnError);
```

### <a name="parameters"></a>Параметры

*lpszS'L*<br/>
Указатель на нулевую строку, содержащую действительную команду S'L для выполнения.

*nВарианты*<br/>
Неисчер, который определяет параметры, связанные с целостностью запроса. Вы можете использовать bitwise-OR оператора **(&#124;), **чтобы объединить любой из следующих констант `dbInconsistent` (при условии, что комбинация имеет смысл - например, вы бы не объединить с): `dbConsistent`

- `dbDenyWrite`Запретить писать разрешение другим пользователям.

- `dbInconsistent`(По умолчанию) Несовместимые обновления.

- `dbConsistent`Последовательные обновления.

- `dbSQLPassThrough`Проходной проход. Вызывает передачу оператора в код ODBC для обработки.

- `dbFailOnError`Откат обновлений в случае ошибки.

- `dbSeeChanges`Создайте ошибку времени выполнения, если другой пользователь изменяет данные, которые вы редактируете.

> [!NOTE]
> Если `dbInconsistent` оба `dbConsistent` и включены или если ни один из них не включен, результатом является по умолчанию. Объяснение этих констант читайте в справке DAO.ru на тему "Выполнить метод".

### <a name="remarks"></a>Примечания

`Execute`работает только для запросов действий или сквозных запросов S'L, которые не возвращают результаты. Он не работает для выбранных запросов, которые возвращают записи.

Для определения и информации о запросах действий см.

> [!TIP]
> Учитывая синтаксически корректное заявление S'L и надлежащие разрешения, функция `Execute` участника не потерпит неудачу, даже если ни одна строка не может быть изменена или удалена. Поэтому всегда используйте `dbFailOnError` опцию `Execute` при использовании функции участника для выполнения запроса обновления или удаления. Эта опция заставляет MFC выбросить исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md) и откатить все успешные изменения, если какая-либо из затронутых записей заблокирована и не может быть обновлена или удалена. Обратите внимание, что `GetRecordsAffected` вы всегда можете позвонить, чтобы увидеть, сколько записей было затронуто.

Позвоните в функцию члена [GetRecordsAffected](#getrecordsaffected) объекта базы данных, `Execute` чтобы определить количество записей, затронутых последним вызовом. Например, `GetRecordsAffected` возвращает информацию о количестве удаленных, обновленных или вставленных записей при выполнения запроса действий. Обратный счет не будет отражать изменения в смежных таблицах, когда каскад обновляется или удаляет в силе.

`Execute`не возвращает рекорд. Использование `Execute` запроса, который выбирает записи, заставляет MFC `CDaoException`выбросить исключение типа. (Нет функции `ExecuteSQL` `CDatabase::ExecuteSQL`члена, аналогичной .)

## <a name="cdaodatabasegetconnect"></a><a name="getconnect"></a>CDaoDatabase:GetConnect

Вызовите эту функцию участника для извлечения строки соединения, используемой для подключения `CDaoDatabase` объекта к базе данных ODBC или ISAM.

```
CString GetConnect();
```

### <a name="return-value"></a>Возвращаемое значение

Строка соединения, если [Open](#open) была успешно вызвана на источник данных ODBC; в противном случае, пустая строка. Для Microsoft Jet (. база данных MDB, строка всегда пуста, `dbSQLPassThrough` если вы не установите ее для использования с опцией, используемой с функцией участника [Выполнения](#execute) или используемой при открытии набора записей.

### <a name="remarks"></a>Примечания

Строка предоставляет информацию об источнике открытой базы данных или базе данных, используемой в сквозном запросе. Строка соединения состоит из разоспекта типа базы данных и нулевых или более параметров, разделенных запятыми.

> [!NOTE]
> Использование классов MFC DAO для подключения к источнику данных через ODBC менее эффективно, чем подключение через прилагаемую таблицу.

> [!NOTE]
> Строка соединения используется для передачи дополнительной информации ODBC и некоторым драйверам ISAM по мере необходимости. Он не используется для . Базы данных MDB. Для базовых таблиц базы данных Microsoft Jet строка соединения является пустой строкой (""), за исключением случаев, когда вы используете ее для сквозного запроса S'L, описанного в приведенном выше значении Return Value.

Ознакомьтесь с функцией [«Открытый](#open) член» для описания того, как создается строка соединения. После того, как строка `Open` соединения была установлена в вызове, вы можете использовать ее для проверки настройки для определения типа, пути, идентификатора пользователя, пароля или источника данных ODBC базы данных.

## <a name="cdaodatabasegetname"></a><a name="getname"></a>CDaoDatabase::GetName

Вызовите эту функцию участника, чтобы получить имя открытой в настоящее время базы данных, которая является именем существующего файла базы данных или именем зарегистрированного источника данных ODBC.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Полный путь и имя файла базы данных в случае успеха; в противном случае, пустой [CString](../../atl-mfc-shared/reference/cstringt-class.md).

### <a name="remarks"></a>Примечания

Если ваша сеть поддерживает единую конвенцию именования (UNC), вы\\\\\\также\\можете указать сетевой путь, например, «MYSERVER »MYSHARE\\»MYDIR\\»MYDB. MDB". (Двойные задние слэши необходимы в\\строках буквальных, потому что " является c q'побег характер.)

Например, вы можете отобразить это имя в заголовке. Если ошибка возникает во время извлечения имени, MFC выбрасывает исключение типа [CDaoException.](../../mfc/reference/cdaoexception-class.md)

> [!NOTE]
> Для повышения производительности при доступе к внешним базам данных мы рекомендуем прикрепить внешние таблицы баз данных к базе данных Microsoft Jet (. MDB), а не подключение непосредственно к источнику данных.

Тип базы данных указывается файлом или каталогом, на который указывает путь:

|Патимен указывает на.|Тип базы данных|
|--------------------------|-------------------|
|. Файл MDB|База данных Microsoft Jet (доступ к Microsoft)|
|Каталог, содержащий . DBF файл (ы)|база данных dBASE|
|Каталог, содержащий . Файл XLS|База данных Microsoft Excel|
|Каталог, содержащий . Файл PDX (ы)|База данных парадоксов|
|Каталог, содержащий отформатированные файлы текстовой базы данных|База данных текстового формата|

Для баз данных ODBC, таких как S'L Server и Oracle, строка соединения базы данных определяет имя источника данных (DSN), зарегистрированное ODBC.

## <a name="cdaodatabasegetquerydefcount"></a><a name="getquerydefcount"></a>CDaoDatabase::Get'ryDefCount

Вызовите эту функцию участника, чтобы получить количество запросов, определенных в коллекции queryDefs базы данных.

```
short GetQueryDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество запросов, определенных в базе данных.

### <a name="remarks"></a>Примечания

`GetQueryDefCount`полезно, если вам нужно проехать все запросы в коллекции queryDefs. Для получения информации о данном запросе в коллекции, [см.](#getquerydefinfo)

## <a name="cdaodatabasegetquerydefinfo"></a><a name="getquerydefinfo"></a>CDaoDatabase::Get'ruryDefInfo

Вызовите эту функцию участника для получения различного рода информации о запросе, определенном в базе данных.

```cpp
void GetQueryDefInfo(
    int nIndex,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetQueryDefInfo(
    LPCTSTR lpszName,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Индекс заданного запроса в коллекции queryDefs базы данных для поиска по индексу.

*querydefinfo*<br/>
Ссылка на объект [CDao-КуириДеффофо,](../../mfc/reference/cdaoquerydefinfo-structure.md) который возвращает запрашиваемую информацию.

*dwInfoOptions*<br/>
Параметры, которые определяют, какую информацию о записи для получения. Доступные варианты перечислены здесь вместе с тем, что они вызывают функцию, чтобы вернуться о рекорде:

- AFX_DAO_PRIMARY_INFO (по умолчанию) имя, тип

- AFX_DAO_SECONDARY_INFO Основная информация плюс: Дата создана, Дата последнего обновления, Возвращает записи, Updatable

- AFX_DAO_ALL_INFO Первичная и второстепенная информация плюс: S'L, Connect, ODBCTimeout

*lpszName*<br/>
Строка, содержащая имя запроса, определенного в базе данных, для поиска по имени.

### <a name="remarks"></a>Примечания

Предоставляются две версии функции, так что вы можете выбрать запрос либо по индексу в коллекции queryDefs базы данных, либо по имени запроса.

Для описания информации, возвращенной в *querydefinfo*, см. [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) Эта структура имеет членов, которые соответствуют пунктам информации, перечисленных выше в описании *dwInfoOptions*. Если вы запрашиваете один уровень информации, вы получите любые предыдущие уровни информации, а также.

## <a name="cdaodatabasegetquerytimeout"></a><a name="getquerytimeout"></a>CDaoDatabase::Get'ryTimeout

Вызов этой функции участника для получения текущего количества секунд, чтобы позволить, прежде чем последующие операции на подключенной базе данных будут приурочены.

```
short GetQueryTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Короткий ряд, содержащий значение тайм-аута в секундах.

### <a name="remarks"></a>Примечания

Операция может быть временной из-за проблем с доступом к сети, чрезмерного времени обработки запросов и так далее. В то время как настройка действует, она влияет на все открытые, добавляя `CDaoDatabase` новые, обновляя и удаляя операции на любых рекордных наборах, связанных с этим объектом. Вы можете изменить текущую настройку тайм-аута, позвонив в [Set'ryTimeout.](#setquerytimeout) Изменение значения тайм-аута запроса для записи после открытия не изменяет значение для записи. Например, последующие операции [Move](../../mfc/reference/cdaorecordset-class.md#move) не используют новое значение. Значение по умолчанию первоначально устанавливается при инициализации движка базы данных.

Значение по умолчанию для тайм-аутов запроса взято из реестра Windows. Если нет настройки реестра, по умолчанию 60 секунд. Не все базы данных поддерживают возможность установки значения тайм-аута запроса. Если вы установите значение тайм-аута запроса 0, тайм-аут не происходит; и связь с базой данных может прекратиться. Такое поведение может быть полезно во время разработки. Если вызов не удается, MFC бросает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

Для получения соответствующей информации смотрите тему «Недвижимость queryTimeout» в справке DAO.

## <a name="cdaodatabasegetrecordsaffected"></a><a name="getrecordsaffected"></a>CDaoDatabase::GetRecordsAffected

Вызовите эту функцию участника, чтобы определить количество записей, затронутых последним вызовом функции [участника Выполнения.](#execute)

```
long GetRecordsAffected();
```

### <a name="return-value"></a>Возвращаемое значение

Длинный целый ряд, содержащий количество записей, затронутых.

### <a name="remarks"></a>Примечания

Возвратное значение включает в себя количество записей, удаленных, обновленных или вставленных в запрос `Execute`действия, с помощью. Обратный счет не будет отражать изменения в смежных таблицах, когда каскад обновляется или удаляет в силе.

Для получения соответствующей информации, см.

## <a name="cdaodatabasegetrelationcount"></a><a name="getrelationcount"></a>CDaoDatabase::GetRelationCount

Позвоните этой функции участника, чтобы получить число отношений, определенных между таблицами в базе данных.

```
short GetRelationCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество взаимосвязей, определенных между таблицами в базе данных.

### <a name="remarks"></a>Примечания

`GetRelationCount`полезно, если вам нужно проехать через все определенные отношения в коллекции отношений базы данных. Чтобы получить информацию о данном отношении в коллекции, [см. GetRelationInfo](#getrelationinfo).

Чтобы проиллюстрировать концепцию отношения, рассмотрим таблицу поставщиков и таблицу Продуктов, которая может иметь отношения между собой один к многим. В этих отношениях один поставщик может поставить более одного продукта. Другие отношения – один на один и многие к многим.

## <a name="cdaodatabasegetrelationinfo"></a><a name="getrelationinfo"></a>CDaoDatabase::GetRelationInfo

Позвоните этой функции участника для получения информации об определенном отношении в коллекции отношений базы данных.

```cpp
void GetRelationInfo(
    int nIndex,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetRelationInfo(
    LPCTSTR lpszName,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Индекс объекта отношения в коллекции отношений базы данных для поиска по индексу.

*relinfo*<br/>
Ссылка на объект [CDaoRelationInfo,](../../mfc/reference/cdaorelationinfo-structure.md) который возвращает запрашиваемую информацию.

*dwInfoOptions*<br/>
Параметры, которые определяют, какая информация о связи с извлечением. Доступные варианты перечислены здесь вместе с тем, что они вызывают функцию, чтобы вернуться о связи:

- AFX_DAO_PRIMARY_INFO (по умолчанию) Имя, таблица, Иностранный стол

- AFX_DAO_SECONDARY_INFO атрибуты, полевая информация

Полевая информация — это объект [CDaoRelationFieldInfo,](../../mfc/reference/cdaorelationfieldinfo-structure.md) содержащий поля из основной таблицы, участвующие в соотношении.

*lpszName*<br/>
Строка, содержащая имя объекта отношения, для поиска по имени.

### <a name="remarks"></a>Примечания

Две версии этой функции обеспечивают доступ либо по индексу, либо по имени. Для описания информации, возвращенной в *relinfo*, см. [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) структуры. Эта структура имеет членов, которые соответствуют пунктам информации, перечисленных выше в описании *dwInfoOptions*. Если вы запрашиваете информацию на одном уровне, вы также получаете информацию на любых предыдущих уровнях.

> [!NOTE]
> При установке атрибутов объекта связи для активации`dbRelationUpdateCascades` каскадных операций (или), `dbRelationDeleteCascades`движок базы данных Microsoft Jet автоматически обновляет или удаляет записи в одной или нескольких других таблицах, когда вносятся изменения в связанные с ними основные ключевые таблицы. Например, предположим, что вы установите отношения каскадного удаления между таблицей Заказчиков и таблицей заказов. При удалении записей из таблицы Заказчиков также удаляются записи в таблице заказов, связанные с этим клиентом. Кроме того, если вы устанавливаете отношения каскадного удаления между таблицей заказов и другими таблицами, записи из этих таблиц автоматически удаляются при удалении записей из таблицы Заказчиков.

## <a name="cdaodatabasegettabledefcount"></a><a name="gettabledefcount"></a>CDaoDatabase::GetTableDefCount

Вызовите эту функцию участника, чтобы получить количество таблиц, определенных в базе данных.

```
short GetTableDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество таблиц, определенных в базе данных.

### <a name="remarks"></a>Примечания

`GetTableDefCount`полезно, если вам нужно проехать через все таблицы в коллекции TableDefs. Чтобы получить информацию о данной таблице в коллекции, [см. GetTableDefInfo](#gettabledefinfo).

## <a name="cdaodatabasegettabledefinfo"></a><a name="gettabledefinfo"></a>CDaoDatabase::GetTableDefInfo

Вызовите эту функцию участника для получения различного рода информации о таблице, определенной в базе данных.

```cpp
void GetTableDefInfo(
    int nIndex,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetTableDefInfo(
    LPCTSTR lpszName,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Индекс объекта таблицы в коллекции TableDefs базы данных для поиска по индексу.

*tabledefinfo*<br/>
Ссылка на объект [CDaoTableDefInfo,](../../mfc/reference/cdaotabledefinfo-structure.md) который возвращает запрашиваемую информацию.

*dwInfoOptions*<br/>
Параметры, которые определяют, какую информацию о таблице для извлечения. Доступные варианты перечислены здесь вместе с тем, что они вызывают функцию, чтобы вернуться о связи:

- AFX_DAO_PRIMARY_INFO (по умолчанию) Имя, Updatable, Атрибуты

- AFX_DAO_SECONDARY_INFO Основная информация плюс: Дата создана, Дата Последнее обновление, Название таблицы источника, Подключение

- AFX_DAO_ALL_INFO Первичная и второстепенная информация плюс: Правило валидации, Текст валидации, Подсчет записей

*lpszName*<br/>
Название объекта таблицы, для поиска по имени.

### <a name="remarks"></a>Примечания

Предоставляются две версии функции, так что вы можете выбрать таблицу либо по индексу в коллекции TableDefs базы данных, либо по названию таблицы.

Для описания информации, возвращенной в *tabledefinfo*, [см.](../../mfc/reference/cdaotabledefinfo-structure.md) Эта структура имеет членов, которые соответствуют пунктам информации, перечисленных выше в описании *dwInfoOptions*. Если вы запрашиваете информацию на одном уровне, вы получаете информацию и для любых предыдущих уровней.

> [!NOTE]
> Вариант AFX_DAO_ALL_INFO предоставляет информацию, которую можно получить медленно. В этом случае подсчет записей в таблице может занять очень много времени, если есть много записей.

## <a name="cdaodatabasegetversion"></a><a name="getversion"></a>CDaoDatabase::GetVersion

Вызовите эту функцию участника, чтобы определить версию файла базы данных Microsoft Jet.

```
CString GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

[CString,](../../atl-mfc-shared/reference/cstringt-class.md) указывающий на версию файла базы данных, связанную с объектом.

### <a name="remarks"></a>Примечания

Возвратное значение представляет номер версии в виде "major.minor"; например, "3.0". Номер версии продукта (например, 3.0) состоит из номера версии (3), периода и номера релиза (0). Версии на сегодняшний день 1.0, 1.1, 2.0 и 3.0.

Подробнее об этом читайте в теме "Version Property" в справке DAO.

## <a name="cdaodatabaseisopen"></a><a name="isopen"></a>CDaoDatabase::IsOpen

Вызовите эту функцию `CDaoDatabase` участника, чтобы определить, открыт ли объект в данный момент в базе данных.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, `CDaoDatabase` если объект в настоящее время открыт; в противном случае 0.

### <a name="remarks"></a>Примечания

## <a name="cdaodatabasem_pdaodatabase"></a><a name="m_pdaodatabase"></a>CDaoDatabase:::m_pDAODatabase

Содержит указатель на интерфейс OLE для объекта базы данных DAO, лежащего в `CDaoDatabase` основе объекта.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если вам нужно получить доступ к интерфейсу DAO напрямую.

Для получения информации о вызове DAO напрямую, [см.](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)

## <a name="cdaodatabasem_pworkspace"></a><a name="m_pworkspace"></a>CDaoDatabase::m_pWorkspace

Содержит указатель на объект [CDaoWorkspace,](../../mfc/reference/cdaoworkspace-class.md) содержащий объект базы данных.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если вам нужно получить прямой доступ к рабочей области , например, для получения указателей на другие объекты базы данных в коллекции баз данных рабочего пространства.

## <a name="cdaodatabaseopen"></a><a name="open"></a>CDaoDatabase::Открыто

Необходимо вызвать эту функцию участника, `CDaoDatabase` чтобы инициализировать недавно построенный объект, представляющий существующую базу данных.

```
virtual void Open(
    LPCTSTR lpszName,
    BOOL bExclusive = FALSE,
    BOOL bReadOnly = FALSE,
    LPCTSTR lpszConnect = _T(""));
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Строка выражение, которое является именем существующего Microsoft Jet (. MDB) файл базы данных. Если имя файла имеет расширение, это необходимо. Если ваша сеть поддерживает единую конвенцию именования (UNC),\\\\\\вы также\\можете\\указать\\сетевой путь, например, « »MYSERVER »MYSHARE »MYDIR »MYDB. MDB". (Двойные задние слэши необходимы в\\строках буквальных, потому что " является c q'побег характер.)

Некоторые соображения применяются при *использовании lpszName*. Если это:

- Ссылается на базу данных, которая уже открыта для эксклюзивного доступа другим пользователем, MFC бросает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md). Ловушка, что исключение, чтобы ваш пользователь знал, что база данных недоступна.

- Является пустой строкой ("") и *lpszConnect* является "ODBC;", диалоговый ящик с указанием всех зарегистрированных имен источников данных ODBC отображается, чтобы пользователь мог выбрать базу данных. Следует избегать прямых подключений к источникам данных ODBC; вместо этого используйте прикрепленный стол.

- В противном случае не относится к существующей базе данных или `CDaoException`действительное имя источника данных ODBC, MFC бросает исключение типа .

> [!NOTE]
> Подробную информацию об кодах ошибок DAO можно узнать на примере DAOERR. H файл. Для получения соответствующей информации смотрите тему "Ошибки доступа к данным" в справке DAO.

*bЭксклюзив*<br/>
Значение Boolean, которое является правдой, если база данных должна быть открыта для эксклюзивного (неразделенного) доступа и FALSE, если база данных должна быть открыта для общего доступа. Если вы не упустите этот аргумент, база данных будет открыта для общего доступа.

*bReadOnly*<br/>
Значение Boolean, которое является правдой, если база данных должна быть открыта для доступа только для чтения и FALSE, если база данных должна быть открыта для доступа к чтению/записи. Если вы опустите этот аргумент, база данных открыта для доступа к чтению/записи. Все зависимые записи наследуют этот атрибут.

*lpszConnect*<br/>
Выражение строки, используемое для открытия базы данных. Эта строка представляет собой аргументы о подключении ODBC. Вы должны предоставить эксклюзивные и только для чтения аргументы для поставки строки источника. Если база данных является базой данных Microsoft Jet (. MDB), эта строка пуста (""). Синтаксис для значения по умолчанию - **_T**("") - обеспечивает переносимость для Unicode, а также ANSI сборки вашего приложения.

### <a name="remarks"></a>Примечания

`Open`ассоциирует базу данных с базовым объектом DAO. Объект базы данных не может использоваться для построения объектов записи, таблицы или запроса до тех пор, пока он не будет инициализирован. `Open`прикладирует объект базы данных к сбору баз данных связанного рабочего пространства.

Используйте параметры следующим образом:

- Если вы открываете Microsoft Jet (. MDB) база данных, использовать параметр *lpszName* и пройти пустую строку для параметра *lpszConnect* или передать строку паролей формы "; PWD-пароль», если база данных защищена паролем (. Базы данных MDB).

- Если вы открываете источник данных ODBC, передайте действительную строку соединения ODBC в *lpszConnect* и пустую строку в *lpszName.*

Для получения соответствующей информации смотрите тему "Метод OpenDatabase" в справке DAO.

> [!NOTE]
> Для повышения производительности при доступе к внешним базам данных, включая базы данных ISAM и источники данных ODBC, рекомендуется прикрепить внешние таблицы баз данных к базе данных движков Microsoft Jet (. MDB), а не подключение непосредственно к источнику данных.

Попытка подключения может быть тайм-аут, если, например, хост DBMS недоступен. Если попытка подключения `Open` не удается, бросает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

Остальные замечания касаемся только баз данных ODBC:

Если база данных является базой данных `Open` ODBC и параметры в вашем вызове не содержат достаточно информации, чтобы сделать соединение, драйвер ODBC открывает диалоговый ящик для получения необходимой информации от пользователя. При вызове `Open`строки подключения, *lpszConnect,* хранится в частном порядке и доступна, позвонив в функцию участника [GetConnect.](#getconnect)

Если вы хотите, вы можете открыть свой `Open` собственный диалоговый ящик, прежде чем звонить, чтобы получить информацию `Open`от пользователя, например пароль, а затем добавить эту информацию в строку соединения вы передаете . Или вы можете сохранить строку соединения, которая проходит (возможно, в реестре Windows), `Open` чтобы `CDaoDatabase` вы могли повторно использовать ее при следующем вызове объекта.

Можно также использовать строку соединения для нескольких уровней авторизации входа (каждый для другого `CDaoDatabase` объекта) или для передачи другой информации, конкретной базы данных.

## <a name="cdaodatabasesetquerytimeout"></a><a name="setquerytimeout"></a>CDaoDatabase::Set'ryTimeout

Вызов эту функцию участника, чтобы переопределить число секунд по умолчанию, чтобы позволить до последующих операций на подключенной базе данных тайм-аут.

```cpp
void SetQueryTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*nSeconds*<br/>
Количество секунд, которые можно разрешить перед тем, как попытка запроса вычисляет.

### <a name="remarks"></a>Примечания

Операция может быть временной из-за проблем с доступом к сети, чрезмерного времени обработки запросов и так далее. Перед открытием набора записей или перед вызовом `SetQueryTimeout` функций-членов [AddNew](../../mfc/reference/cdaorecordset-class.md#addnew), [Update](../../mfc/reference/cdaorecordset-class.md#update) или [Delete](../../mfc/reference/cdaorecordset-class.md#delete) набора записей, если требуется изменить значение времени ожидания запроса. Настройка влияет на все `AddNew` `Update`последующие `Delete` [Open,](../../mfc/reference/cdaorecordset-class.md#open)и вызывает `CDaoDatabase` любые записи, связанные с этим объектом. Изменение значения тайм-аута запроса для записи после открытия не изменяет значение для записи. Например, последующие операции [Move](../../mfc/reference/cdaorecordset-class.md#move) не используют новое значение.

Значение по умолчанию для тайм-аутов запроса составляет 60 секунд. Не все базы данных поддерживают возможность установки значения тайм-аута запроса. Если вы установите значение тайм-аута запроса 0, тайм-аут не происходит; связь с базой данных может прекратить сят-контись. Такое поведение может быть полезно во время разработки.

Для получения соответствующей информации смотрите тему «Недвижимость queryTimeout» в справке DAO.

## <a name="see-also"></a>См. также раздел

[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)<br/>
[CDaoRecordset класс](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CДао-КуириДеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDatabase](../../mfc/reference/cdatabase-class.md)<br/>
[Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
