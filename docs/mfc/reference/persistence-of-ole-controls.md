---
title: Сохраняемость элементов управления OLE
ms.date: 11/04/2016
helpviewer_keywords:
- OLE controls [MFC], persistence
- persistence, OLE controls
ms.assetid: 64f8dc80-f110-41af-b3ea-14948f6bfdf7
ms.openlocfilehash: f3ef5a1f465cc478b429b9fa41d6478f22030a8a
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88843616"
---
# <a name="persistence-of-ole-controls"></a>Сохраняемость элементов управления OLE

Одна из возможностей элементов управления OLE — сохраняемость свойств (или сериализация), которая позволяет элементу управления OLE считывать или записывать значения свойств в файл или поток. Приложение-контейнер может использовать сериализацию для хранения значений свойств элемента управления даже после того, как приложение уничтожило элемент управления. Значения свойств элемента управления OLE можно затем считывать из файла или потока, когда новый экземпляр элемента управления создается позднее.

### <a name="persistence-of-ole-controls"></a>Сохраняемость элементов управления OLE

|Имя|Описание|
|-|-|
|[PX_Blob](#px_blob)|Обменивается свойством элемента управления, в котором хранятся данные больших двоичных объектов (BLOB).|
|[PX_Bool](#px_bool)|Обменивается свойством элемента управления типа **bool**.|
|[PX_Color](#px_color)|Меняет местами свойство Color элемента управления.|
|[PX_Currency](#px_currency)|Обменивается свойством элемента управления типа **CY**.|
|[PX_DataPath](#px_datapath)|Обменивается свойством элемента управления типа `CDataPathProperty` .|
|[PX_Double](#px_double)|Обменивается свойством элемента управления типа **`double`** .|
|[PX_Font](#px_font)|Меняет местами свойство Font элемента управления.|
|[PX_Float](#px_float)|Обменивается свойством элемента управления типа **`float`** .|
|[PX_IUnknown](#px_iunknown)|Обменивается свойством элемента управления неопределенного типа.|
|[PX_Long](#px_long)|Обменивается свойством элемента управления типа **`long`** .|
|[PX_Picture](#px_picture)|Обменивает свойство рисунка элемента управления.|
|[PX_Short](#px_short)|Обменивается свойством элемента управления типа **`short`** .|
|[PX_ULong](#px_ulong)|Меняет местами свойство элемента управления типа **ulong**.|
|[PX_UShort](#px_ushort)|Обменивается свойством элемента управления типа **UShort**.|
|[пксстринг](#px_string)|Меняет местами свойство элемента управления "строка символов".|
|[PX_VBXFontConvert](#px_vbxfontconvert)|Меняет свойства шрифта элемента управления VBX на свойства шрифта элемента управления OLE.|

Кроме того, `AfxOleTypeMatchGuid` предоставляется глобальная функция для проверки соответствия между TYPEDESC и данным идентификатором GUID.

## <a name="px_blob"></a><a name="px_blob"></a> PX_Blob

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство, которое хранит данные больших двоичных объектов (BLOB).

```cpp
BOOL PX_Blob(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    HGLOBAL& hBlob,
    HGLOBAL hBlobDefault = NULL);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*хблоб*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*хблобдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства будет считано или записано в переменную, на которую ссылается *хблоб*, в зависимости от ситуации. Эта переменная должна быть инициализирована значением NULL перед первоначальным вызовом `PX_Blob` в первый раз (обычно это можно сделать в конструкторе элемента управления). Если указан параметр *хблобдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине инициализация или процесс сериализации элемента управления завершается ошибкой.

Дескрипторы *хблоб* и *хблобдефаулт* ссылаются на блок памяти, который содержит следующее:

- Значение типа DWORD, которое содержит длину (в байтах) двоичных данных, приведенных ниже, за которым следует сразу же

- Блок памяти, содержащий фактические двоичные данные.

Обратите внимание, что `PX_Blob` при загрузке свойств типа больших двоичных объектов будет выделять память с помощью API Windows [GlobalAlloc](/windows/win32/api/winbase/nf-winbase-globalalloc) . Вы несете ответственность за освобождение этой памяти. Таким образом, деструктор элемента управления должен вызывать [GlobalFree](/windows/win32/api/winbase/nf-winbase-globalfree) для всех дескрипторов свойств типа больших двоичных объектов, чтобы освободить память, выделенную для элемента управления.

## <a name="px_bool"></a><a name="px_bool"></a> PX_Bool

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство типа bool.

```cpp
BOOL PX_Bool(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    BOOL& bValue);

BOOL PX_Bool(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    BOOL& bValue,
    BOOL bDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*bValue*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*бдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства будет считано или записано в переменную, на которую ссылается *bValue*, в зависимости от ситуации. Если указан параметр *бдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_color"></a><a name="px_color"></a> PX_Color

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство типа OLE_COLOR.

```cpp
BOOL PX_Color(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    OLE_COLOR& clrValue);

BOOL PX_Color(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    OLE_COLOR& clrValue,
    OLE_COLOR clrDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*клрвалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*клрдефаулт*<br/>
Значение по умолчанию для свойства, как определено разработчиком элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства будет считано или записано в переменную, на которую ссылается *клрвалуе*, в зависимости от ситуации. Если указан параметр *клрдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_currency"></a><a name="px_currency"></a> PX_Currency

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **Currency**.

```cpp
BOOL PX_Currency(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CY& cyValue);

BOOL PX_Currency(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CY& cyValue,
    CY cyDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*цивалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*цидефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства будет считано или записано в переменную, на которую ссылается *цивалуе*, в зависимости от ситуации. Если указан параметр *цидефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_datapath"></a><a name="px_datapath"></a> PX_DataPath

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство пути к данным типа [кдатапаспроперти](../../mfc/reference/cdatapathproperty-class.md).

```cpp
BOOL PX_DataPath(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CDataPathProperty& dataPathProperty);

BOOL PX_DataPath(
    CPropExchange* pPX,
    CDataPathProperty& dataPathProperty);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*датапаспроперти*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Свойства пути к данным реализуют асинхронные свойства элемента управления. Значение свойства будет считано или записано в переменную, на которую ссылается *датапаспроперти*, в зависимости от ситуации.

## <a name="px_double"></a><a name="px_double"></a> PX_Double

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **`double`** .

```cpp
BOOL PX_Double(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    double& doubleValue);

BOOL PX_Double(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    double& doubleValue,
    double doubleDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*даублевалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*даубледефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *даублевалуе*, или записывается в соответствии с соответствующими значениями. Если указан параметр *даубледефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_font"></a><a name="px_font"></a> PX_Font

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство типа Font.

```cpp
BOOL PX_Font(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CFontHolder& font,
    const FONTDESC FAR* pFontDesc = NULL,
    LPFONTDISP pFontDispAmbient = NULL);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*шрифтов*<br/>
Ссылка на `CFontHolder` объект, содержащий свойство Font.

*пфонтдеск*<br/>
Указатель на `FONTDESC` структуру, содержащую значения, используемые при инициализации состояния по умолчанию свойства Font, в случае, если *пфонтдиспамбиент* имеет значение null.

*пфонтдиспамбиент*<br/>
Указатель на `IFontDisp` интерфейс шрифта, используемый при инициализации состояния по умолчанию для свойства Font.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается или записывается в ссылку, `font` если это `CFontHolder` уместно. Если указаны *пфонтдеск* и *пфонтдиспамбиент* , они используются для инициализации значения свойства по умолчанию при необходимости. Эти значения используются, если по какой либо причине происходит сбой процесса сериализации элемента управления. Как правило, для *пфонтдеск* передается значение NULL и значение окружения, возвращаемое `COleControl::AmbientFont` для *пфонтдиспамбиент*. Обратите внимание, что объект Font, возвращаемый методом, `COleControl::AmbientFont` должен освобождаться вызовом `IFontDisp::Release` функции-члена.

## <a name="px_float"></a><a name="px_float"></a> PX_Float

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **`float`** .

```cpp
BOOL PX_Float(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    float& floatValue);

BOOL PX_Float(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    float& floatValue,
    float floatDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*флоатвалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*флоатдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *флоатвалуе*, или записывается в соответствии с соответствующими значениями. Если указан параметр *флоатдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_iunknown"></a><a name="px_iunknown"></a> PX_IUnknown

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства, представленного объектом, имеющего `IUnknown` производный интерфейс.

```cpp
BOOL PX_IUnknown(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    LPUNKNOWN& pUnk,
    REFIID iid,
    LPUNKNOWN pUnkDefault = NULL);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*pUnk*<br/>
Ссылка на переменную, содержащую интерфейс объекта, представляющего значение свойства.

*IID*<br/>
Идентификатор интерфейса, указывающий, какой интерфейс объекта свойства используется элементом управления.

*пункдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *Punk*, или записывается в соответствии с соответствующими значениями. Если указан параметр *пункдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_long"></a><a name="px_long"></a> PX_Long

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **`long`** .

```cpp
BOOL PX_Long(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    long& lValue);

BOOL PX_Long(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    long& lValue,
    long lDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*lValue*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*лдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *lvalue*, или записывается в нее соответствующим образом. Если указан параметр *лдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_picture"></a><a name="px_picture"></a> PX_Picture

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство Picture элемента управления.

```cpp
BOOL PX_Picture(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CPictureHolder& pict);

BOOL PX_Picture(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CPictureHolder& pict,
    CPictureHolder& pictDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*PICT*<br/>
Ссылка на объект [CPictureHolder](../../mfc/reference/cpictureholder-class.md) , в котором хранится свойство (обычно это переменная-член класса).

*пиктдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается или записывается в переменную, на которую ссылается *PICT*, в зависимости от ситуации. Если указан параметр *пиктдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_short"></a><a name="px_short"></a> PX_Short

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **`short`** .

```cpp
BOOL PX_Short(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    short& sValue);

BOOL PX_Short(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    short& sValue,
    short sDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*свалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*сдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *свалуе*, или записывается в соответствии с соответствующими значениями. Если указан параметр *сдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_ulong"></a><a name="px_ulong"></a> PX_ULong

Вызовите эту функцию в функции- `DoPropExchange` члене элемента управления, чтобы сериализовать или инициализировать свойство типа **ulong**.

```cpp
BOOL PX_ULong(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    ULONG& ulValue);

BOOL PX_ULong(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    ULONG& ulValue,
    long ulDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*улвалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*улдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *улвалуе*, или записывается в соответствии с соответствующими значениями. Если указан параметр *улдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_ushort"></a><a name="px_ushort"></a> PX_UShort

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства типа **`unsigned short`** .

```cpp
BOOL PX_UShort(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    USHORT& usValue);

BOOL PX_UShort(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    USHORT& usValue,
    USHORT usDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*усвалуе*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*усдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *усвалуе*, или записывается в соответствии с соответствующими значениями. Если указан параметр *усдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="pxstring"></a><a name="px_string"></a> пксстринг

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для сериализации или инициализации свойства символьной строки.

```cpp
BOOL PXstring(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CString& strValue);

BOOL PXstring(
    CPropExchange* pPX,
    LPCTSTR pszPropName,
    CString& strValue,
    CString strDefault);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*псзпропнаме*<br/>
Имя свойства, для которого выполняется обмен.

*strValue*<br/>
Ссылка на переменную, в которой хранится свойство (обычно это переменная-член класса).

*стрдефаулт*<br/>
Значение по умолчанию для свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Значение свойства считывается из переменной, на которую ссылается *strValue*, или записывается в соответствии с соответствующими значениями. Если указан параметр *стрдефаулт* , он будет использоваться как значение свойства по умолчанию. Это значение используется, если по какой-либо причине происходит сбой процесса сериализации элемента управления.

## <a name="px_vbxfontconvert"></a><a name="px_vbxfontconvert"></a> PX_VBXFontConvert

Вызывайте эту функцию в функции- `DoPropExchange` члене элемента управления для инициализации свойства Font путем преобразования свойств, связанных со шрифтами элемента управления VBX.

```cpp
BOOL PX_VBXFontConvert(
    CPropExchange* pPX,
    CFontHolder& font);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) (обычно передается в качестве параметра в `DoPropExchange` ).

*шрифтов*<br/>
Свойство Font элемента управления OLE, которое будет содержать преобразованные свойства, связанные со шрифтом VBX.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если Exchange завершился успешно; 0 в случае неудачи.

### <a name="remarks"></a>Примечания

Эта функция должна использоваться только элементом управления OLE, который предназначен для непосредственной замены элемента управления VBX. Когда среда разработки Visual Basic преобразует форму, содержащую элемент управления VBX, для использования соответствующего заменяющего элемента управления OLE, он вызывает функцию элемента управления `IDataObject::SetData` , передавая набор свойств, содержащий данные свойства элемента управления VBX. Эта операция, в свою очередь, приводит к `DoPropExchange` вызову функции элемента управления. `DoPropExchange` может вызвать метод `PX_VBXFontConvert` для преобразования свойств шрифта элемента управления VBX (например, "FontName", "FontSize" и т. д.) в соответствующие компоненты свойства Font элемента управления OLE.

`PX_VBXFontConvert` метод следует вызывать только в том случае, если элемент управления фактически преобразуется из приложения формы VBX. Пример:

[!code-cpp[NVC_MFCActiveXControl#14](../../mfc/codesnippet/cpp/persistence-of-ole-controls_1.cpp)]
[!code-cpp[NVC_MFCActiveXControl#15](../../mfc/codesnippet/cpp/persistence-of-ole-controls_2.cpp)]

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
