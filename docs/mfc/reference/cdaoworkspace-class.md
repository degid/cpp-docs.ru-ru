---
title: Класс Кдаоворкспаце
ms.date: 11/04/2016
f1_keywords:
- CDaoWorkspace
- AFXDAO/CDaoWorkspace
- AFXDAO/CDaoWorkspace::CDaoWorkspace
- AFXDAO/CDaoWorkspace::Append
- AFXDAO/CDaoWorkspace::BeginTrans
- AFXDAO/CDaoWorkspace::Close
- AFXDAO/CDaoWorkspace::CommitTrans
- AFXDAO/CDaoWorkspace::CompactDatabase
- AFXDAO/CDaoWorkspace::Create
- AFXDAO/CDaoWorkspace::GetDatabaseCount
- AFXDAO/CDaoWorkspace::GetDatabaseInfo
- AFXDAO/CDaoWorkspace::GetIniPath
- AFXDAO/CDaoWorkspace::GetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::GetLoginTimeout
- AFXDAO/CDaoWorkspace::GetName
- AFXDAO/CDaoWorkspace::GetUserName
- AFXDAO/CDaoWorkspace::GetVersion
- AFXDAO/CDaoWorkspace::GetWorkspaceCount
- AFXDAO/CDaoWorkspace::GetWorkspaceInfo
- AFXDAO/CDaoWorkspace::Idle
- AFXDAO/CDaoWorkspace::IsOpen
- AFXDAO/CDaoWorkspace::Open
- AFXDAO/CDaoWorkspace::RepairDatabase
- AFXDAO/CDaoWorkspace::Rollback
- AFXDAO/CDaoWorkspace::SetDefaultPassword
- AFXDAO/CDaoWorkspace::SetDefaultUser
- AFXDAO/CDaoWorkspace::SetIniPath
- AFXDAO/CDaoWorkspace::SetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::SetLoginTimeout
- AFXDAO/CDaoWorkspace::m_pDAOWorkspace
helpviewer_keywords:
- CDaoWorkspace [MFC], CDaoWorkspace
- CDaoWorkspace [MFC], Append
- CDaoWorkspace [MFC], BeginTrans
- CDaoWorkspace [MFC], Close
- CDaoWorkspace [MFC], CommitTrans
- CDaoWorkspace [MFC], CompactDatabase
- CDaoWorkspace [MFC], Create
- CDaoWorkspace [MFC], GetDatabaseCount
- CDaoWorkspace [MFC], GetDatabaseInfo
- CDaoWorkspace [MFC], GetIniPath
- CDaoWorkspace [MFC], GetIsolateODBCTrans
- CDaoWorkspace [MFC], GetLoginTimeout
- CDaoWorkspace [MFC], GetName
- CDaoWorkspace [MFC], GetUserName
- CDaoWorkspace [MFC], GetVersion
- CDaoWorkspace [MFC], GetWorkspaceCount
- CDaoWorkspace [MFC], GetWorkspaceInfo
- CDaoWorkspace [MFC], Idle
- CDaoWorkspace [MFC], IsOpen
- CDaoWorkspace [MFC], Open
- CDaoWorkspace [MFC], RepairDatabase
- CDaoWorkspace [MFC], Rollback
- CDaoWorkspace [MFC], SetDefaultPassword
- CDaoWorkspace [MFC], SetDefaultUser
- CDaoWorkspace [MFC], SetIniPath
- CDaoWorkspace [MFC], SetIsolateODBCTrans
- CDaoWorkspace [MFC], SetLoginTimeout
- CDaoWorkspace [MFC], m_pDAOWorkspace
ms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52
ms.openlocfilehash: eea3fb29f219890ebe596c5d8109257e9d422054
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88839794"
---
# <a name="cdaoworkspace-class"></a>Класс Кдаоворкспаце

Управление именованным, защищенным паролем сеансом базы данных от входа до выхода одним пользователем. DAO поддерживается в Office 2013. Версия DAO 3,6 является окончательной и считается устаревшей.

## <a name="syntax"></a>Синтаксис

```
class CDaoWorkspace : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[Кдаоворкспаце:: Кдаоворкспаце](#cdaoworkspace)|Конструирует объект рабочей области. Затем вызовите `Create` или `Open` .|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[Кдаоворкспаце:: Append](#append)|Добавляет вновь созданную рабочую область в коллекцию рабочих областей ядра СУБД.|
|[Кдаоворкспаце:: примеры BeginTrans](#begintrans)|Начинает новую транзакцию, которая применяется ко всем базам данных, открытым в рабочей области.|
|[Кдаоворкспаце:: Close](#close)|Закрывает рабочую область и все содержащиеся в ней объекты. Выполняется откат ожидающих транзакций.|
|[Кдаоворкспаце:: CommitTrans](#committrans)|Завершает текущую транзакцию и сохраняет изменения.|
|[Кдаоворкспаце:: Компактдатабасе](#compactdatabase)|Сжимает (или дублирует) базу данных.|
|[Кдаоворкспаце:: Create](#create)|Создает новый объект рабочей области DAO.|
|[Кдаоворкспаце:: Жетдатабасекаунт](#getdatabasecount)|Возвращает число объектов базы данных DAO в коллекции баз данных рабочей области.|
|[Кдаоворкспаце:: Жетдатабасеинфо](#getdatabaseinfo)|Возвращает сведения об указанной базе данных DAO, определенной в коллекции баз данных рабочей области.|
|[Кдаоворкспаце:: Жетинипас](#getinipath)|Возвращает расположение параметров инициализации ядра СУБД Microsoft Jet в реестре Windows.|
|[Кдаоворкспаце:: Жетисолатеодбктранс](#getisolateodbctrans)|Возвращает значение, указывающее, изолируются ли несколько транзакций, затрагивающих один источник данных ODBC, посредством принудительного множественного подключения к источнику данных.|
|[Кдаоворкспаце:: Жетлогинтимеаут](#getlogintimeout)|Возвращает количество секунд до возникновения ошибки, когда пользователь пытается войти в базу данных ODBC.|
|[Кдаоворкспаце:: Name](#getname)|Возвращает определяемое пользователем имя для объекта рабочей области.|
|[Кдаоворкспаце:: имя пользователя](#getusername)|Возвращает имя пользователя, указанное при создании рабочей области. Это имя владельца рабочей области.|
|[Кдаоворкспаце::/версия](#getversion)|Возвращает строку, содержащую версию ядра СУБД, связанную с рабочей областью.|
|[Кдаоворкспаце:: Жетворкспацекаунт](#getworkspacecount)|Возвращает число объектов рабочей области DAO в коллекции рабочих областей ядра СУБД.|
|[Кдаоворкспаце:: Жетворкспацеинфо](#getworkspaceinfo)|Возвращает сведения об указанной рабочей области DAO, определенной в коллекции рабочих областей ядра СУБД.|
|[Кдаоворкспаце:: Idle](#idle)|Позволяет ядру СУБД выполнять фоновые задачи.|
|[Кдаоворкспаце:: OnOpen](#isopen)|Если Рабочая область открыта, возвращает ненулевое значение.|
|[Кдаоворкспаце:: Open](#open)|Явным образом открывает объект рабочей области, связанный с рабочей областью DAO по умолчанию.|
|[Кдаоворкспаце:: Репаирдатабасе](#repairdatabase)|Пытается восстановить поврежденную базу данных.|
|[Кдаоворкспаце:: ROLLBACK](#rollback)|Завершает текущую транзакцию и не сохраняет изменения.|
|[Кдаоворкспаце:: Сетдефаултпассворд](#setdefaultpassword)|Задает пароль, используемый ядром СУБД при создании объекта рабочей области без определенного пароля.|
|[Кдаоворкспаце:: Сетдефаултусер](#setdefaultuser)|Задает имя пользователя, используемое ядром СУБД при создании объекта рабочей области без определенного имени пользователя.|
|[Кдаоворкспаце:: Сетинипас](#setinipath)|Задает расположение параметров инициализации ядра СУБД Microsoft Jet в реестре Windows.|
|[Кдаоворкспаце:: Сетисолатеодбктранс](#setisolateodbctrans)|Указывает, изолированы ли несколько транзакций, использующих один источник данных ODBC, путем принудительного выполнения нескольких соединений с источником данных.|
|[Кдаоворкспаце:: SetLoginTimeout](#setlogintimeout)|Задает количество секунд до возникновения ошибки, когда пользователь пытается войти в источник данных ODBC.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Кдаоворкспаце:: m_pDAOWorkspace](#m_pdaoworkspace)|Указывает на базовый объект рабочей области DAO.|

## <a name="remarks"></a>Примечания

В большинстве случаев вам не потребуется несколько рабочих областей, и вам не нужно создавать явные объекты рабочей области. При открытии базы данных и объектов набора записей они используют рабочую область DAO по умолчанию. Однако при необходимости можно запустить несколько сеансов за раз, создав дополнительные объекты рабочей области. Каждый объект рабочей области может содержать несколько открытых объектов базы данных в собственной коллекции баз данных. В MFC Рабочая область — это, в первую очередь, диспетчер транзакций, указывающий набор открытых баз данных в одном и том же "пространстве транзакции".

> [!NOTE]
> Классы базы данных DAO отличаются от классов баз данных MFC, основанных на открытом подключении к базам данных (ODBC). Все имена классов базы данных DAO имеют префикс "Кдао". Как правило, классы MFC, основанные на DAO, более поддерживаются, чем классы MFC, основанные на ODBC. Классы на основе DAO обращаются к данным через ядро СУБД Microsoft Jet, включая драйверы ODBC. Они также поддерживают операции языка DDL, такие как создание баз данных и добавление таблиц и полей с помощью классов, без необходимости непосредственного вызова DAO.

## <a name="capabilities"></a>Возможности

Класс `CDaoWorkspace` предоставляет следующие сведения:

- Явный доступ (при необходимости) к рабочей области по умолчанию, созданной путем инициализации ядра СУБД. Как правило, Рабочая область DAO по умолчанию используется неявно путем создания объектов Database и Recordset.

- Пространство транзакции, в котором транзакции применяются ко всем базам данных, открытым в рабочей области. Можно создать дополнительные рабочие области для управления отдельными пространствами транзакций.

- Интерфейс для многих свойств базового ядра СУБД Microsoft Jet (см. раздел статические функции-члены). При открытии или создании рабочей области или вызове статической функции-члена перед открытием или созданием инициализируется ядро СУБД.

- Доступ к коллекции рабочих областей ядра СУБД, в которой хранятся все активные рабочие области, добавленные в нее. Вы также можете создавать рабочие области и работать с ними, не добавляя их в коллекцию.

## <a name="security"></a>Безопасность

MFC не реализует коллекции пользователей и групп в DAO, которые используются для управления безопасностью. Если вам нужны эти аспекты DAO, необходимо программировать их самостоятельно с помощью прямых вызовов к интерфейсам DAO. Дополнительные сведения см. в [техническом примечании 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

## <a name="usage"></a>Использование

Класс можно использовать `CDaoWorkspace` для:

- Явно откройте рабочую область по умолчанию.

   Обычно использование рабочей области по умолчанию является неявным — при открытии новых объектов [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) . Но может потребоваться явное обращение к нему, например для доступа к свойствам ядра СУБД или коллекции рабочих областей. См. раздел "Неявное использование рабочей области по умолчанию" ниже.

- Создание новых рабочих областей. [Присоединить](#append) вызов, если хотите добавить их в коллекцию рабочих областей.

- Откройте существующую рабочую область в коллекции рабочих областей.

Создание рабочей области, которая еще не существует в коллекции рабочих областей, описана в разделе Функция [создания](#create) элемента. Объекты рабочей области не сохраняются каким бы то ни было образом между сеансами инструментами Engine. Если приложение связывает MFC статически, завершение приложения Отменяет инициализацию ядра СУБД. Если приложение динамически связывается с MFC, ядро СУБД не инициализируется при выгрузке библиотеки DLL MFC.

Явное Открытие рабочей области по умолчанию или Открытие существующей рабочей области в коллекции рабочих областей описывается в разделе Функция [открытого](#open) члена.

Завершите сеанс рабочей области, закрыв рабочую область с помощью функции-члена [Close](#close) . `Close` закрывает все базы данных, которые вы ранее не закрыли, выведя откат всех незафиксированных транзакций.

## <a name="transactions"></a>Transactions

DAO управляет транзакциями на уровне рабочей области. Таким образом, транзакции в рабочей области с несколькими открытыми базами данных применяются ко всем базам данных. Например, если две базы данных имеют незафиксированные обновления и вы вызываете [CommitTrans](#committrans), все обновления фиксируются. Если требуется ограничить транзакции одной базой данных, для нее необходим отдельный объект рабочей области.

## <a name="implicit-use-of-the-default-workspace"></a>Неявное использование рабочей области по умолчанию

MFC использует рабочую область по умолчанию DAO неявным образом в следующих случаях:

- Если вы создаете новый `CDaoDatabase` объект, но не выполняете его через существующий `CDaoWorkspace` объект, MFC создает временный объект рабочей области, который соответствует рабочей области DAO по умолчанию. Если это сделать для нескольких баз данных, все объекты базы данных будут связаны с рабочей областью по умолчанию. Доступ к рабочей области базы данных можно получить с помощью `CDaoDatabase` элемента данных.

- Аналогичным образом, при создании `CDaoRecordset` объекта без указания указателя на `CDaoDatabase` объект MFC создает временный объект базы данных и, по расширению, временный объект рабочей области. Можно получить доступ к базе данных набора записей и косвенно ее рабочей области через `CDaoRecordset` элемент данных.

## <a name="other-operations"></a>Другие операции

Также предоставляются другие операции базы данных, такие как восстановление поврежденной базы данных или сжатие базы данных.

Сведения о непосредственном вызове DAO и о безопасности DAO см. в [техническом примечании 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoWorkspace`

## <a name="requirements"></a>Требования

**Заголовок:** афксдао.h

## <a name="cdaoworkspaceappend"></a><a name="append"></a> Кдаоворкспаце:: Append

Вызовите эту функцию члена после вызова метода [CREATE](#create).

```
virtual void Append();
```

### <a name="remarks"></a>Примечания

`Append` добавляет созданный объект рабочей области в коллекцию рабочих областей ядра СУБД. Рабочие области не сохраняются между сеансами ядра СУБД. они хранятся только в памяти, а не на диске. Добавлять рабочую область не требуется; Если этого не сделать, вы по-прежнему можете использовать его.

Добавленная Рабочая область остается в коллекции рабочих областей в активном состоянии Open, пока не будет вызвана функция [закрытия](#close) элемента.

Связанные сведения см. в разделе "метод Append" справки DAO.

## <a name="cdaoworkspacebegintrans"></a><a name="begintrans"></a> Кдаоворкспаце:: примеры BeginTrans

Вызовите эту функцию-член, чтобы инициировать транзакцию.

```cpp
void BeginTrans();
```

### <a name="remarks"></a>Примечания

После вызова `BeginTrans` обновления, вносимые в данные или структуру базы данных, вступают в силу при фиксации транзакции. Так как Рабочая область определяет одно пространство транзакции, она применяется ко всем открытым базам данных в рабочей области. Существует два способа выполнения транзакции:

- Вызовите функцию члена [CommitTrans](#committrans) , чтобы зафиксировать транзакцию и сохранить изменения в источнике данных.

- Или вызовите функцию [отката](#rollback) члена, чтобы отменить транзакцию.

Закрытие объекта рабочей области или объекта базы данных, пока транзакция ожидает откат всех ожидающих транзакций.

Если необходимо изолировать транзакции в одном источнике данных ODBC от тех, которые находятся в другом источнике данных ODBC, см. раздел Функция члена [сетисолатеодбктранс](#setisolateodbctrans) .

## <a name="cdaoworkspacecdaoworkspace"></a><a name="cdaoworkspace"></a> Кдаоворкспаце:: Кдаоворкспаце

Формирует объект `CDaoWorkspace`.

```
CDaoWorkspace();
```

### <a name="remarks"></a>Примечания

После создания объекта C++ у вас есть два варианта:

- Вызовите функцию [открытого](#open) члена объекта, чтобы открыть рабочую область по умолчанию или открыть существующий объект в коллекции рабочих областей.

- Или вызовите функцию-член [CREATE](#create) объекта, чтобы создать новый объект рабочей области DAO. Это явно запускает новый сеанс рабочей области, на который можно ссылаться через `CDaoWorkspace` объект. После вызова `Create` функции [append](#append) можно вызвать, если вы хотите добавить рабочую область в коллекцию рабочих областей ядра СУБД.

Сведения о том, когда необходимо явно создать `CDaoWorkspace` объект, см. в обзоре класса для [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md). Как правило, рабочие области создаются неявно при открытии объекта [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) без указания рабочей области или при открытии объекта [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) без указания объекта базы данных. Объекты MFC DAO, созданные таким образом, используют рабочую область DAO по умолчанию, которая создается один раз и повторно используется.

Чтобы освободить рабочую область и ее содержащиеся в ней объекты, вызовите функцию-член [Close](#close) объекта Workspace.

## <a name="cdaoworkspaceclose"></a><a name="close"></a> Кдаоворкспаце:: Close

Вызовите эту функцию члена, чтобы закрыть объект рабочей области.

```
virtual void Close();
```

### <a name="remarks"></a>Примечания

При закрытии открытого объекта рабочей области освобождается базовый объект DAO и, если Рабочая область является членом коллекции рабочих областей, удаляет ее из коллекции. Вызов `Close` является хорошей практикой программирования.

> [!CAUTION]
> Закрытие объекта рабочей области приводит к закрытию всех открытых баз данных в рабочей области. Это приводит к открытию всех наборов записей в закрываемых базах данных, а также откате всех ожидающих изменений или обновлений. Дополнительные сведения см. в разделе функции элементов [CDaoDatabase:: Close](../../mfc/reference/cdaodatabase-class.md#close), [CDaoRecordset:: Close](../../mfc/reference/cdaorecordset-class.md#close), [Кдаотабледеф:: Close](../../mfc/reference/cdaotabledef-class.md#close)и [кдаокуеридеф:: Close](../../mfc/reference/cdaoquerydef-class.md#close) .

Объекты рабочей области не являются постоянными; они существуют только тогда, когда существуют ссылки на них. Это означает, что по окончании сеанса ядра СУБД Рабочая область и ее коллекция баз данных не сохраняются. Необходимо повторно создать их для следующего сеанса, открыв рабочую область и базы данных.

Дополнительные сведения см. в разделе «метод закрытия» справки DAO.

## <a name="cdaoworkspacecommittrans"></a><a name="committrans"></a> Кдаоворкспаце:: CommitTrans

Вызывайте эту функцию-член для фиксации транзакции — сохраните группу изменений и обновлений в одной или нескольких базах данных в рабочей области.

```cpp
void CommitTrans();
```

### <a name="remarks"></a>Примечания

Транзакция состоит из ряда изменений в данных базы данных или ее структуры, начиная с вызова [примеры BeginTrans](#begintrans). Завершив транзакцию, зафиксируйте ее или выполните откат (отмените изменения), выполнив [откат](#rollback). По умолчанию без транзакций обновления записей фиксируются немедленно. Вызов `BeginTrans` приводит к задержке обновлений до тех пор, пока не будет вызван `CommitTrans` .

> [!CAUTION]
> В рамках одной рабочей области транзакции всегда являются глобальными для рабочей области и не ограничиваются только одной базой данных или набором записей. При выполнении операций над несколькими базами данных или наборами записей в рамках транзакции рабочей области `CommitTrans` фиксируется все ожидающие обновления и `Rollback` восстанавливаются все операции с этими базами данных и наборами записей.

При закрытии базы данных или рабочей области с ожидающими транзакциями выполняется откат всех транзакций.

> [!NOTE]
> Это не двухэтапный механизм фиксации. Если одно из обновлений не удается зафиксировать, другие по-прежнему будут фиксироваться.

## <a name="cdaoworkspacecompactdatabase"></a><a name="compactdatabase"></a> Кдаоворкспаце:: Компактдатабасе

Вызовите эту функцию-член для сжатия указанного Microsoft Jet (. MDB) база данных.

```
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int nOptions = 0);

static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale,
    int nOptions,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*лпсзсркнаме*<br/>
Имя существующей, закрытой базы данных. Это может быть полный путь и имя файла, например "C: \\ \мидб. MDB ". Если имя файла имеет расширение, необходимо указать его. Если сеть поддерживает соглашение об универсальных именах (UNC), можно также указать сетевой путь, например " \\ \\ \\ \мисервер \\ \мишаре \\ \мидир \\ \мидб. MDB ". (В строках пути требуются двойные обратные косые черты, так как " \\ " является escape-символом C++.)

*лпсздестнаме*<br/>
Полный путь к создаваемой сжатой базе данных. Можно также указать сетевой путь, как и *лпсзсркнаме*. Нельзя использовать аргумент *лпсздестнаме* для указания того же файла базы данных, что и *лпсзсркнаме*.

*лпсзпассворд*<br/>
Пароль, используемый, если требуется сжать базу данных, защищенную паролем. Обратите внимание, что при использовании версии `CompactDatabase` , которая принимает пароль, необходимо указать все параметры. Кроме того, поскольку это параметр подключения, для него требуется специальное форматирование, как показано ниже. PWD = *лпсзпассворд*. Например:; PWD = "счастливое". (Требуется начальная точка с запятой.)

*лпсзлокале*<br/>
Строковое выражение, используемое для указания порядка сортировки при создании *лпсздестнаме*. Если опустить этот аргумент, приняв значение по умолчанию `dbLangGeneral` (см. ниже), языковой стандарт новой базы данных будет таким же, как и у старой базы данных. Возможны следующие значения:

- `dbLangGeneral` Английский, немецкий, французский, португальский, итальянский и современный испанский

- `dbLangArabic` арабский

- `dbLangCyrillic` русский

- `dbLangCzech` чешский

- `dbLangDutch` нидерландский

- `dbLangGreek` греческий

- `dbLangHebrew` иврит

- `dbLangHungarian` венгерский

- `dbLangIcelandic` исландский

- `dbLangNordic` Скандинавские языки (только для ядра СУБД Microsoft Jet версии 1,0)

- `dbLangNorwdan` Норвежский и датский

- `dbLangPolish` польский

- `dbLangSpanish` Традиционный испанский

- `dbLangSwedfin` Шведский и финский

- `dbLangTurkish` турецкий

*ноптионс*<br/>
Указывает один или несколько параметров для целевой базы данных *лпсздестнаме*. Если опустить этот аргумент, принимая значение по умолчанию, *лпсздестнаме* будет иметь то же шифрование и ту же версию, что и *лпсзсркнаме*. Параметр или можно сочетать `dbEncrypt` `dbDecrypt` с одним из параметров версии с помощью оператора побитового или. Возможные значения, указывающие формат базы данных, а не версию ядра СУБД,:

- `dbEncrypt` Зашифруйте базу данных при сжатии.

- `dbDecrypt` Расшифровать базу данных при сжатии.

- `dbVersion10` Создайте базу данных, использующую ядро СУБД Microsoft Jet версии 1,0 во время сжатия.

- `dbVersion11` Создайте базу данных, использующую ядро СУБД Microsoft Jet версии 1,1 во время сжатия.

- `dbVersion20` Создайте базу данных, использующую ядро СУБД Microsoft Jet версии 2,0 во время сжатия.

- `dbVersion30` Создайте базу данных, использующую ядро СУБД Microsoft Jet версии 3,0 во время сжатия.

Можно использовать `dbEncrypt` или `dbDecrypt` в аргументе Options, чтобы указать, следует ли шифровать или расшифровать базу данных по мере ее сжатия. Если опустить константу шифрования или включить `dbDecrypt` и `dbEncrypt` , *лпсздестнаме* будет иметь то же шифрование, что и *лпсзсркнаме*. Можно использовать одну из констант версии в аргументе Options, чтобы указать версию формата данных для сжатой базы данных. Эта константа влияет только на версию формата данных *лпсздестнаме*. Можно указать только одну константу версии. Если опустить константу версии, *лпсздестнаме* будет иметь ту же версию, что и *лпсзсркнаме*. *Лпсздестнаме* можно сжать только до версии, которая совпадает с версией *лпсзсркнаме*или более поздней.

> [!CAUTION]
> Если база данных не зашифрована, можно, даже если вы реализуете безопасность пользователей и паролей, чтобы напрямую считать файл двоичного диска, составляющий базу данных.

### <a name="remarks"></a>Примечания

При изменении данных в базе данных файл базы данных может стать фрагментированным и использовать больше места на диске, чем необходимо. Периодически необходимо сжать базу данных для дефрагментации файла базы данных. Сжатая база данных обычно меньше. При копировании и сжатии базы данных можно также изменить порядок сортировки, шифрование или версию формата данных.

> [!CAUTION]
> `CompactDatabase`Функция-член не будет правильно преобразовывать полную базу данных Microsoft Access из одной версии в другую. Преобразуется только формат данных. Объекты, определяемые Microsoft Access, такие как формы и отчеты, не преобразуются. Однако данные правильно преобразуются.

> [!TIP]
> Также можно использовать `CompactDatabase` для копирования файла базы данных.

Дополнительные сведения о сжатии баз данных см. в разделе «метод Компактдатабасе» справки DAO.

## <a name="cdaoworkspacecreate"></a><a name="create"></a> Кдаоворкспаце:: Create

Вызовите эту функцию-член, чтобы создать новый объект рабочей области DAO и связать его с `CDaoWorkspace` объектом MFC.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszUserName,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Строка длиной до 14 символов, которая уникально именует новый объект рабочей области. Необходимо указать имя. Связанные сведения см. в разделе "свойство Name" справки DAO.

*лпсзусернаме*<br/>
Имя пользователя, владеющего рабочей областью. Требования см. в описании параметра *лпсздефаултусер* для функции члена [сетдефаултусер](#setdefaultuser) . Связанные сведения см. в разделе "свойство UserName" справки DAO.

*лпсзпассворд*<br/>
Пароль для нового объекта рабочей области. Пароль может иметь длину до 14 символов и может содержать любой символ, кроме ASCII 0 (null). В паролях учитывается регистр символов. Связанные сведения см. в разделе "свойство пароля" справки DAO.

### <a name="remarks"></a>Примечания

Общий процесс создания:

1. Создайте объект [кдаоворкспаце](#cdaoworkspace) .

1. Вызовите `Create` функцию члена объекта, чтобы создать базовую рабочую область DAO. Необходимо указать имя рабочей области.

1. При необходимости вызовите [append](#append) , если вы хотите добавить рабочую область в коллекцию рабочих областей ядра СУБД. Вы можете работать с рабочей областью, не добавляя ее.

После `Create` вызова объект рабочей области находится в открытом состоянии и готов к использованию. Вы не вызываете `Open` After `Create` . Вы не вызываете `Create` , если Рабочая область уже существует в коллекции рабочих областей. `Create` Инициализирует ядро СУБД, если оно еще не инициализировано для вашего приложения.

## <a name="cdaoworkspacegetdatabasecount"></a><a name="getdatabasecount"></a> Кдаоворкспаце:: Жетдатабасекаунт

Вызовите эту функцию-член, чтобы получить количество объектов базы данных DAO в коллекции баз данных рабочей области — количество открытых баз данных в рабочей области.

```
short GetDatabaseCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число открытых баз данных в рабочей области.

### <a name="remarks"></a>Примечания

`GetDatabaseCount` полезен, если необходимо прокручивать все определенные базы данных в коллекции баз данных рабочей области. Сведения о получении сведений об указанной базе данных в коллекции см. в разделе [жетдатабасеинфо](#getdatabaseinfo). Типичное использование — вызов `GetDatabaseCount` для количества открытых баз данных, а затем использование этого числа в качестве индекса цикла для повторяющихся вызовов `GetDatabaseInfo` .

## <a name="cdaoworkspacegetdatabaseinfo"></a><a name="getdatabaseinfo"></a> Кдаоворкспаце:: Жетдатабасеинфо

Вызовите эту функцию-член для получения различных видов информации о базе данных, открытой в рабочей области.

```cpp
void GetDatabaseInfo(
    int nIndex,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetDatabaseInfo(
    LPCTSTR lpszName,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс объекта Database в коллекции баз данных рабочей области для поиска по индексу.

*дбинфо*<br/>
Ссылка на объект [кдаодатабасеинфо](../../mfc/reference/cdaodatabaseinfo-structure.md) , который возвращает запрошенную информацию.

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о базе данных следует извлечь. Ниже перечислены доступные параметры, а также то, что вызывает возврат функции.

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), обновляемые, транзакции

- AFX_DAO_SECONDARY_INFO первичной информации плюс: версия, порядок сортировки, время ожидания запроса

- AFX_DAO_ALL_INFO основную и дополнительную информацию, а также: Connect

*лпсзнаме*<br/>
Имя объекта базы данных для поиска по имени. Имя представляет собой строку длиной до 14 символов, которая уникально именует новый объект рабочей области.

### <a name="remarks"></a>Примечания

Одна версия функции позволяет выполнять поиск базы данных по индексу. Другая версия позволяет искать базу данных по имени.

Описание сведений, возвращаемых в *дбинфо*, см. в разделе Структура [кдаодатабасеинфо](../../mfc/reference/cdaodatabaseinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. При запросе информации на одном уровне вы также получаете сведения для всех предыдущих уровней.

## <a name="cdaoworkspacegetinipath"></a><a name="getinipath"></a> Кдаоворкспаце:: Жетинипас

Вызовите эту функцию члена, чтобы получить расположение параметров инициализации ядра СУБД Microsoft Jet в реестре Windows.

```
static CString PASCAL GetIniPath();
```

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/reference/cstringt-class.md) , содержащее расположение реестра.

### <a name="remarks"></a>Примечания

Расположение можно использовать для получения сведений о параметрах ядра СУБД. Возвращаемая информация фактически является именем подраздела реестра.

Дополнительные сведения см. в подразделах «Инипас Property» и «Настройка параметров реестра Windows для доступа к данным» справки DAO.

## <a name="cdaoworkspacegetisolateodbctrans"></a><a name="getisolateodbctrans"></a> Кдаоворкспаце:: Жетисолатеодбктранс

Вызовите эту функцию члена, чтобы получить текущее значение свойства DAO Исолатеодбктранс для рабочей области.

```
BOOL GetIsolateODBCTrans();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если транзакции ODBC изолированы; в противном случае — 0.

### <a name="remarks"></a>Примечания

В некоторых ситуациях может потребоваться несколько одновременных транзакций в одной базе данных ODBC. Для этого необходимо открыть отдельную рабочую область для каждой транзакции. Помните, что хотя каждая рабочая область может иметь собственное соединение ODBC с базой данных, это снижает производительность системы. Поскольку изоляция транзакций обычно не требуется, подключения ODBC из нескольких объектов рабочей области, открытых одним и тем же пользователем, являются общими по умолчанию.

Некоторые серверы ODBC, например Microsoft SQL Server, не разрешают одновременные транзакции в одном соединении. Если для такой базы данных требуется несколько транзакций в ожидании, установите свойство Исолатеодбктранс в значение TRUE в каждой рабочей области сразу после ее открытия. Это приводит к принудительному подключению отдельного подключения ODBC для каждой рабочей области.

Связанные сведения см. в разделе «свойство Исолатеодбктранс» справки DAO.

## <a name="cdaoworkspacegetlogintimeout"></a><a name="getlogintimeout"></a> Кдаоворкспаце:: Жетлогинтимеаут

Вызовите эту функцию члена, чтобы получить текущее значение свойства DAO LoginTimeout для рабочей области.

```
static short PASCAL GetLoginTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Количество секунд до возникновения ошибки при попытке входа в базу данных ODBC.

### <a name="remarks"></a>Примечания

Это значение представляет количество секунд до возникновения ошибки при попытке входа в базу данных ODBC. Значение параметра LoginTimeout по умолчанию — 20 секунд. Если LoginTimeout имеет значение 0, время ожидания не возникает и обмен данными с источником данных может перестать отвечать.

При попытке войти в базу данных ODBC, например Microsoft SQL Server, подключение может завершиться ошибкой в результате сетевых ошибок или потому, что сервер не работает. Вместо того чтобы ждать подключения по умолчанию 20 секунд, можно указать, как долго ядро СУБД будет ждать, прежде чем будет выдавать ошибку. Вход на сервер происходит неявно как часть ряда различных событий, таких как выполнение запроса к базе данных внешнего сервера.

Связанные сведения см. в разделе «Свойство LoginTimeout» справки DAO.

## <a name="cdaoworkspacegetname"></a><a name="getname"></a> Кдаоворкспаце:: Name

Вызовите эту функцию-член, чтобы получить определяемое пользователем имя объекта рабочей области DAO, лежащего в основе `CDaoWorkspace` объекта.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/reference/cstringt-class.md) , содержащее определяемое пользователем имя объекта рабочей области DAO.

### <a name="remarks"></a>Примечания

Это имя можно использовать для доступа к объекту рабочей области DAO в коллекции рабочих областей ядра СУБД по имени.

Связанные сведения см. в разделе "свойство Name" справки DAO.

## <a name="cdaoworkspacegetusername"></a><a name="getusername"></a> Кдаоворкспаце:: имя пользователя

Вызовите эту функцию члена, чтобы получить имя владельца рабочей области.

```
CString GetUserName();
```

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/reference/cstringt-class.md) , представляющее владельца объекта рабочей области.

### <a name="remarks"></a>Примечания

Чтобы получить или задать разрешения для владельца рабочей области, непосредственно вызовите DAO, чтобы проверить значение свойства Permissions. Это определяет разрешения, которые имеет пользователь. Для работы с разрешениями требуется система. Файл MDA.

Дополнительные сведения о непосредственном вызове DAO см. в [техническом примечании 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md). Связанные сведения см. в разделе "свойство UserName" справки DAO.

## <a name="cdaoworkspacegetversion"></a><a name="getversion"></a> Кдаоворкспаце::/версия

Вызовите эту функцию члена, чтобы определить версию используемого ядра СУБД Microsoft Jet.

```
static CString PASCAL GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающее версию ядра СУБД, связанную с объектом.

### <a name="remarks"></a>Примечания

Возвращаемое значение представляет номер версии в формате "основной. дополнительный"; Например, "3,0". Номер версии продукта (например, 3,0) состоит из номера версии (3), точки и номера выпуска (0).

Связанные сведения см. в разделе «свойство Version» справки DAO.

## <a name="cdaoworkspacegetworkspacecount"></a><a name="getworkspacecount"></a> Кдаоворкспаце:: Жетворкспацекаунт

Вызовите эту функцию члена, чтобы получить количество объектов рабочей области DAO в коллекции рабочих областей ядра СУБД.

```
short GetWorkspaceCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число открытых рабочих областей в коллекции рабочих областей.

### <a name="remarks"></a>Примечания

Это число не включает открытые рабочие области, не добавленные в коллекцию. `GetWorkspaceCount` полезно, если необходимо прокручивать все определенные рабочие области в коллекции рабочих областей. Сведения о получении сведений об определенной рабочей области в коллекции см. в разделе [жетворкспацеинфо](#getworkspaceinfo). Типичное использование — вызов `GetWorkspaceCount` для количества открытых рабочих областей, а затем использование этого числа в качестве индекса цикла для повторяющихся вызовов `GetWorkspaceInfo` .

## <a name="cdaoworkspacegetworkspaceinfo"></a><a name="getworkspaceinfo"></a> Кдаоворкспаце:: Жетворкспацеинфо

Вызовите эту функцию-член для получения различных видов информации о рабочей области, открытой в сеансе.

```cpp
void GetWorkspaceInfo(
    int nIndex,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetWorkspaceInfo(
    LPCTSTR lpszName,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс объекта базы данных в коллекции рабочих областей для поиска по индексу.

*вкспЦинфо*<br/>
Ссылка на объект [кдаоворкспацеинфо](../../mfc/reference/cdaoworkspaceinfo-structure.md) , который возвращает запрошенную информацию.

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о рабочей области следует извлечь. Ниже перечислены доступные параметры, а также то, что вызывает возврат функции.

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию)

- AFX_DAO_SECONDARY_INFO первичной информации и: имя пользователя

- AFX_DAO_ALL_INFO основную и дополнительную информацию, а также: изолировать Одбктранс

*лпсзнаме*<br/>
Имя объекта рабочей области для поиска по имени. Имя представляет собой строку длиной до 14 символов, которая уникально именует новый объект рабочей области.

### <a name="remarks"></a>Примечания

Описание сведений, возвращаемых в *вкспЦинфо*, см. в разделе Структура [кдаоворкспацеинфо](../../mfc/reference/cdaoworkspaceinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. При запросе информации на одном уровне вы получаете также сведения о предыдущих уровнях.

## <a name="cdaoworkspaceidle"></a><a name="idle"></a> Кдаоворкспаце:: Idle

Вызовите метод, `Idle` чтобы предоставить ядру СУБД возможность выполнять фоновые задачи, которые могут не быть актуальными из-за интенсивной обработки данных.

```
static void PASCAL Idle(int nAction = dbFreeLocks);
```

### <a name="parameters"></a>Параметры

*Nвыходные*<br/>
Действие, выполняемое во время бездействия обработки. В настоящее время единственным допустимым действием является `dbFreeLocks` .

### <a name="remarks"></a>Примечания

Это часто справедливо в многопользовательской, многозадачной среде, в которой недостаточно времени фоновой обработки для сохранения всех записей в текущем наборе записей.

> [!NOTE]
> Вызов `Idle` не требуется для баз данных, созданных с помощью ядра СУБД Microsoft Jet версии 3,0. Используйте `Idle` только для баз данных, созданных в более ранних версиях.

Как правило, блокировки чтения удаляются, а данные в локальном объекте набора записей динамического типа обновляются только в том случае, если происходят другие действия (включая перемещение мыши). При периодическом вызове `Idle` вы предоставляете ядру СУБД время, необходимое для отслеживания задач фоновой обработки, освобождая ненужные блокировки чтения. При указании `dbFreeLocks` константы в качестве аргумента обработка задерживается до тех пор, пока не будут сняты все блокировки чтения.

Эта функция-член не требуется в средах с одним пользователем, если не выполняется несколько экземпляров приложения. `Idle`Функция-член может повысить производительность в многопользовательской среде, так как она заставляет ядро СУБД сбрасывать данные на диск, освобождая блокировки на память. Можно также освободить блокировки чтения, сделав операции частью транзакции.

Дополнительные сведения см. в разделе "метод простоя" справки DAO.

## <a name="cdaoworkspaceisopen"></a><a name="isopen"></a> Кдаоворкспаце:: OnOpen

Вызовите эту функцию-член, чтобы определить `CDaoWorkspace` , открыт ли объект, то есть является ли объект MFC инициализированным вызовом [Open](#open) или вызовом [CREATE](#create).

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект рабочей области открыт; в противном случае — 0.

### <a name="remarks"></a>Примечания

Можно вызвать любую из функций-членов рабочей области, которая находится в открытом состоянии.

## <a name="cdaoworkspacem_pdaoworkspace"></a><a name="m_pdaoworkspace"></a> Кдаоворкспаце:: m_pDAOWorkspace

Указатель на базовый объект рабочей области DAO.

### <a name="remarks"></a>Примечания

Используйте этот элемент данных, если требуется прямой доступ к базовому объекту DAO. Интерфейсы объекта DAO можно вызывать через этот указатель.

Дополнительные сведения о непосредственном доступе к объектам DAO см. в [техническом примечании 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

## <a name="cdaoworkspaceopen"></a><a name="open"></a> Кдаоворкспаце:: Open

Явным образом открывает объект рабочей области, связанный с рабочей областью DAO по умолчанию.

```
virtual void Open(LPCTSTR lpszName = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Имя открываемого объекта рабочей области DAO — строка длиной до 14 символов, которая уникально именует рабочую область. Примите значение по умолчанию NULL, чтобы явно открыть рабочую область по умолчанию. Требования к именованию см. в описании параметра *лпсзнаме* для [CREATE](#create). Связанные сведения см. в разделе "свойство Name" справки DAO.

### <a name="remarks"></a>Примечания

После создания `CDaoWorkspace` объекта вызовите эту функцию-член, чтобы выполнить одно из следующих действий:

- Явно откройте рабочую область по умолчанию. Передайте значение NULL для *лпсзнаме*.

- Откройте существующий `CDaoWorkspace` объект — член коллекции рабочих областей по имени. Передайте допустимое имя для существующего объекта рабочей области.

`Open` помещает объект рабочей области в открытое состояние, а также инициализирует ядро СУБД, если оно еще не инициализировано для вашего приложения.

Хотя многие `CDaoWorkspace` функции-члены могут вызываться только после открытия рабочей области, следующие функции-члены, работающие с ядром СУБД, доступны после создания объекта C++, но перед вызовом `Open` :

:::row:::
   :::column span="":::
      [Создания](#create)\
      [жетинипас](#getinipath)\
      [жетлогинтимеаут](#getlogintimeout)
   :::column-end:::
   :::column span="":::
      [GetVersion](#getversion)\
      [Бездействие](#idle)
   :::column-end:::
   :::column span="":::
      [сетдефаултпассворд](#setdefaultpassword)\
      [сетдефаултусер](#setdefaultuser)
   :::column-end:::
   :::column span="":::
      [сетинипас](#setinipath)\
      [SetLoginTimeout](#setlogintimeout)
   :::column-end:::
:::row-end:::

## <a name="cdaoworkspacerepairdatabase"></a><a name="repairdatabase"></a> Кдаоворкспаце:: Репаирдатабасе

Эта функция-член вызывается, если необходимо попытаться восстановить поврежденную базу данных, обращающуюся к ядру СУБД Microsoft Jet.

```
static void PASCAL RepairDatabase(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Путь и имя файла для существующего файла базы данных ядра Microsoft Jet. Если опустить путь, будет выполнен поиск только в текущем каталоге. Если система поддерживает соглашение об универсальных именах (UNC), можно также указать сетевой путь, например: " \\ \\ \\ \мисервер \\ \мишаре \\ \мидир \\ \мидб. MDB ". (В строке пути должны быть двойные косые черты, так как " \\ " является escape-символом C++.)

### <a name="remarks"></a>Примечания

Перед восстановлением необходимо закрыть базу данных, указанную параметром *лпсзнаме* . В многопользовательской среде другие пользователи не могут открыть *лпсзнаме* во время восстановления. Если *лпсзнаме* не закрыт или недоступен для монопольного использования, возникает ошибка.

Эта функция-член пытается восстановить базу данных, которая была помечена как возможно поврежденная незавершенной операцией записи. Это может произойти, если приложение, использующее ядро СУБД Microsoft Jet, неожиданно закрывается из-за сбоя питания или проблемы с оборудованием компьютера. Если выполнить операцию и вызвать функцию Close-Member или [Закрыть](../../mfc/reference/cdaodatabase-class.md#close) приложение обычным образом, база данных не будет помечена как возможно поврежденная.

> [!NOTE]
> После восстановления базы данных рекомендуется также сжать ее с помощью функции-члена [компактдатабасе](#compactdatabase) , чтобы дефрагментировать файл и освободить место на диске.

Дополнительные сведения об исправлении баз данных см. в разделе «метод Репаирдатабасе» справки DAO.

## <a name="cdaoworkspacerollback"></a><a name="rollback"></a> Кдаоворкспаце:: ROLLBACK

Вызовите эту функцию члена, чтобы завершить текущую транзакцию и восстановить все базы данных в рабочей области до начала транзакции.

```cpp
void Rollback();
```

### <a name="remarks"></a>Примечания

> [!CAUTION]
> В пределах одного объекта рабочей области транзакции всегда являются глобальными для рабочей области и не ограничиваются только одной базой данных или набором записей. При выполнении операций над несколькими базами данных или наборами записей в рамках транзакции рабочей области `Rollback` восстанавливает все операции со всеми этими базами данных и наборами записей.

Если закрыть объект рабочей области без сохранения или отката всех ожидающих транзакций, транзакции будут автоматически отменены. При вызове [CommitTrans](#committrans) или `Rollback` без первого вызова [примеры BeginTrans](#begintrans)возникает ошибка.

> [!NOTE]
> При запуске транзакции ядро СУБД записывает свои операции в файл, который хранится в каталоге, указанном переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпал Доступное хранилище на ВРЕМЕННОм диске, ядро СУБД вызовет исключение `CDaoException` (ошибка DAO 2004). На этом этапе при вызове `CommitTrans` фиксируется неопределенное количество операций, но оставшиеся незавершенные операции теряются, и операция должна быть перезапущена. Вызов `Rollback` освобождает журнал транзакций и откатывает все операции в транзакции.

## <a name="cdaoworkspacesetdefaultpassword"></a><a name="setdefaultpassword"></a> Кдаоворкспаце:: Сетдефаултпассворд

Вызовите эту функцию-член, чтобы задать пароль по умолчанию, используемый ядром СУБД при создании объекта рабочей области без определенного пароля.

```
static void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*лпсзпассворд*<br/>
Пароль по умолчанию. Пароль может иметь длину до 14 символов и может содержать любой символ, кроме ASCII 0 (null). В паролях учитывается регистр символов.

### <a name="remarks"></a>Примечания

Заданный по умолчанию пароль применяется к новым рабочим областям, созданным после вызова. При создании последующих рабочих областей не нужно указывать пароль в вызове [CREATE](#create) .

Чтобы использовать эту функцию члена:

1. Создайте `CDaoWorkspace` объект, но не вызывайте `Create` .

1. Вызовите `SetDefaultPassword` и, если вам нравится, [сетдефаултусер](#setdefaultuser).

1. Вызовите `Create` этот объект рабочей области или последующие, не указывая пароль.

По умолчанию свойство DefaultUser имеет значение admin, а свойству DefaultPassword — пустая строка ("").

Дополнительные сведения о безопасности см. в разделе "свойство Permissions" справки DAO. Дополнительные сведения см. в разделах "свойство DefaultPassword" и "свойство DefaultUser" справки DAO.

## <a name="cdaoworkspacesetdefaultuser"></a><a name="setdefaultuser"></a> Кдаоворкспаце:: Сетдефаултусер

Вызовите эту функцию-член, чтобы задать имя пользователя по умолчанию, которое ядро СУБД использует при создании объекта рабочей области без определенного имени пользователя.

```
static void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);
```

### <a name="parameters"></a>Параметры

*лпсздефаултусер*<br/>
Имя пользователя по умолчанию. Имя пользователя может содержать 1-20 символов и включать буквы, цифры, пробелы и символы, кроме: "(кавычки),/(косая черта), \ (обратная косая черта \[ \] ),: (двоеточие), &#124; (pipe), (знак" больше "), \< (less-than sign), > + (знак" плюс "), = (знак равенства),; (точка с запятой),, (запятая), (вопросительный знак), \* (звездочка), начальные пробелы и управляющие символы (от ASCII 00 до ASCII 31). Связанные сведения см. в разделе "свойство UserName" справки DAO.

### <a name="remarks"></a>Примечания

Заданное по умолчанию имя пользователя применяется к новым рабочим областям, созданным после вызова. При создании последующих рабочих областей не нужно указывать имя пользователя в вызове [CREATE](#create) .

Чтобы использовать эту функцию члена:

1. Создайте `CDaoWorkspace` объект, но не вызывайте `Create` .

1. Вызовите `SetDefaultUser` и, если вам нравится, [сетдефаултпассворд](#setdefaultpassword).

1. Вызовите `Create` этот объект рабочей области или последующие, не указывая имя пользователя.

По умолчанию свойство DefaultUser имеет значение admin, а свойству DefaultPassword — пустая строка ("").

Дополнительные сведения см. в разделах «свойство DefaultUser» и «свойство DefaultPassword» справки DAO.

## <a name="cdaoworkspacesetinipath"></a><a name="setinipath"></a> Кдаоворкспаце:: Сетинипас

Вызовите эту функцию члена, чтобы указать расположение параметров реестра Windows для ядра СУБД Microsoft Jet.

```
static void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);
```

### <a name="parameters"></a>Параметры

*лпсзрегистрисубкэй*<br/>
Строка, содержащая имя подраздела реестра Windows для расположения параметров или параметров ядра СУБД Microsoft Jet, необходимых для устанавливаемых баз данных ISAM.

### <a name="remarks"></a>Примечания

Вызывайте `SetIniPath` , только если необходимо указать специальные параметры. Дополнительные сведения см. в разделе «свойство Инипас» справки DAO.

> [!NOTE]
> Вызов `SetIniPath` во время установки приложения, а не при запуске приложения. `SetIniPath` должен вызываться перед открытием любых рабочих областей, баз данных или наборов записей; в противном случае MFC создает исключение.

Этот механизм можно использовать для настройки ядра СУБД с помощью предоставленных пользователем параметров реестра. Область этого атрибута ограничена приложением и не может быть изменена без перезапуска приложения.

## <a name="cdaoworkspacesetisolateodbctrans"></a><a name="setisolateodbctrans"></a> Кдаоворкспаце:: Сетисолатеодбктранс

Вызовите эту функцию члена, чтобы задать значение свойства DAO Исолатеодбктранс для рабочей области.

```cpp
void SetIsolateODBCTrans(BOOL bIsolateODBCTrans);
```

### <a name="parameters"></a>Параметры

*бисолатеодбктранс*<br/>
Передайте значение TRUE, если требуется начать изоляцию транзакций ODBC. Передайте значение FALSE, если необходимо отключить изоляцию транзакций ODBC.

### <a name="remarks"></a>Примечания

В некоторых ситуациях может потребоваться несколько одновременных транзакций в одной базе данных ODBC. Для этого необходимо открыть отдельную рабочую область для каждой транзакции. Хотя каждая рабочая область может иметь собственное соединение ODBC с базой данных, это снижает производительность системы. Поскольку изоляция транзакций обычно не требуется, подключения ODBC из нескольких объектов рабочей области, открытых одним и тем же пользователем, являются общими по умолчанию.

Некоторые серверы ODBC, например Microsoft SQL Server, не разрешают одновременные транзакции в одном соединении. Если для такой базы данных требуется несколько транзакций в ожидании, установите свойство Исолатеодбктранс в значение TRUE в каждой рабочей области сразу после ее открытия. Это приводит к принудительному подключению отдельного подключения ODBC для каждой рабочей области.

## <a name="cdaoworkspacesetlogintimeout"></a><a name="setlogintimeout"></a> Кдаоворкспаце:: SetLoginTimeout

Вызовите эту функцию члена, чтобы задать значение свойства DAO LoginTimeout для рабочей области.

```
static void PASCAL SetLoginTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*нсекондс*<br/>
Количество секунд до возникновения ошибки при попытке входа в базу данных ODBC.

### <a name="remarks"></a>Примечания

Это значение представляет количество секунд до возникновения ошибки при попытке входа в базу данных ODBC. Значение параметра LoginTimeout по умолчанию — 20 секунд. Если LoginTimeout имеет значение 0, время ожидания не возникает и обмен данными с источником данных может перестать отвечать.

При попытке войти в базу данных ODBC, например Microsoft SQL Server, подключение может завершиться ошибкой в результате сетевых ошибок или потому, что сервер не работает. Вместо того чтобы ждать подключения по умолчанию 20 секунд, можно указать, как долго ядро СУБД будет ждать, прежде чем будет выдавать ошибку. Вход на сервер происходит неявно как часть ряда различных событий, таких как выполнение запроса к базе данных внешнего сервера. Значение времени ожидания определяется текущим значением свойства LoginTimeout.

Связанные сведения см. в разделе «Свойство LoginTimeout» справки DAO.

## <a name="see-also"></a>См. также раздел

[CObject, класс](../../mfc/reference/cobject-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс Кдаотабледеф](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс Кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс Кдаоексцептион](../../mfc/reference/cdaoexception-class.md)
