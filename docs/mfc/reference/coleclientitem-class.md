---
title: Класс ColeClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: ce321c9709b752602a664142f283884f4d17b50b
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753958"
---
# <a name="coleclientitem-class"></a>Класс ColeClientItem

Определяет контейнерный интерфейс для элементов OLE.

## <a name="syntax"></a>Синтаксис

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[ColeClientItem::ColeClientItem](#coleclientitem)|Формирует объект `COleClientItem`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[ColeClientItem::Активировать](#activate)|Открывает элемент OLE для операции, а затем выполняет указанный глагол.|
|[ColeClientItem::Activateas](#activateas)|Активирует элемент как другой тип.|
|[ColeClientItem::AttachDataObject](#attachdataobject)|Доступ к данным в объекте OLE.|
|[ColeClientitem::CancreateFromData](#cancreatefromdata)|Указывает, может ли контейнерное приложение создать встроенный объект.|
|[ColeClientitem::CanCreateLinkFromData](#cancreatelinkfromdata)|Указывает, может ли контейнерное приложение создать связанный объект.|
|[ColeClientItem::CanPaste](#canpaste)|Указывает, содержит ли Clipboard встраиваемый или статический элемент OLE.|
|[ColeClientItem::CanPasteLink](#canpastelink)|Указывает, содержит ли Clipboard ссылку на элемент OLE.|
|[ColeClientItem::Закрыть](#close)|Закрывает ссылку на сервер, но не разрушает элемент OLE.|
|[ColeClientitem::Convertto](#convertto)|Преобразует элемент в другой тип.|
|[ColeClientitem::CopytoClipboard](#copytoclipboard)|Копирует элемент OLE на Clipboard.|
|[ColeClientItem::CreateCloneFrom](#createclonefrom)|Создает дубликат существующего элемента.|
|[ColeClientitem::CreateFromClipboard](#createfromclipboard)|Создает встроенный элемент из Clipboard.|
|[ColeClientitem::CreateFromData](#createfromdata)|Создает встроенный элемент из объекта данных.|
|[ColeClientitem::CreateFromFile](#createfromfile)|Создает встроенный элемент из файла.|
|[ColeClientitem::CreateLinkFromClipboard](#createlinkfromclipboard)|Создает связанный элемент из Clipboard.|
|[ColeClientitem::CreateLinkFromData](#createlinkfromdata)|Создает связанный элемент из объекта данных.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Создает связанный элемент из файла.|
|[COleClientItem::CreateNewItem](#createnewitem)|Создает новый встроенный элемент, запустив серверное приложение.|
|[ColeClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Создает статический элемент из Clipboard.|
|[ColeClientitem::CreateStaticFromData](#createstaticfromdata)|Создает статический элемент из объекта данных.|
|[ColeClientItem::Dэактив](#deactivate)|Отключает элемент.|
|[COleClientItem::DeactivateUI](#deactivateui)|Восстанавливает пользовательский интерфейс контейнерного приложения в исходное состояние.|
|[ColeClientItem::Delete](#delete)|Удаляет или закрывает элемент OLE, если он был связан с элементом.|
|[ColeClientItem::DoDragDrop](#dodragdrop)|Выполняет операцию перетаскивания и падения.|
|[ColeClientItem::DoVerb](#doverb)|Выполняет указанный глагол.|
|[ColeClientItem::Draw](#draw)|Рисует элемент OLE.|
|[ColeClientItem::GetActiveView](#getactiveview)|Получает представление, на котором активируется элемент на месте.|
|[ColeClientItem::GetCached](#getcachedextent)|Возвращает границы прямоугольника элемента OLE.|
|[ColeClientItem::GetClassID](#getclassid)|Получает идентификатор класса настоящего элемента.|
|[ColeClientItem::GetClipboardData](#getclipboarddata)|Получает данные, которые будут размещены на `CopyToClipboard` Clipboard, позвонив в функцию участника.|
|[ColeClientItem::GetDocument](#getdocument)|Возвращает `COleDocument` объект, содержащий настоящий элемент.|
|[ColeClientItem::GetDrawAspect](#getdrawaspect)|Получает текущее представление элемента для рендеринга.|
|[ColeClientItem::GetExtent](#getextent)|Возвращает границы прямоугольника элемента OLE.|
|[ColeClientitem::GetIconFromRegistry](#geticonfromregistry)|Извлекает ручку на значок, связанный с сервером определенного CLSID.|
|[ColeClientItem::GetIconicMetafile](#geticonicmetafile)|Получает метафайл, используемый для рисования значка элемента.|
|[ColeClientitem::GetinplaceWindow](#getinplacewindow)|Возвращает указатель в окно редактирования элемента на месте.|
|[ColeClientItem::GetItemState](#getitemstate)|Получает текущее состояние элемента.|
|[ColeClientItem::GetLastStatus](#getlaststatus)|Возвращает состояние последней операции OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Возвращает режим обновления для связанного элемента (продвинутая функция).|
|[ColeClientItem::GetType](#gettype)|Возвращает тип (встроенный, связанный или статический) элемента OLE.|
|[ColeClientItem::GetUserType](#getusertype)|Получает строку, описывающую тип элемента.|
|[ColeClientitem::IsinPlaceActive](#isinplaceactive)|Возвращает TRUE, если элемент находится на месте активной.|
|[ColeClientitem::Islinkuptodate](#islinkuptodate)|Возвращает TRUE, если связанный элемент актуален с исходным документом.|
|[COleClientItem::IsModified](#ismodified)|Возвращает TRUE, если элемент был изменен с момента его последнего сохранения.|
|[ColeClientItem::IsOpen](#isopen)|Возвращает TRUE, если элемент в настоящее время открыт в серверном приложении.|
|[ColeClientItem::IsRunning](#isrunning)|Возвращает TRUE, если серверное приложение элемента запущено.|
|[ColeClientitem::Onactivate](#onactivate)|Вызывается по системе, чтобы уведомить элемент, что он активирован.|
|[ColeClientitem::OnactivateuI](#onactivateui)|Вызывается по системе, чтобы уведомить элемент, что он активирован и должен показать свой пользовательский интерфейс.|
|[ColeClientitem::OnChange](#onchange)|Вызывается при изменении сервера элементА OLE. Требуется реализация.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Вызывается фректовом при деактивации элемента.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Вызывается по системе, когда сервер удалил свой пользовательский интерфейс на месте.|
|[ColeClientitem::OnGetClipboardData](#ongetclipboarddata)|Вызывается по системе, чтобы получить данные для копирования в Clipboard.|
|[ColeClientItem::OnInsertMenus](#oninsertmenus)|Вызывается фреймворком для создания композитного меню.|
|[ColeClientItem::OnRemoveMenus](#onremovemenus)|Вызывается фреймворком для удаления меню контейнера из композитного меню.|
|[ColeClientitem::OnsetMenu](#onsetmenu)|Вызывается в рамках для установки и удаления композитного меню.|
|[ColeClientitem::OnShowControlbars](#onshowcontrolbars)|Вызывается рамки, чтобы показать и скрыть контрольные бары.|
|[ColeClientitem::OnUpdateFrameTitle](#onupdateframetitle)|Вызывается фреймворк для обновления заглавной панели окна кадра.|
|[ColeClientitem::Reactivateandundo](#reactivateandundo)|Повторно активирует элемент и отменяет последнюю операцию редактирования на месте.|
|[ColeClientItem::Release](#release)|Выпускает соединение с элементом, связанным с OLE, и закрывает его, если он был открыт. Не разрушает клиентский элемент.|
|[ColeClientitem::Перезагрузка](#reload)|Перезагружает элемент после `ActivateAs`вызова.|
|[ColeClientItem::Run](#run)|Запускает приложение, связанное с элементом.|
|[ColeClientItem::SetDrawAspect](#setdrawaspect)|Устанавливает текущее представление элемента для рендеринга.|
|[ColeClientItem::SetExtent](#setextent)|Устанавливает ограничивающий прямоугольник элемента OLE.|
|[ColeClientItem::SetHostNames](#sethostnames)|Устанавливает имена, отображаемые сервером при редактировании элемента OLE.|
|[ColeClientItem::SetIconicMetafile](#seticonicmetafile)|Кэширует метафайл, используемый для рисования значка элемента.|
|[ColeClientItem::SetItemRects](#setitemrects)|Устанавливает прямоугольник ограничивающего элемента.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Устанавливает режим обновления для связанного элемента (продвинутая функция).|
|[ColeClientItem::SetPrintDevice](#setprintdevice)|Устанавливает устройство с печатной целью для этого элемента клиента.|
|[ColeClientItem::UpdateLink](#updatelink)|Обновляет кэш презентации элемента.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание|
|----------|-----------------|
|[ColeClientItem::CanActivate](#canactivate)|Вызывается по системе, чтобы определить, разрешена ли активация на месте.|
|[ColeClientitem::OnChangeItemposition](#onchangeitemposition)|Вызывается инфраструктурой при изменении позиции элемента.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Вызывается фреймворком, чтобы отменить после активации.|
|[ColeClientitem::OnDiscardUndostate](#ondiscardundostate)|Вызывается в рамках, чтобы отказаться от информации о состоянии элемента отменить.|
|[ColeClientItem::OnGetClipRect](#ongetcliprect)|Вызывается по фреймворку, чтобы получить координаты отсечения-прямоугольника элемента.|
|[ColeClientitem::OnGetItemposition](#ongetitemposition)|Вызывается в рамках, чтобы получить положение элемента относительно представления.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Вызывается фреймворками при активации элемента на месте.|
|[ColeClientitem::OnScrollby](#onscrollby)|Вызывается фреймворком для прокрутки элемента в поле зрения.|
|[ColeClientitem::OnshowItem](#onshowitem)|Вызывается по фрейму для отображения элемента OLE.|

## <a name="remarks"></a>Примечания

Элемент OLE представляет данные, созданные и поддерживаемые серверным приложением, которые могут быть "бесшовно" включены в документ, так что он представляется пользователю единым документом. Результатом является "комплексный документ", состоящий из элемента OLE и содержащего документ.

Элемент OLE может быть встроен или связан. Если он встроен, его данные хранятся как часть сложного документа. Если он связан, его данные хранятся как часть отдельного файла, созданного серверным приложением, и только ссылка на этот файл хранится в сложном документе. Все элементы OLE содержат информацию, определяющую серверное приложение, которое должно быть вызвано для их отсвагания.

`COleClientItem`определяет несколько переизликвых функций, которые вызываются в ответ на запросы серверного приложения; эти переизбытки обычно выступают в качестве уведомлений. Это позволяет серверному приложению информировать контейнер об изменениях, которые пользователь вносит при редактировании элемента OLE, или получать информацию, необходимую при редактировании.

`COleClientItem`может быть использован либо с [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), или [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) класса. Для `COleClientItem`использования, получения класса из него и реализации функции участника [OnChange,](#onchange) которая определяет, как контейнер реагирует на изменения, внесенные в элемент. Чтобы поддержать активацию на месте, переопределить функцию участника [OnGetItemPosition.](#ongetitemposition) Эта функция предоставляет информацию об отображаемом положении элемента OLE.

Для получения дополнительной информации об использовании контейнерного интерфейса [Activation](../../mfc/activation-cpp.md)см. [Containers: Implementing a Container](../../mfc/containers-implementing-a-container.md)

> [!NOTE]
> SDK Windows называет встроенные и связанные элементы «объектами» и относится к типам элементов как к «классам». Эта ссылка использует термин "элемент", чтобы отличить сущность OLE от соответствующего объекта СЗЗ и термин "тип", чтобы отличить категорию OLE от класса СЗ.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Требования

**Заголовок:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>ColeClientItem::Активировать

Вызовите эту функцию, чтобы выполнить указанный глагол вместо [DoVerb,](#doverb) чтобы вы могли сделать свою собственную обработку, когда исключение брошено.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*nVerb*<br/>
Определяет глагол для выполнения. Может принимать одно из следующих значений:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичный глагол|(нет)|
|- 1|Элемент отображения для редактирования|OLEIVERB_SHOW|
|- 2|Элемент отсечения в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрыть элемент|OLEIVERB_HIDE|

Значение -1 обычно является псевдонимом для другого глагола. Если открытое редактирование не поддерживается, -2 имеет тот же эффект, что и -1. Дополнительные значения можно узнать в SDK с мгновению [IOleObject::DoVerb.](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pView*<br/>
Указатель на окно представления контейнера, содержащее элемент OLE; это используется серверным приложением для активации на месте. Этот параметр должен быть NULL, если контейнер не поддерживает активацию на месте.

*lpMsg*<br/>
Указать на сообщение, которое вызвало активацию элемента.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки класса Microsoft `COleServerItem` Foundation, эта функция приводит к выполнению функции участника [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) соответствующего объекта.

Если основной глагол редактируется, а ноль указан в параметре *nVerb,* приложение сервера запускается, чтобы позволить редактировать элемент OLE. Если контейнерное приложение поддерживает активацию на месте, редактирование может быть сделано на месте. Если контейнер не поддерживает активацию на месте (или если указан глагол Open), сервер запускается в отдельном окне и редактирование может быть сделано там. Обычно, когда пользователь контейнерного приложения дважды щелкает элемент OLE, значение для основного глагола в параметре *nVerb* определяет, какие действия может предпринять пользователь. Однако, если сервер поддерживает только одно действие, он принимает это действие, независимо от того, какое значение указано в параметре *nVerb.*

Для получения дополнительной информации [см. IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) в Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>ColeClientItem::Activateas

Использует средства преобразования объектов OLE для активации элемента, как если бы он был элементом типа, указанного *clsidNew.*

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*lpszUserType*<br/>
Указатель на строку, представляющую тип целевого пользователя, например "Документ слова".

*clsidOld*<br/>
Ссылка на текущий идентификатор класса элемента. Идентификатор класса должен представлять тип фактического объекта, как сохраненный, если это не ссылка. В этом случае это должен быть CLSID элемента, к которому ссылается ссылка. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) автоматически предоставляет правильный идентификатор класса для элемента.

*clsidNew*<br/>
Ссылка на идентификатор целевого класса.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Это вызывается автоматически [COleConvertДиалог::DoПреобразовани.](../../mfc/reference/coleconvertdialog-class.md#doconvert) Обычно это не называется напрямую.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>ColeClientItem::AttachDataObject

Вызовите эту функцию, чтобы инициализировать [COleDataObject](../../mfc/reference/coledataobject-class.md) для доступа к данным в элементе OLE.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Параметры

*rDataObject*<br/>
Ссылка `COleDataObject` на объект, который будет инициализирован для обеспечения доступа к данным в элементе OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>ColeClientItem::CanActivate

Вызывается по системе, когда пользователь запрашивает активацию элемента OLE на месте; Значение возврата этой функции определяет, разрешена ли активация на месте.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если на месте активация допускается; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию позволяет активацию на месте, если контейнер имеет действительное окно. Переопределить эту функцию для реализации специальной логики для принятия или отказа от запроса активации. Например, запрос на активацию может быть отклонен, если элемент OLE слишком мал или в настоящее время не виден.

Для получения дополнительной информации [см. IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) в Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>ColeClientitem::CancreateFromData

Проверяет, может ли контейнерное приложение `COleDataObject` создать встроенный объект из данного объекта.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [COleDataObject,](../../mfc/reference/coledataobject-class.md) с которого должен быть создан элемент OLE.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если контейнер может создать `COleDataObject` встроенный объект из объекта; в противном случае 0.

### <a name="remarks"></a>Примечания

Класс `COleDataObject` используется в передаче данных для извлечения данных в различных форматах из Clipboard, через перетаскивание и падение, или от встроенного элемента OLE.

Контейнеры могут использовать эту функцию, чтобы принять решение о включании или отключить свои команды Edit Paste и Edit Paste Special.

Для получения дополнительной информации смотрите статью [Об объектах данных и источниках данных (OLE).](../../mfc/data-objects-and-data-sources-ole.md)

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>ColeClientitem::CanCreateLinkFromData

Проверяет, может ли контейнерное приложение `COleDataObject` создать связанный объект с данного объекта.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [COleDataObject,](../../mfc/reference/coledataobject-class.md) с которого должен быть создан элемент OLE.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если контейнер может создать `COleDataObject` связанный объект из объекта.

### <a name="remarks"></a>Примечания

Класс `COleDataObject` используется в передаче данных для извлечения данных в различных форматах из Clipboard, через перетаскивание и падение, или от встроенного элемента OLE.

Контейнеры могут использовать эту функцию, чтобы принять решение о включании или отключить свои команды Edit Paste Special и Edit Paste Link.

Для получения дополнительной информации смотрите статью [Об объектах данных и источниках данных (OLE).](../../mfc/data-objects-and-data-sources-ole.md)

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>ColeClientItem::CanPaste

Позвоните в эту функцию, чтобы увидеть, можно ли ввести встроенный элемент OLE из Clipboard.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если встроенный элемент OLE может быть вставлен из Clipboard; в противном случае 0.

### <a name="remarks"></a>Примечания

Для получения дополнительной информации, см [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) и [Оле-КуирайСоздатьFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) в Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>ColeClientItem::CanPasteLink

Позвоните в эту функцию, чтобы узнать, можно ли ввести связанный элемент OLE из Clipboard.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если связанный элемент OLE может быть вставлен из Clipboard; в противном случае 0.

### <a name="remarks"></a>Примечания

Для получения дополнительной информации, см [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) и [Ole'sininInFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) в Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>ColeClientItem::Закрыть

Вызовите эту функцию, чтобы изменить состояние элемента OLE из запущенного состояния в загруженное состояние, то есть, загруженное его обработчиком в памяти, но с сервером не работает.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Параметры

*dwCloseOption*<br/>
Пометить, при каких обстоятельствах элемент OLE сохраняется при возвращении в загруженное состояние. Может иметь одно из следующих значений:

- OLECLOSE_SAVEIFDIRTY Сохранить элемент OLE.

- OLECLOSE_NOSAVE Не сохраняйте элемент OLE.

- OLECLOSE_PROMPTSAVE Подтворете пользователю о том, следует ли сохранить элемент OLE.

### <a name="remarks"></a>Примечания

Эта функция не имеет эффекта, когда элемент OLE не работает.

Для получения дополнительной информации [см. IOleObject::Закрыть](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) в Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>ColeClientItem::ColeClientItem

Строит `COleClientItem` объект и добавляет его в коллекцию элементов документа контейнерного документа, который конструирует только объект КЗ и не выполняет никакой инициализации OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Параметры

*pContainerDoc*<br/>
Указатель на контейнерный документ, который будет содержать этот элемент. Это может быть любая производная [COleDocument.](../../mfc/reference/coledocument-class.md)

### <a name="remarks"></a>Примечания

Если вы проходите указатель NULL, к контейнеру не делается никаких добавлений. Вы должны явно позвонить [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Перед использованием элемента OLE необходимо позвонить в одну из следующих функций члена творения:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromDataDataData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [СозданиеNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>ColeClientitem::Convertto

Вызов эту функцию участника для преобразования элемента в тип, указанный *clsidNew.*

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*clsidNew*<br/>
Идентификатор класса целевого типа.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Это вызывается автоматически [COleConvertДиалог](../../mfc/reference/coleconvertdialog-class.md). Не стоит называть это напрямую.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>ColeClientitem::CopytoClipboard

Вызовите эту функцию, чтобы скопировать элемент OLE в Clipboard.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Параметры

*bIncludeLink*<br/>
TRUE, если ссылка информация должна быть скопирована на Clipboard, что позволяет связанный элемент, который будет вставлен; в противном случае FALSE.

### <a name="remarks"></a>Примечания

Как правило, эта функция называется при написании обработчиков сообщений для команд Copy или Cut из меню Edit. При желании реализовать команды Copy или Cut необходимо реализовать выбор элементов в контейнерном приложении.

Для получения дополнительной информации, см [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) в Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>ColeClientItem::CreateCloneFrom

Вызовите эту функцию, чтобы создать копию указанного элемента OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Параметры

*pSrcItem*<br/>
Указатель на элемент OLE, который будет дублироваться.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Копия идентична исходной элементу. Эту функцию можно использовать для поддержки отсутсвий операций.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>ColeClientitem::CreateFromClipboard

Вызовите эту функцию, чтобы создать встроенный элемент из содержимого Clipboard.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обычно эту функцию вызывают из обработчика сообщений для команды Пасты в меню Edit. (Команда Вставки включена инфраструктурой, если функция [canPaste](#canpaste) возвращается ненулево.)

Для получения дополнительной информации смотрите [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>ColeClientitem::CreateFromData

Вызовите эту функцию для `COleDataObject` создания встроенного элемента из объекта.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [COleDataObject,](../../mfc/reference/coledataobject-class.md) с которого должен быть создан элемент OLE.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Операции передачи данных, такие как вставки из Clipboard `COleDataObject` или операции перетаскивания, предоставляют объекты, содержащие информацию, предлагаемую серверным приложением. Он обычно используется в переопределение [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Для получения дополнительной информации, [см. OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>ColeClientitem::CreateFromFile

Вызовите эту функцию, чтобы создать встроенный элемент OLE из файла.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*lpszFileName*<br/>
Указатель на имя файла, из которого должен быть создан элемент OLE.

*clsid*<br/>
Зарезервировано для последующего использования.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Фрейм вызывает эту функцию от [COleInsertDialog::CreateItem,](../../mfc/reference/coleinsertdialog-class.md#createitem) если пользователь выбирает OK из окна диалога объекта вставки при выборе кнопки «Создание из файла».

Для получения дополнительной информации, [см. OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>ColeClientitem::CreateLinkFromClipboard

Вызовите эту функцию, чтобы создать связанный элемент из содержимого Clipboard.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обычно эту функцию вы вызывают от обработчика сообщений для команды Вставить Ссылка в меню Edit. (Команда Вставить ссылку включена в реализации [COleDocument](../../mfc/reference/coledocument-class.md) по умолчанию, если клипборд содержит элемент OLE, с которым можно связаться.)

Для получения дополнительной информации смотрите [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>ColeClientitem::CreateLinkFromData

Вызовите эту функцию для `COleDataObject` создания связанного элемента из объекта.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [COleDataObject,](../../mfc/reference/coledataobject-class.md) с которого должен быть создан элемент OLE.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызовите это во время операции падения, когда пользователь указывает, что ссылка должна быть создана. Он также может быть использован для обработки команды Edit Paste. Она называется рамкой `COleClientItem::CreateLinkFromClipboard` в и в [COlePasteSpecialDialog::CreateItem,](../../mfc/reference/colepastespecialdialog-class.md#createitem) когда вариант ссылки был выбран.

Для получения дополнительной информации, [см. OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>ColeClientitem::CreateLinkFromFile

Вызовите эту функцию, чтобы создать связанный элемент OLE из файла.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*lpszFileName*<br/>
Указатель на имя файла, из которого должен быть создан элемент OLE.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Рамочная система вызывает эту функцию, если пользователь выбирает OK из окна диалога объекта вставки при выборе кнопки «Создание из файла» и проверке флажка ссылки. Он называется от [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Для получения дополнительной информации, [см. OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>ColeClientItem::CreateNewItem

Вызовите эту функцию для создания встроенного элемента; эта функция запускает серверное приложение, которое позволяет пользователю создавать элемент OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*clsid*<br/>
Id, который однозначно определяет тип элемента OLE для создания.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Платформа вызывает эту функцию, если пользователь выбирает OK из окна диалога объекта вставки при выборе кнопки «Создание новой».

Для получения дополнительной информации [см. OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>ColeClientItem::CreateStaticFromClipboard

Вызовите эту функцию, чтобы создать статический элемент из содержимого Clipboard.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Статический элемент содержит данные презентации, но не родные данные; следовательно, он не может быть отредактирован. Обычно эту функцию можно вызвать, если функция члена [CreateFromClipboard](#createfromclipboard) выходит из строя.

Для получения дополнительной информации смотрите [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>ColeClientitem::CreateStaticFromData

Вызовите эту функцию для `COleDataObject` создания статического элемента из объекта.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [COleDataObject,](../../mfc/reference/coledataobject-class.md) с которого должен быть создан элемент OLE.

*Визуализации*<br/>
Пометить, как сервер будет отображять элемент OLE. Для возможных значений [см.](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
Определяет формат данных Clipboard, который будет кэшироваться при создании элемента OLE.

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC,](/windows/win32/api/objidl/ns-objidl-formatetc) используемую при *OLERENDER_FORMAT* или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительную информацию о формате за пределами формата Clipboard, указанного *cfFormat.* При опускании этого параметра значения по умолчанию используются для других полей в структуре. `FORMATETC`

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Статический элемент содержит данные презентации, но не родные данные; следовательно, он не может быть отредактирован. Это по существу то же самое, что [CreateStaticFromClipboard](#createstaticfromclipboard) за `COleDataObject`исключением того, что статический элемент может быть создан из произвольного, а не только из Clipboard.

Используется в [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) при выборе Static.

Для получения дополнительной информации, [см. OleCreateStaticFromDataDataDataData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), и [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>ColeClientItem::Dэактив

Вызовите эту функцию, чтобы отключить элемент OLE и освободить все связанные ресурсы.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Примечания

Обычно вы деактивируете на месте активный элемент OLE, когда пользователь нажимает мышь на область клиента за пределами элемента. Обратите внимание, что деактивация элемента OLE отбросит его отменить состояние, что делает невозможным вызов [функции reactivateAndUndo.](#reactivateandundo)

Если приложение поддерживает отменить, `Deactivate`не звоните; вместо этого вызов [DeactivateUI](#deactivateui).

Для получения дополнительной информации [см. IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>ColeClientItem::DeactivateUI

Вызов ими функции, когда пользователь деактивирует элемент, который был активирован на месте.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Примечания

Эта функция восстанавливает пользовательский интерфейс контейнерного приложения в исходное состояние, скрывая все меню и другие элементы управления, которые были созданы для активации на месте.

Эта функция не смывает информацию о состоянии отсутсвия для элемента. Эта информация сохраняется таким образом, что [ReactivateAndUndo](#reactivateandundo) позже может быть использован для выполнения команды отменить в приложении сервера, в случае, если команда отсрочения контейнера выбрана сразу после деактивации элемента.

Для получения дополнительной информации [см. IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>ColeClientItem::Delete

Вызовите эту функцию, чтобы удалить элемент OLE из контейнерного документа.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Параметры

*bAutoDelete*<br/>
Уточняется, следует ли удалить элемент из документа.

### <a name="remarks"></a>Примечания

Эта функция вызывает функцию участника [релиза,](#release) которая, в свою очередь, удаляет объект C's для элемента, постоянно удаляя элемент OLE из документа. Если элемент OLE встроен, родные данные для элемента удаляются. Он всегда закрывает работающий сервер; поэтому, если элемент является открытым звеном, эта функция закрывает его.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>ColeClientItem::DoDragDrop

Вызов `DoDragDrop` функции участника для выполнения операции перетаскивания.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Параметры

*lpItemRect*<br/>
Прямоугольник элемента на экране в координатах клиента (пикселей).

*ptOffset*<br/>
Смещение от *lpItemRect,* где положение мыши было во время перетаскивания.

*bIncludeLink*<br/>
Установите это в правду, если данные о ссылке должны быть скопированы на Clipboard. Установите его на FALSE, если приложение сервера не поддерживает ссылки.

*dwEffects*<br/>
Определяет эффекты, которые источник перетаскивания позволит в операции перетаскивания.

*lpRectStartDrag*<br/>
Указатель на прямоугольник, который определяет, где на самом деле начинается сопротивление. Дополнительные сведения см. в разделе "Примечания".

### <a name="return-value"></a>Возвращаемое значение

Значение DROPEFFECT. Если это DROPEFFECT_MOVE, исходные данные должны быть удалены.

### <a name="remarks"></a>Примечания

Операция перетаскивания начинается не сразу. Он ждет, пока курсор мыши не покинет прямоугольник, указанный *lpRectStartDrag,* или до тех пор, пока не пройдет определенное количество миллисекунд. Если *lpRectStartDrag* является NULL, размер прямоугольника составляет один пиксель.

Время задержки определяется параметром ключа реестра. Вы можете изменить время задержки, позвонив [в CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) или [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Если вы не указали время задержки, используется значение по умолчанию 200 миллисекунд. Время задержки перетаскивания сохраняется следующим образом:

- Время задержки Windows NT Drag хранится в HKEY_LOCAL_MACHINE»SOFTWARE-Microsoft-Windows-NT-CurrentVersion-IniFileMapping-win.ini-Windows-DragDelay.

- Время задержки Windows 3.x Перетащите сохраняется в WIN. Файл INI, в разделе «Окна».

- Время задержки Windows 95/98 перетащите хранится в кэшированной версии WIN. Ini.

Для получения дополнительной информации о том, как информация о задержке перетаскивания хранится в реестре или . INI файл, [см. WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) в Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>ColeClientItem::DoVerb

Вызов `DoVerb` для выполнения указанного глагола.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*nVerb*<br/>
Определяет глагол для выполнения. Она может включать в себя один из следующих:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичный глагол|(нет)|
|- 1|Элемент отображения для редактирования|OLEIVERB_SHOW|
|- 2|Элемент отсечения в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрыть элемент|OLEIVERB_HIDE|

Значение -1 обычно является псевдонимом для другого глагола. Если открытое редактирование не поддерживается, -2 имеет тот же эффект, что и -1. Дополнительные значения можно узнать в SDK с мгновению [IOleObject::DoVerb.](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pView*<br/>
Указатель на окно вида; это используется сервером для активации на месте. Этот параметр должен быть NULL, если контейнерное приложение не позволяет активацию на месте.

*lpMsg*<br/>
Указать на сообщение, которое вызвало активацию элемента.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если глагол был успешно выполнен; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция вызывает функцию члена [активации](#activate) для выполнения глагола. Он также ловит исключения и отображает окно сообщения для пользователя, если один брошен.

Если основной глагол редактируется, а ноль указан в параметре *nVerb,* приложение сервера запускается, чтобы позволить редактировать элемент OLE. Если контейнерное приложение поддерживает активацию на месте, редактирование может быть сделано на месте. Если контейнер не поддерживает активацию на месте (или если указан глагол Open), сервер запускается в отдельном окне и редактирование может быть сделано там. Обычно, когда пользователь контейнерного приложения дважды щелкает элемент OLE, значение для основного глагола в параметре *nVerb* определяет, какие действия может предпринять пользователь. Однако, если сервер поддерживает только одно действие, он принимает это действие, независимо от того, какое значение указано в параметре *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>ColeClientItem::Draw

Назовите эту функцию, чтобы нарисовать элемент OLE в указанный прямоугольник, используя указанный контекст устройства.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на объект [CDC,](../../mfc/reference/cdc-class.md) используемый для рисования элемента OLE.

*lpBounds*<br/>
Указатель на объект [cRect](../../atl-mfc-shared/reference/crect-class.md) или `RECT` структуру, определяющий прямоугольник, в котором можно нарисовать элемент OLE (в логических единицах, определяемых контекстом устройства).

*nDrawAspect*<br/>
Определяет аспект элемента OLE, то есть, как он должен отображаться. Если *nDrawAspect* является -1, используется последний аспект, установленный с помощью [SetDrawAspect.](#setdrawaspect) Для получения дополнительной информации о возможных значениях для этого [флага](#setdrawaspect)см.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Функция может использовать метафиле представления элемента OLE, созданный `COleServerItem`функцией члена [OnDraw.](../../mfc/reference/coleserveritem-class.md#ondraw)

Обычно вы `Draw` используете для отображения экрана, проходя контекст устройства экрана как *pDC.* В этом случае необходимо указать только первые два параметра.

Параметр *lpBounds* определяет прямоугольник в контексте целевого устройства (относительно текущего режима отображения). Рендеринг может включать масштабирование изображения и может использоваться контейнерными приложениями для наложения представления, которое масштабируется между отображаемым представлением и окончательным печатным изображением.

Для получения дополнительной информации с [:Dм.](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>ColeClientItem::GetActiveView

Возвращает представление, на котором активируется элемент.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на вид; в противном случае NULL, если элемент не активирован.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>ColeClientItem::GetCached

Вызовите эту функцию, чтобы получить размер элемента OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*lpSize*<br/>
Указатель на `SIZE` структуру или объект [CSize,](../../atl-mfc-shared/reference/csize-class.md) который будет получать информацию о размере.

*nDrawAspect*<br/>
Определяет сяокард элемента OLE, границы которого должны быть извлечены. Для возможных значений [см.](#setdrawaspect)

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; 0, если элемент OLE пуст.

### <a name="remarks"></a>Примечания

Эта функция предоставляет ту же информацию, что и [GetExtent](#getextent). Тем не менее, вы можете позвонить, `GetCachedExtent` чтобы получить информацию о степени во время обработки других обработчиков OLE, таких как [OnChange.](#onchange) Размеры находятся в MM_HIMETRIC единицах.

Это возможно, `GetCachedExtent` потому что использует интерфейс [IViewObject2,](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) а не использовать интерфейс [IOleObject,](/windows/win32/api/oleidl/nn-oleidl-ioleobject) чтобы получить степень этого элемента. Объект `IViewObject2` COM кэши степень информации, используемой в предыдущем вызове [iViewObject: :Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Для получения дополнительной [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) информации см.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>ColeClientItem::GetClassID

Возвращает идентификатор класса элемента в память, на которую указывает *pClassID.*

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Параметры

*pClassID*<br/>
Указатель на идентификатор типа [CLSID](/windows/win32/com/clsid-key-hklm) для получения идентификатора класса. Для получения информации о CLSID, см.

### <a name="remarks"></a>Примечания

Идентификатор класса — это 128-битный номер, который однозначно идентифицирует приложение, которое правит элемент.

Для получения дополнительной информации см. [IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) в Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>ColeClientItem::GetClipboardData

Вызов исправитесь этой функцией, чтобы получить объект, `COleDataSource` содержащий все данные, которые будут размещены на Clipboard, по звонку в функцию участника [CopyToClipboard.](#copytoclipboard)

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Параметры

*pDataИсточник*<br/>
Указатель на объект [COleDataSource,](../../mfc/reference/coledatasource-class.md) который будет получать данные, содержащиеся в элементе OLE.

*bIncludeLink*<br/>
TRUE, если ссылка данные должны быть включены; в противном случае FALSE.

*lpOffset*<br/>
Смещение курсора мыши от происхождения объекта в пикселях.

*lpSize*<br/>
Размер объекта в пикселях.

### <a name="remarks"></a>Примечания

`GetClipboardData`называется реализацией по умолчанию [OnGetClipboardData](#ongetclipboarddata). Переопределение `OnGetClipboardData` только в том случае, если вы хотите `CopyToClipboard`предложить форматы данных в дополнение к тем, которые предлагаются . Поместите эти форматы `COleDataSource` в объекте до или после вызова, `CopyToClipboard`а затем передать `COleDataSource` объект [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) функции. Например, если вы хотите, чтобы позиция элемента OLE в контейнерном документе сопровождала его на Clipboard, `COleDataSource` вы `CopyToClipboard`бы определили свой собственный формат передачи этой информации и поместите ее в перед вызовом.

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>ColeClientItem::GetDocument

Вызовите эту функцию, чтобы получить указатель на документ, содержащий элемент OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на документ, содержащий элемент OLE. NULL, если элемент не является частью документа.

### <a name="remarks"></a>Примечания

Этот указатель позволяет `COleDocument` получить доступ к объекту, `COleClientItem` который вы передали в качестве аргумента конструктору.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>ColeClientItem::GetDrawAspect

Вызовфункции `GetDrawAspect` участника, чтобы определить текущий "аспект" или представление элемента.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение из перечисления DVASPECT, значения которого перечислены в ссылке для [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Примечания

Аспект определяет, как элемент должен быть отображены.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>ColeClientItem::GetExtent

Вызовите эту функцию, чтобы получить размер элемента OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Параметры

*lpSize*<br/>
Указатель на `SIZE` структуру `CSize` или объект, который будет получать информацию о размере.

*nDrawAspect*<br/>
Определяет сяокард элемента OLE, границы которого должны быть извлечены. Для возможных значений [см.](#setdrawaspect)

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; 0, если элемент OLE пуст.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки класса Microsoft `COleServerItem` Foundation, эта функция вызывает вызов функции участника [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) соответствующего объекта. Обратите внимание, что извлеченный размер может отличаться от размера, установленного функцией участника [SetExtent;](#setextent) размер, `SetExtent` указанный, рассматривается как предложение. Размеры находятся в MM_HIMETRIC единицах.

> [!NOTE]
> Не звоните `GetExtent` во время обработки обработчика OLE, например [OnChange.](#onchange) Вместо этого позвоните [getCachedExtent.](#getcachedextent)

Для получения дополнительной информации [см. IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) в Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>ColeClientitem::GetIconFromRegistry

Вызов ими функции участника для извлечения ручки ресурсу значка, связанного с сервером конкретного CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Параметры

*clsid*<br/>
Ссылка на CLSID для сервера, связанного с иконой.

### <a name="return-value"></a>Возвращаемое значение

Действительная ручка ресурса значка, или NULL, если значок сервера, или значок по умолчанию, не может быть найден.

### <a name="remarks"></a>Примечания

Эта функция участника не запустит сервер или не получит значок динамически, даже если сервер уже запущен. Вместо этого эта функция-член открывает исполняемое изображение сервера и получает статический значок, связанный с сервером по мере его регистрации.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>ColeClientItem::GetIconicMetafile

Извлекает метафайл, используемый для рисования значка элемента.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Возвращаемое значение

Ручка к метафайлу в случае успеха; в противном случае NULL.

### <a name="remarks"></a>Примечания

Если нет текущего значка, возвращается значок по умолчанию. Это называется автоматически диалогами MFC/OLE и обычно не вызывается напрямую.

Эта функция также вызывает [SetIconicMetafile](#seticonicmetafile) для кэша метафайла для последующего использования.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>ColeClientitem::GetinplaceWindow

Позвоните `GetInPlaceWindow` функции участника, чтобы получить указатель на окно, в котором элемент был открыт для редактирования на месте.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на окно редактирования элемента на месте; NULL, если элемент не активен или если его сервер недоступен.

### <a name="remarks"></a>Примечания

Эта функция должна вызываться только для элементов, которые находятся в месте активного.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>ColeClientItem::GetItemState

Вызовите эту функцию, чтобы получить текущее состояние элемента OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Возвращаемое значение

`COleClientItem::ItemState` Перечисленное значение, которое может быть одним `emptyState` `loadedState`из `openState` `activeState`следующих: , , . `activeUIState` Для получения информации об [Containers: Client-Item States](../../mfc/containers-client-item-states.md)этих государствах см.

### <a name="remarks"></a>Примечания

Чтобы уведомляться при изменении состояния элемента OLE, используйте функцию участника [OnChange.](#onchange)

Для получения дополнительной информации см. [Containers: Client-Item States](../../mfc/containers-client-item-states.md)

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>ColeClientItem::GetLastStatus

Возвращает код состояния последней операции OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение SCODE.

### <a name="remarks"></a>Примечания

Для функций участника, возвращающие значение BOOL FALSE, или `GetLastStatus` другие функции участника, возвращающие NULL, возвращает более подробную информацию о сбое. Имейте в виду, что большинство функций членов OLE бросают исключения для более серьезных ошибок. Конкретная информация о интерпретации SCODE зависит от основного вызова OLE, который в последний раз возвращал значение SCODE.

Для получения дополнительной информации о SCODE [см.](/windows/win32/com/structure-of-com-error-codes)

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>ColeClientItem::GetLinkUpdateOptions

Вызовите эту функцию, чтобы получить текущее значение опции обновления ссылок для элемента OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Возвращаемое значение

Одно из следующих значений:

- OLEUPDATE_ALWAYS обновлять связанный элемент, когда это возможно. Эта опция поддерживает кнопку автоматического обновления ссылки в диалоговом поле Ссылки.

- OLEUPDATE_ONCALL обновить связанный элемент только по запросу контейнерного приложения (когда вызывается функция участника [UpdateLink).](#updatelink) Эта опция поддерживает кнопку передачи ссылки Ручного обновления в диалоговом поле Ссылки.

### <a name="remarks"></a>Примечания

Это передовая операция.

Эта функция автоматически вызывается классом [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Для получения дополнительной информации [см. IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) в Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>ColeClientItem::GetType

Вызовите эту функцию, чтобы определить, является ли элемент OLE встроенным или связанным или статичным.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Возвращаемое значение

Неподписанный сечение с одним из следующих значений:

- OT_LINK элемент OLE является ссылкой.

- OT_EMBEDDED элемент OLE встроен.

- OT_STATIC элемент OLE статичен, то есть содержит только презентационные данные, а не нативные данные, и поэтому не может быть отредактирован.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>ColeClientItem::GetUserType

Вызовите эту функцию, чтобы получить видимую для пользователя строку, описывающую тип элемента OLE, например "Документ слова".

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Параметры

*nUserClassType*<br/>
Значение, указывающее на желаемый вариант строки, описывающее тип элемента OLE. Это может иметь одно из следующих значений:

- USERCLASSTYPE_FULL Имя полного типа отображается пользователю.

- USERCLASSTYPE_SHORT короткое имя (максимум 15 символов) для использования во всплывающих меню и диалоговом окне Edit Links.

- USERCLASSTYPE_APPNAME название приложения, обслуживающего класс.

*rString*<br/>
Ссылка на объект [CString,](../../atl-mfc-shared/reference/cstringt-class.md) на который должна быть возвращена строка, описывающая тип элемента OLE.

### <a name="remarks"></a>Примечания

Это часто запись в базу данных регистрации системы.

Если имя полного типа запрашивается, но недоступно, вместо него используется короткое имя. Если в базе данных регистрации нет входа для типа элемента OLE или если нет типов пользователей, зарегистрированных для типа элемента OLE, используется тип пользователя, который в настоящее время хранится в элементе OLE. Если это имя типа пользователя является пустой строкой, используется "Неизвестный объект".

Для получения дополнительной информации [см. IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) в Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>ColeClientitem::IsinPlaceActive

Вызовите эту функцию, чтобы узнать, является ли элемент OLE на месте активным.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент OLE находится на месте активного; в противном случае 0.

### <a name="remarks"></a>Примечания

Обычно выполняется разная логика в зависимости от того, редактируется ли элемент. Функция проверяет, является ли текущее состояние `activeState` элемента равным либо `activeUIState`или .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>ColeClientitem::Islinkuptodate

Позвоните в эту функцию, чтобы узнать, актуален ли элемент OLE.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент OLE актуален; в противном случае 0.

### <a name="remarks"></a>Примечания

Связанный элемент может быть устаревшим, если его исходный документ был обновлен. Встроенный элемент, содержащий ссылки внутри него, также может устареть. Функция делает рекурсивную проверку элемента OLE. Обратите внимание, что определение того, является ли элемент OLE устаревшим, может быть таким же дорогим, как и выполнение обновления.

Это вызывается автоматически реализацией [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Для получения дополнительной информации [см. IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) в Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>ColeClientItem::Ismodified

Вызовите эту функцию, чтобы увидеть, является ли элемент OLE грязным (измененным с момента его последнего сохранения).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент OLE является грязным; в противном случае 0.

### <a name="remarks"></a>Примечания

Для получения дополнительной информации см. [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) в Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>ColeClientItem::IsOpen

Вызовите эту функцию, чтобы узнать, открыт ли элемент OLE; т.е. открыт в экземпляре серверного приложения, работая в отдельном окне.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент OLE открыт; в противном случае 0.

### <a name="remarks"></a>Примечания

Он используется для определения того, когда рисовать объект с вылупляющимся рисунком. Открытый объект должен иметь рисунок люка, нарисованный поверх объекта. Для этого можно использовать объект [CRectTracker.](../../mfc/reference/crecttracker-class.md)

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>ColeClientItem::IsRunning

Вызовите эту функцию, чтобы узнать, работает ли элемент OLE; то есть, загружается ли элемент и работает в серверном приложении.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент OLE работает; в противном случае 0.

### <a name="remarks"></a>Примечания

Для получения дополнительной информации смотрите [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) в Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>ColeClientitem::Onactivate

Вызывается по системе, чтобы уведомить элемент, что он только что был активирован на месте.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Примечания

Обратите внимание, что эта функция называется, чтобы указать, что сервер работает, не указывать, что его пользовательский интерфейс был установлен в контейнерном приложении. На данный момент объект не имеет активного `activeUIState`пользовательского интерфейса (не). Он не установил свои меню или панели инструментов. Функция члена [OnActivateUI](#onactivateui) вызывается, когда это происходит.

Реализация по умолчанию вызывает функцию члена [OnChange](#onchange) с OLE_CHANGEDSTATE в качестве параметра. Переопределить эту функцию для выполнения пользовательской обработки, когда элемент становится активным.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>ColeClientitem::OnactivateuI

Система вызывает `OnActivateUI` при входе объекта в состояние активного uI.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Примечания

Теперь на объекте установлена панель инструментов и меню.

Реализация по умолчанию запоминает HWND сервера для последующих `GetServerWindow` вызовов.

## <a name="coleclientitemonchange"></a><a name="onchange"></a>ColeClientitem::OnChange

Вызывается фреймворком, когда пользователь изменяет, сохраняет или закрывает элемент OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Параметры

*nКод*<br/>
Причина, по которой сервер изменил этот элемент. Может иметь одно из следующих значений:

- OLE_CHANGED внешний вид элемента OLE изменился.

- OLE_SAVED элемент OLE сохранен.

- OLE_CLOSED элемент OLE закрыт.

- OLE_CHANGED_STATE элемент OLE изменился из одного состояния в другое.

*dwParam*<br/>
Если *nCode* OLE_SAVED или OLE_CLOSED, этот параметр не используется. Если *nCode* OLE_CHANGED, этот параметр определяет аспект измененного элемента OLE. Для возможных значений, см *dwParam* параметр [COleClientItem: :Draw](#draw). Если *nCode* является OLE_CHANGED_STATE, `COleClientItem::ItemState` этот параметр является перечисленным значением и описывает состояние, вписанное. Он может иметь одно из `emptyState`следующих `openState` `activeState`значений: , `loadedState`, , или `activeUIState`.

### <a name="remarks"></a>Примечания

(Если приложение сервера написано с помощью библиотеки класса Microsoft `Notify` Foundation, `COleServerDoc` `COleServerItem`эта функция называется в ответ на функции участника или .) Реализация по умолчанию помечает контейнерный документ как измененный, если *nCode* OLE_CHANGED или OLE_SAVED.

Для OLE_CHANGED_STATE текущее состояние, возвращенное из [GetItemState,](#getitemstate) будет по-прежнему старым состоянием, то есть состоянием, которое было в настоящее время до изменения этого состояния.

Переопределить эту функцию, чтобы реагировать на изменения в состоянии элемента OLE. Обычно вы обновляете внешний вид элемента, отменяя область, в которой отображается элемент. Вызовите реализацию базового класса в начале переопределения.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>ColeClientitem::OnChangeItemposition

Вызывается по системе, чтобы уведомить контейнер о том, что объем элемента OLE изменился во время активации на месте.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Параметры

*rectPos*<br/>
Отослает положение товара относительно клиентской области контейнерного приложения.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если позиция элемента успешно изменена; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию определяет новый видимый прямоугольник элемента OLE и вызывает [SetItemRects](#setitemrects) с новыми значениями. Реализация по умолчанию вычисляет видимый прямоугольник для элемента и передает эту информацию серверу.

Переопределить эту функцию, чтобы применить специальные правила к операции повторного размера/перемещения. Если приложение написано в MFC, этот вызов приводит к тому, что сервер под названием [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>ColeClientitem::OnDeactivate

Вызывается фректовой при переходе элемента OLE `activeState`из состояния активного () в загруженное состояние, что означает, что он деактивирован после активации на месте.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Примечания

Обратите внимание, что эта функция называется, чтобы указать, что элемент OLE закрыт, а не что его пользовательский интерфейс был удален из контейнерного приложения. Когда это происходит, вызывается функция члена [OnDeactivateUI.](#ondeactivateui)

Реализация по умолчанию вызывает функцию члена [OnChange](#onchange) с OLE_CHANGEDSTATE в качестве параметра. Переопределить эту функцию для выполнения пользовательской обработки при деактивации активного элемента на месте. Например, если вы поддерживаете команду отменить в приложении контейнера, можно переопределить эту функцию, чтобы отбросить состояние отсутсвия, указав, что последняя операция, выполненная на элементе OLE, не может быть отменена после деактивации элемента.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>ColeClientitem::OnDeactivateandundo

Вызывается по системе, когда пользователь вызывает команду отмены после активации элемента OLE на месте.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию вызывает [деактивацию для](#deactivateui) деактивации пользовательского интерфейса сервера. Переопределить эту функцию, если вы реализуете команду отменить в контейнерном приложении. В переопределением позвоните в версию функции базового класса, а затем отмените последнюю команду, выполненную в приложении.

Для получения дополнительной информации, [см. IOleInPlaceSite: :DактивированитьAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) в Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>ColeClientitem::OnDeactivateuI

Вызывается, когда пользователь деактивирует элемент, который был активирован на месте.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Параметры

*bUndoable*<br/>
Уточняется, являются ли изменения редактирования невырахлыми.

### <a name="remarks"></a>Примечания

Эта функция восстанавливает пользовательский интерфейс контейнерного приложения в исходное состояние, скрывая все меню и другие элементы управления, которые были созданы для активации на месте.

Если *bUndoable* false, контейнер должен отключить команду отменить, фактически отбрасывая состояние отстойности контейнера, поскольку это означает, что последняя операция, выполненная сервером, не отменяется.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>ColeClientitem::OnDiscardUndostate

Вызывается по системе, когда пользователь выполняет действие, которое отбрасывает состояние отсутсвия при редактировании элемента OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий. Переопределить эту функцию, если вы реализуете команду отменить в контейнерном приложении. В переопределение откажитесь от состояния приложения контейнера.

Если сервер был написан в библиотеке microsoft Foundation Class Library, сервер может вызвать эту функцию, позвонив по телефону [COleServerDoc::DiscardUndoState.](../../mfc/reference/coleserverdoc-class.md#discardundostate)

Для получения дополнительной информации, [см. IOleInPlaceSite: :DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) в Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>ColeClientitem::OnGetClipboardData

Вызывается по системе, `COleDataSource` чтобы получить объект, содержащий все данные, которые будут размещены на Clipboard по вызову либо [CopyToClipboard](#copytoclipboard) или функции члена [DoDragDrop.](#dodragdrop)

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Параметры

*bIncludeLink*<br/>
Установите это в правду, если ссылка данные должны быть скопированы на Clipboard. Установите это на FALSE, если приложение сервера не поддерживает ссылки.

*lpOffset*<br/>
Указатель на смещение курсора мыши от происхождения объекта в пикселях.

*lpSize*<br/>
Указатель на размер объекта в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [COleDataSource,](../../mfc/reference/coledatasource-class.md) содержащий данные Clipboard.

### <a name="remarks"></a>Примечания

Реализация этой функции по умолчанию вызывает [GetClipboardData.](#getclipboarddata)

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>ColeClientItem::OnGetClipRect

Платформа вызывает `OnGetClipRect` функцию элемента, чтобы получить координаты отсечения прямоугольника элемента, который редактируется на месте.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Параметры

*rClipRect*<br/>
Указатель на объект класса [CRect,](../../atl-mfc-shared/reference/crect-class.md) который будет держать координаты отсечения прямоугольника элемента.

### <a name="remarks"></a>Примечания

Координаты находятся в пикселях относительно клиентской области окна контейнерного приложения.

Реализация по умолчанию просто возвращает прямоугольник клиента в виде, на котором элемент находится в месте активной.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>ColeClientitem::OnGetItemposition

Платформа вызывает `OnGetItemPosition` функцию участника, чтобы получить координаты элемента, который редактируется на месте.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Параметры

*rPosition*<br/>
Ссылка на объект [CRect,](../../atl-mfc-shared/reference/crect-class.md) который будет содержать координаты положения элемента.

### <a name="remarks"></a>Примечания

Координаты находятся в пикселях относительно клиентской области окна контейнерного приложения.

Реализация по умолчанию этой функции не выполняет никаких действий. Приложения, поддерживающие редактирование на месте, требуют его реализации.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>ColeClientitem::OngetWindowContext

Вызывается фреймворками при активации элемента на месте.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Параметры

*ppMainFrame*<br/>
Указатель на указатель на окно основной рамы.

*ppDocFrame*<br/>
Указатель на указатель на окно кадра документа.

*lpFrameInfo*<br/>
Указатель на структуру [OLEINPLACEFRAMEINFO,](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) которая будет получать информацию о окне кадра.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция используется для получения информации о родительском окне элемента OLE.

Если контейнер является приложением MDI, реализация по умолчанию возвращает указатель на объект [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) в *ppMainFrame* и указатель на активный объект [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) в *ppDocFrame.* Если контейнер является приложением SDI, реализация по умолчанию возвращает указатель объекту [CFrameWnd](../../mfc/reference/cframewnd-class.md) в *ppMainFrame* и возвращает NULL в *ppDocFrame.* Реализация по умолчанию также заполняет членов *lpFrameInfo*.

Переопределить эту функцию только в том случае, если реализация по умолчанию не подходит вашему приложению; например, если ваше приложение имеет парадигму пользовательского интерфейса, которая отличается от SDI или MDI. Это передовой overridable.

Для получения дополнительной информации [см. IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) и [oleINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) структуры в Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>ColeClientItem::OnInsertMenus

Вызывается фреймворком во время активации на месте, чтобы вставить меню контейнерного приложения в пустое меню.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указывает на пустое меню.

*lpMenuВайзах*<br/>
Указывает на массив из шести значений LONG, указывающих, сколько меню в каждой из следующих групп меню: Файл, Отображаются, контейнеры, объекты, окна, справки. Контейнерное приложение отвечает за группы меню файлов, контейнеров и окон, соответствующие элементам 0, 2 и 4 этого массива.

### <a name="remarks"></a>Примечания

Затем это меню передается серверу, который вставляет свои собственные меню, создавая составное меню. Эту функцию можно неоднократно вызывать для создания нескольких композитных меню.

Реализация по умолчанию вставляется в *pMenuShared* меню контейнеров на месте; то есть группы меню «Файл», «Контейнер» и «Окно». [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) используется для установки этого ресурса меню. Реализация по умолчанию также присваивает соответствующие значения элементам 0, 2 и 4 в *lpMenuWidths*, в зависимости от ресурса меню. Переопределить эту функцию, если реализация по умолчанию не подходит для приложения; например, если приложение не использует шаблоны документов для связывания ресурсов с типами документов. Если вы переопределяете эту функцию, вы также должны переопределить [OnSetMenu](#onsetmenu) и [OnRemoveMenus.](#onremovemenus) Это передовой overridable.

Для получения дополнительной информации [см.](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus)

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>ColeClientItem::OnRemoveMenus

Вызов в фреймворк для удаления меню контейнера из указанного композитного меню по окончании активации на месте.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указывает на составное меню, построенное по вызовам в функцию участника [OnInsertMenus.](#oninsertmenus)

### <a name="remarks"></a>Примечания

Реализация по умолчанию удаляет из *pMenuShared* меню контейнеров на месте, т.е. группы меню файлов, контейнеров и окон. Переопределить эту функцию, если реализация по умолчанию не подходит для приложения; например, если приложение не использует шаблоны документов для связывания ресурсов с типами документов. Если вы переопределяете эту функцию, вы, вероятно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnSetMenu,](#onsetmenu) а также. Это передовой overridable.

Подменю на *pMenuShared* может быть общим для более чем одного `OnInsertMenus`композитного меню, если сервер неоднократно звонил. Поэтому вы не должны удалять любые подменю в переопределение `OnRemoveMenus`; Вы должны только отсоединить их.

Для получения дополнительной информации [см.](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus)

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>ColeClientitem::OnScrollby

Вызывается платформой для прокрутки элемента OLE в ответ на запросы сервера.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Параметры

*sizeExtent*<br/>
Определяет расстояния, в пикселях, для прокрутки в направлениях x и y.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент был прокрутлен; 0, если элемент не может быть прокрутлен.

### <a name="remarks"></a>Примечания

Например, если элемент OLE частично виден и пользователь перемещается за пределы видимой области при выполнении редактирования на месте, эта функция называется для сохранения видимого курсора. Реализация по умолчанию не выполняет никаких действий. Переопределить эту функцию, чтобы прокрутить элемент на указанную сумму. Обратите внимание, что в результате прокрутки видимая часть элемента OLE может измениться. Позвоните [SetItemRects,](#setitemrects) чтобы обновить видимый прямоугольник элемента.

Для получения дополнительной информации [см.](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll)

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>ColeClientitem::OnsetMenu

Вызывается инфраструктурой два раза, когда активация на месте начинается и заканчивается; первый раз для установки композитного меню и во второй раз (с *holemenu* равна NULL), чтобы удалить его.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указатель на составное меню, построенное путем вызовов на функцию и функцию участника [OnInsertMenus](#oninsertmenus) и функцию. `InsertMenu`

*holemenu*<br/>
Ручка к дескриптору `OleCreateMenuDescriptor` меню, возвращенному функцией, или NULL, если код отправки должен быть удален.

*hwndActiveObject*<br/>
Ручка к окну редактирования для элемента OLE. Это окно, которое будет получать команды редактирования от OLE.

### <a name="remarks"></a>Примечания

Реализация по умолчанию устанавливает или удаляет композитное меню, а затем вызывает функцию [OleSetMenuDeSscriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) для установки или удаления диспетчерского кода. Переопределить эту функцию, если реализация по умолчанию не подходит для приложения. Если вы переопределяете эту функцию, вы, вероятно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnRemoveMenus,](#onremovemenus) а также. Это передовой overridable.

Для получения дополнительной информации, см [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor), и [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) в Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>ColeClientitem::OnShowControlbars

Вызывается по системе, чтобы показать и скрыть панели управления контейнерного приложения.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Параметры

*pFrameWnd*<br/>
Указатель на окно рамы контейнерного приложения. Это может быть либо окно основной рамы, либо окно ребенка MDI.

*bShow*<br/>
Определяет, должны ли быть показаны или скрыты контрольные бары.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов функции вызывает изменение состояния контрольных батончиков; 0, если вызов не вызывает никаких изменений, или если *pFrameWnd* не указывает на окно кадра контейнера.

### <a name="remarks"></a>Примечания

Эта функция возвращает 0, если панели управления уже находятся в состоянии, указанном *bShow.* Это произойдет, например, если панели управления скрыты и *bShow* является FALSE.

Реализация по умолчанию удаляет панель инструментов из окна кадра верхнего уровня.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>ColeClientitem::OnshowItem

Вызывается фреймворк для отображения элемента OLE, что делает его полностью видимым при редактировании.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Примечания

Он используется, когда приложение контейнера поддерживает ссылки на встроенные элементы (т.е. если вы получили свой класс документов от [COleLinkingDoc).](../../mfc/reference/colelinkingdoc-class.md) Эта функция вызывается во время активации на месте или когда элемент OLE является источником ссылки и пользователь хочет отсеить его. Реализация по умолчанию активирует первое представление на контейнерном документе. Переопределить эту функцию, чтобы прокрутить документ так, чтобы элемент OLE был виден.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>ColeClientitem::OnUpdateFrameTitle

Вызывается фреймворком во время активации на месте для обновления заглавной панели окна кадра.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если эта функция успешно обновила название кадра, в противном случае ноль.

### <a name="remarks"></a>Примечания

Реализация по умолчанию не изменяет название окна кадра. Переопределить эту функцию, если вы хотите другое название кадра для вашего приложения, например "*сервер номенклатура* *приложения* - в *docname"*(как в "Microsoft Excel - электронная таблица в REPORT. DOC"). Это передовой overridable.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>ColeClientitem::Reactivateandundo

Вызовите эту функцию, чтобы активировать элемент OLE и отменить последнюю операцию, выполненную пользователем во время редактирования на месте.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если приложение контейнера поддерживает команду отменить, позвоните по этой функции, если пользователь выберет команду отменить сразу после деактивации элемента OLE.

Если серверное приложение записано с библиотеками класса Microsoft Foundation, эта функция заставляет сервер вызывать [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Для получения дополнительной информации [см. IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) в Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>ColeClientItem::Release

Вызовите эту функцию для очистки ресурсов, используемых элементом OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Параметры

*dwCloseOption*<br/>
Пометить, при каких обстоятельствах элемент OLE сохраняется при возвращении в загруженное состояние. Список возможных значений можно [узнать: COleClientItem::Закрыть](#close).

### <a name="remarks"></a>Примечания

`Release`называется `COleClientItem` деструктором.

Для получения дополнительной информации [см. IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) в Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>ColeClientitem::Перезагрузка

Закрывает и перезагружает элемент.

```
BOOL Reload();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызов `Reload` функции после активации элемента как элемент другого типа по вызову [ActivateAs.](#activateas)

## <a name="coleclientitemrun"></a><a name="run"></a>ColeClientItem::Run

Запускает приложение, связанное с этим элементом.

```cpp
void Run();
```

### <a name="remarks"></a>Примечания

Позвоните `Run` функции участника для запуска серверного приложения, прежде чем активировать элемент. Это делается автоматически [активировать](#activate) и [DoVerb](#doverb), так что, как правило, не нужно называть эту функцию. Вызовите эту функцию, если необходимо запустить сервер для установки атрибута элемента, такого как [SetExtent,](#setextent)перед выполнением [DoVerb.](#doverb)

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>ColeClientItem::SetDrawAspect

Вызов `SetDrawAspect` функции участника, чтобы установить "аспект" или представление элемента.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Параметры

*nDrawAspect*<br/>
Значение из перечисления DVASPECT. Этот параметр может принимать одно из следующих значений:

- DVASPECT_CONTENT Элемент представлен таким образом, что он может отображаться как встроенный объект внутри контейнера.

- DVASPECT_THUMBNAIL Элемент отображается в представлении "thumbnail", чтобы его можно было отображать в инструменте просмотра.

- DVASPECT_ICON Элемент представлен иконой.

- DVASPECT_DOCPRINT Элемент представлен так, как если бы он был напечатан с помощью команды Print из меню файла.

### <a name="remarks"></a>Примечания

Аспект определяет, как элемент должен быть отрисован [Draw](#draw) при использовании значения значения по умолчанию для аргумента *nDrawAspect* этой функции.

Эта функция автоматически вызывается иконой изменения (и другими диалогами, которые называют диалог значка изменения напрямую), чтобы включить знаковый аспект отображения по запросу пользователя.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>ColeClientItem::SetExtent

Позвоните в эту функцию, чтобы указать, сколько места доступно для элемента OLE.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Объект [CSize,](../../atl-mfc-shared/reference/csize-class.md) содержащий информацию о размере.

*nDrawAspect*<br/>
Определяет аспект элемента OLE, границы которого должны быть установлены. Для возможных значений [см.](#setdrawaspect)

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки класса Microsoft `COleServerItem` Foundation, это приводит к вызову функции участника [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) соответствующего объекта. Элемент OLE может соответствующим образом настроить дисплей. Размеры должны быть в MM_HIMETRIC единицах. Вызовите эту функцию, когда пользователь изменяет размер элемента OLE или если вы поддерживаете некоторую форму переговоров о макете.

Для получения дополнительной информации [см. IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) в Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>ColeClientItem::SetHostNames

Позвоните в эту функцию, чтобы указать название контейнерного приложения и название контейнера для встроенного элемента OLE.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Параметры

*lpszHost*<br/>
Указатель на видимое пользователем имя контейнерного приложения.

*lpszHostObj*<br/>
Указатель на идентифицирующую строку контейнера, содержащего элемент OLE.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки класса Microsoft `COleServerDoc` Foundation, эта функция вызывает функцию члена [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) документа, содержащего элемент OLE. Эта информация используется в заголовках окон при редактировании элемента OLE. Каждый раз, когда контейнерный документ загружается, фреймворк вызывает эту функцию для всех элементов OLE в документе. `SetHostNames`применимо только к встроенным элементам. Нет необходимости вызывать эту функцию каждый раз, когда встроенный элемент OLE активируется для редактирования.

Это также вызывается автоматически с именем приложения и именем документа при загрузке объекта или когда файл сохраняется под другим именем. Соответственно, обычно не нужно вызывать эту функцию напрямую.

Для получения дополнительной информации [см. IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) в Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>ColeClientItem::SetIconicMetafile

Кэширует метафайл, используемый для рисования значка элемента.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Параметры

*hMetaPict*<br/>
Ручка к метафайлу, используемая для рисования значка элемента.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Используйте [GetIconicMetafile](#geticonicmetafile) для получения метафайла.

Параметр *hMetaPict* скопирован в элемент; поэтому *hMetaPict* должен быть освобожден абонентом.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>ColeClientItem::SetItemRects

Вызовите эту функцию, чтобы установить прямоугольник или видимый прямоугольник элемента OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*lprcPosRect*<br/>
Указатель на прямоугольник, содержащий границы элемента OLE относительно родительского окна, в координатах клиента.

*lprcClipRect*<br/>
Указатель на прямоугольник, содержащий границы видимой части элемента OLE относительно родительского окна, в координатах клиента.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Примечания

Эта функция вызывается по умолчанию реализации функции участника [OnChangeItemPosition.](#onchangeitemposition) Эту функцию следует вызывать при изменении положения или видимой части элемента OLE. Обычно это означает, что вы называете его из функций участников [OnSize](../../mfc/reference/cwnd-class.md#onsize) и [OnScrollBy.](../../mfc/reference/cview-class.md#onscrollby)

Для получения дополнительной информации [см. IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) в Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>ColeClientItem::SetLinkUpdateOptions

Вызовите эту функцию, чтобы установить опцию обновления ссылок для представления указанного связанного элемента.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Параметры

*dwUpdateOpt*<br/>
Значение опции обновления ссылок для этого элемента. Это значение должно быть одним из следующих:

- OLEUPDATE_ALWAYS обновлять связанный элемент, когда это возможно. Эта опция поддерживает кнопку автоматического обновления ссылки в диалоговом поле Ссылки.

- OLEUPDATE_ONCALL обновить связанный элемент только по запросу контейнерного приложения (когда вызывается функция участника [UpdateLink).](#updatelink) Эта опция поддерживает кнопку передачи ссылки Ручного обновления в диалоговом поле Ссылки.

### <a name="remarks"></a>Примечания

Как правило, не следует изменять параметры обновления, выбранные пользователем в диалоговом поле Ссылки.

Для получения дополнительной информации [см. IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) в Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>ColeClientItem::SetPrintDevice

Вызовите эту функцию, чтобы изменить устройство для целевой печати для этого элемента.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указатель на структуру данных [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) которая содержит информацию о новом устройстве для печати. Может иметь значение NULL.

*Ppd*<br/>
Указатель на структуру данных [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) содержащую информацию о новом устройстве с печатной целью. Может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если функция была успешной; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция обновляет устройство, предназначенное для печати, но не обновляет кэш презентации. Чтобы обновить кэш презентации для элемента, позвоните [UpdateLink](#updatelink).

Аргументы к этой функции содержат информацию, которую система OLE использует для идентификации целевого устройства. Структура `PRINTDLG` содержит информацию, которую Windows использует для инициализации общего диалогового окна печати. После того, как пользователь закрывает диалоговую будку, Windows возвращает информацию о выборе пользователя в этой структуре. Членом `m_pd` объекта [CPrintDialog](../../mfc/reference/cprintdialog-class.md) является `PRINTDLG` структура.

Более подробную информацию об этой структуре можно узнать в SDK с [windows.](/windows/win32/api/commdlg/ns-commdlg-printdlga)

Для получения дополнительной [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) информации см.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>ColeClientItem::UpdateLink

Немедленно позвоните в эту функцию, чтобы обновить данные презентации элемента OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.

### <a name="remarks"></a>Примечания

Для связанных элементов функция находит источник ссылки для получения новой презентации для элемента OLE. Этот процесс может включать в себя запуск одного или нескольких серверных приложений, что может занять много времени. Для встроенных элементов функция работает рекурсивно, проверяя, содержит ли встроенный элемент ссылки, которые могут быть устаревшими, и обновляет их. Пользователь также может вручную обновлять отдельные ссылки с помощью диалогового окна Ссылки.

Для получения дополнительной информации [см. IOleLink::Обновление](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) в Windows SDK.

## <a name="see-also"></a>См. также раздел

[MFC Образец MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC Образец OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[Класс CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс ColeServerItem](../../mfc/reference/coleserveritem-class.md)
