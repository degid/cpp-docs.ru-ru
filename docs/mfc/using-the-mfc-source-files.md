---
title: Использование файлов с исходным кодом MFC
ms.date: 08/19/2019
helpviewer_keywords:
- public members
- source files
- MFC, source files
- MFC source files
- comments, MFC
- private member access
- protected member access
- source files, MFC
ms.assetid: 3230e8fb-3b69-4ddf-9538-365ac7ea5e72
ms.openlocfilehash: acd702f5a032f9dca3480d287142583070701e84
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87231758"
---
# <a name="using-the-mfc-source-files"></a>Использование файлов с исходным кодом MFC

Библиотека Microsoft Foundation Class (MFC) предоставляет полный исходный код. Файлы заголовков (.h) находятся в каталоге *\атлмфк\инклуде* . Файлы реализации (. cpp) находятся в каталоге *\атлмфк\срк\мфк* .

В этой статье объясняются соглашения, которые MFC использует для комментирования различных частей каждого класса, их значения и то, что следует искать в каждом разделе. В мастерах Visual Studio используются аналогичные соглашения для создаваемых им классов, и, возможно, эти соглашения будут полезны для вашего собственного кода.

Возможно, вы знакомы с **`public`** **`protected`** **`private`** ключевыми словами, и C++. В файлах заголовков MFC вы обнаружите, что каждый класс может иметь несколько из них. Например, переменные и функции общего члена могут иметь более одного **`public`** ключевого слова. Это обусловлено тем, что MFC разделяет переменные и функции-члены на основе их использования, а не разрешенного типа доступа. MFC использует **`private`** экономно. Даже элементы, рассматриваемые в сведениях о реализации **`protected`** , часто и многие раз являются **`public`** . Хотя доступ к деталям реализации не рекомендуется, MFC оставляет решение вам.

В исходных файлах MFC и файлах заголовков, создаваемых мастером приложений MFC, можно найти такие комментарии в объявлениях классов (обычно в таком порядке):

`// Constructors`

`// Attributes`

`// Operations`

`// Overridables`

`// Implementation`

## <a name="an-example-of-the-comments"></a><a name="an-example-of-the-comments"></a>Пример комментариев

В следующем частичном списке класса `CStdioFile` используются большинство стандартных комментариев, которые MFC использует в своих классах для разделения членов класса по способам их использования:

```cpp
/*============================================================================*/
// STDIO file implementation

class CStdioFile : public CFile
{
    DECLARE_DYNAMIC(CStdioFile)

public:
// Constructors
    CStdioFile();

    // . . .

// Attributes
    FILE* m_pStream;    // stdio FILE
                        // m_hFile from base class is _fileno(m_pStream)

// Operations
    // reading and writing strings
    virtual void WriteString(LPCTSTR lpsz);
    virtual LPTSTR ReadString(_Out_writes_z_(nMax) LPTSTR lpsz, _In_ UINT nMax);
    virtual BOOL ReadString(CString& rString);

// Implementation
public:
    virtual ~CStdioFile();
#ifdef _DEBUG
    void Dump(CDumpContext& dc) const;
#endif
    virtual ULONGLONG GetPosition() const;
    virtual ULONGLONG GetLength() const;
    virtual BOOL Open(LPCTSTR lpszFileName, UINT nOpenFlags, CFileException* pError = NULL);

    // . . .

protected:
    void CommonBaseInit(FILE* pOpenStream, CAtlTransactionManager* pTM);
    void CommonInit(LPCTSTR lpszFileName, UINT nOpenFlags, CAtlTransactionManager* pTM);
};
```

Эти комментарии последовательно отмечают разделы объявления класса, содержащие похожие типы членов класса. Помните, что они являются соглашениями MFC, но не устанавливают правила.

## <a name="-constructors-comment"></a>Комментарий к конструкторам

В `// Constructors` разделе объявления класса MFC объявляются конструкторы (в смысле C++) и функции инициализации, необходимые для фактического использования объекта. Например, `CWnd::Create` в разделе конструкторы, поскольку перед использованием `CWnd` объекта он должен быть полностью сконструированным, сначала вызывается конструктор C++, а затем вызывается `Create` функция. Как правило, эти члены являются открытыми.

Например, класс `CStdioFile` имеет пять конструкторов, один из которых показан в списке под [примером комментариев](#an-example-of-the-comments).

## <a name="-attributes-comment"></a>Комментарий к атрибутам

`// Attributes`Раздел объявления класса MFC содержит открытые атрибуты (или свойства) объекта. Обычно атрибуты являются переменными-членами или функциями get/set. Функции Get и Set могут быть виртуальными. Функции Get часто бывают **`const`** , потому что в большинстве случаев они не имеют побочных эффектов. Обычно эти члены являются общедоступными. Защищенные и закрытые атрибуты обычно находятся в разделе Реализация.

В примере листинга из класса в качестве `CStdioFile` [примера комментариев](#an-example-of-the-comments)список содержит одну переменную члена *m_pStream*. `CDC`В этом комментарии класс содержит около 20 элементов.

> [!NOTE]
> Большие классы, такие как `CDC` и `CWnd` , могут иметь настолько много членов, что просто перечисление всех атрибутов в одной группе не повлияет на ясность. В таких случаях библиотека классов использует другие комментарии в качестве заголовков для дальнейшего отделения членов. Например, `CDC` использует `// Device-Context Functions` , `// Drawing Tool Functions` , `// Drawing Attribute Functions` и многое другое. Группы, представляющие атрибуты, будут соответствовать обычному синтаксису, описанному выше. Многие классы OLE имеют раздел реализации `// Interface Maps` .

## <a name="-operations-comment"></a>Комментарий к операциям

`// Operations`Раздел объявления класса MFC содержит функции-члены, которые можно вызывать для объекта, чтобы сделать его ненужным или предпринять действия (выполнить операции). Обычно эти функции не используются, **`const`** так как они обычно имеют побочные эффекты. Они могут быть виртуальными или невиртуальными в зависимости от потребностей класса. Как правило, эти члены являются открытыми.

В примере листинга из класса `CStdioFile` в качестве [примера комментариев](#an-example-of-the-comments)список содержит три функции элементов в этом комментарии: `WriteString` и две перегрузки `ReadString` .

Как и в случае с атрибутами, операции можно разделить на другие.

## <a name="-overridables-comment"></a>Оверридаблес комментарий

`// Overridables`Раздел объявления класса MFC содержит виртуальные функции, которые можно переопределить в производном классе, если необходимо изменить поведение базового класса. Обычно имена начинаются с «on», хотя это не является обязательным. Функции здесь предназначены для переопределения и часто реализуют или предоставляют некоторый вид "обратного вызова" или "обработчик". Как правило, эти элементы защищены.

В самой MFC чистые виртуальные функции всегда помещаются в этот раздел. Чистая виртуальная функция в C++ имеет вид:

`virtual void OnDraw( ) = 0;`

В примере листинга из класса `CStdioFile` в качестве [примера комментариев](#an-example-of-the-comments)список не включает раздел оверридаблес. Класс `CDocument` , с другой стороны, содержит примерно 10 переопределяемых функций элементов.

В некоторых классах также может отображаться комментарий `// Advanced Overridables` . Это те функции, которые только опытным программистам следует попытаться переопределить. Возможно, вам не придется переопределять их.

> [!NOTE]
> Соглашения, описанные в этой статье, также хорошо подходят для автоматизации (ранее известные как методы автоматизации OLE) и в целом. Методы автоматизации похожи на операции MFC. Свойства автоматизации похожи на атрибуты MFC. События автоматизации (поддерживаемые для элементов управления ActiveX, ранее известные как элементы управления OLE) похожи на функции-члены, допускающие переопределяемые классы MFC.

## <a name="-implementation-comment"></a>Комментарий к реализации

`// Implementation`Раздел является наиболее важной частью любого объявления класса MFC.

В этом разделе содержатся сведения о реализации. В этом разделе могут присутствовать как переменные члена, так и функции элементов. Все, что ниже этой строки, может измениться в будущих выпусках MFC. Если вы не можете избежать этого, не следует полагаться на подробные сведения под `// Implementation` строкой. Кроме того, члены, объявленные под строкой реализации, не документированы, хотя некоторые реализации обсуждаются в технических примечаниях. Переопределения виртуальных функций в базовом классе находятся в этом разделе независимо от того, в каком разделе определена функция базового класса. Когда функция переопределяет реализацию базового класса, она считается подробным описанием реализации. Как правило, эти члены защищены, но не всегда.

В списке `CStdioFile` под [примером комментариев](#an-example-of-the-comments)члены, объявленные под `// Implementation` комментарием, могут быть объявлены как **`public`** , **`protected`** или **`private`** . Используйте эти члены только с осторожностью, так как они могут измениться в будущем. Объявление группы членов как **`public`** может потребоваться для правильной работы реализации библиотеки классов. Однако это не означает, что вы можете безопасно использовать члены так, чтобы они были объявлены.

> [!NOTE]
> Вы можете найти комментарии для остальных типов, расположенных выше или под `// Implementation` комментарием. В любом случае они описывают типы членов, объявленных под ними. Если они встречаются под `// Implementation` комментарием, следует предположить, что элементы в будущих версиях MFC могут измениться.

## <a name="see-also"></a>См. также раздел

[Общие разделы по MFC](../mfc/general-mfc-topics.md)
