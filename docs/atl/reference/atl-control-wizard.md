---
title: Мастер элементов управления ATL
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.control.overview
helpviewer_keywords:
- ATL projects, adding controls
- controls [ATL], adding to projects
- ATL Control Wizard
ms.assetid: 991f8e72-ffbc-4382-a4ce-e255acfba5b6
ms.openlocfilehash: a10c5c358901122dda37b395c1f0fa5cdc30ce30
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81321701"
---
# <a name="atl-control-wizard"></a>Мастер элементов управления ATL

Вставляет в проект ATL (или проект MFC при поддержке ATL) контроль ATL. Этот мастер можно использовать для вставки одного из трех видов элементов управления:

- Стандартный контроль

- Композитный контроль

- Контроль DHTML

Кроме того, можно указать минимальный элемент управления, удалив интерфейсы из списка [интерфейсов,](../../atl/reference/interfaces-atl-control-wizard.md) которые предоставляются в качестве по умолчанию для элементов управления, чтобы открыть в большинстве контейнеров. Вы можете настроить нужные интерфейсы для управления на странице **интерфейсов** мастера.

## <a name="remarks"></a>Примечания

Скрипт регистрации, созданный этим мастером, будет регистрировать свои компоненты COM под HKEY_CURRENT_USER вместо HKEY_LOCAL_MACHINE. Чтобы изменить это, задайте в мастере ATL параметр **Register component for all users** (Регистрация компонентов для всех пользователей).

## <a name="names"></a>именах

Укажите имена объекта, интерфейса и классов, которые необходимо добавить в проект. За исключением **короткого имени,** все остальные коробки могут быть изменены самостоятельно. Если вы меняете текст для **короткого имени**, то это отображается в именах остальных полей на странице. При изменении имени **Coclass** в разделе COM изменение отражается в поле **Типа,** но имя **интерфейса** и **ProgID** не изменяются. Этот принцип именования позволяет вам легко распознавать имена при разработке элементов управления.

> [!NOTE]
> **Coclass** можно отослать только на несвязанных элементах управления. Если проект содержит атрибуты, **Coclass** изменить невозможно.

### <a name="c"></a>C++

Предоставляет информацию для класса C++, созданного для реализации объекта.

- **Краткое название**

   Задает сокращенное имя для объекта. Имя, которое вы предоставляете, определяет имена класса и **кокласса,** файл (. CPP и . H) имена, имя интерфейса и имена **типов,** если вы не измените эти поля по отдельности.

- **Class**

   Задает имя класса, реализующего объект. Это имя основано на имени, указанном в поле **Короткое имя**, с предшествующей "С" — типичным префиксом для имени класса.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. При выборе существующего файла мастер не сохранит его в выбранном месте до тех пор, пока вы не нажмете **Finish.**

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Attributed**

   Указывает, использует ли объект атрибуты. Если вы добавляете объект в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть вы можете добавить только помеченные атрибутами объекты в проект, созданный с поддержкой атрибутов.

   Объект с атрибутами можно добавить только в проект ATL с поддержкой атрибутов. Если выбрать этот параметр для проекта ATL без поддержки атрибутов, мастер предложит указать, нужно ли добавить поддержку атрибутов в проект.

   По умолчанию объекты, которые добавляются после установки этого параметра, определяются как атрибуты (флажок установлен). Вы можете снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   Дополнительные сведения см. в статьях [Application Settings, ATL Project Wizard](../../atl/reference/application-settings-atl-project-wizard.md) (Параметры приложений, мастер проектов ATL) и [C++ Attributes for COM and .NET](../../windows/basic-mechanics-of-attributes.md) (Атрибуты C++ для COM и .NET).

### <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях модели COM для объекта.

- **Coclass**

   Задает имя класса компонентов, содержащего список интерфейсов, поддерживаемых объектом.

   > [!NOTE]
   > Если проект создается с помощью атрибутов или если на странице мастера указывается, что элементы управления используются, вы не можете изменить эту опцию, поскольку ATL не включает атрибут **coclass.**

- **Интерфейс**

   Устанавливает название интерфейса для объекта. По умолчанию имя интерфейса подготавн с "I".

- **Type**

   Задает описание объекта, которое отобразится в реестре.

- **Progid**

   Задает имя, которое можно использовать для контейнеров вместо CLSID объекта. Это поле не заселены автоматически. Если вы не заселяете это поле вручную, элемент управления может быть недоступен для других инструментов. Например, элементы управления ActiveX, которые генерируются без `ProgID` элемента, недоступны в диалоговом окне Управления **вставкой ActiveX.** Для получения дополнительной информации о диалоговом поле [см.](../../windows/insert-activex-control-dialog-box.md)

## <a name="see-also"></a>См. также раздел

[Элемент управления ATL](../../atl/reference/adding-an-atl-control.md)<br/>
[Добавление функциональности в элементный контроль](../../atl/adding-functionality-to-the-composite-control.md)<br/>
[Основы объектов ATL COM](../../atl/fundamentals-of-atl-com-objects.md)
