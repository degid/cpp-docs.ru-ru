---
title: Глобальные функции составного элемента управления
ms.date: 11/04/2016
f1_keywords:
- atlhost/ATL::AtlAxDialogBox
- atlhost/ATL::AtlAxCreateDialog
- atlhost/ATL::AtlAxCreateControl
- atlhost/ATL::AtlAxCreateControlEx
- atlhost/ATL::AtlAxCreateControlLic
- atlhost/ATL::AtlAxCreateControlLicEx
- atlhost/ATL::AtlAxAttachControl
- atlhost/ATL::AtlAxGetHost
- atlhost/ATL::AtlAxGetControl
- atlhost/ATL::AtlSetChildSite
- atlhost/ATL::AtlAxWinInit
- atlhost/ATL::AtlAxWinTerm
- atlhost/ATL::AtlGetObjectSourceInterface
helpviewer_keywords:
- composite controls, global functions
ms.assetid: 536884cd-e863-4c7a-ab0a-604dc60a0bbe
ms.openlocfilehash: 467925baf59598d743650d4f98d210f789f2b179
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88833560"
---
# <a name="composite-control-global-functions"></a>Глобальные функции составного элемента управления

Эти функции обеспечивают поддержку создания диалоговых окон, а для создания, размещения и лицензирования элементов управления ActiveX.

> [!IMPORTANT]
> Функции, перечисленные в следующей таблице, нельзя использовать в приложениях, выполняемых в среда выполнения Windows.

|Функция|Описание|
|-|-|
|[AtlAxDialogBox](#atlaxdialogbox)|Создает модальное диалоговое окно на основе шаблона диалогового окна, предоставленного пользователем. Полученное диалоговое окно может содержать элементы управления ActiveX.|
|[AtlAxCreateDialog](#atlaxcreatedialog)|Создает немодальное диалоговое окно на основе шаблона диалогового окна, предоставленного пользователем. Полученное диалоговое окно может содержать элементы управления ActiveX.|
|[AtlAxCreateControl](#atlaxcreatecontrol)|Создает элемент управления ActiveX, инициализирует его и размещает в указанном окне.|
|[AtlAxCreateControlEx](#atlaxcreatecontrolex)|Создает элемент управления ActiveX, инициализирует его, размещает его в указанном окне и получает указатель интерфейса (или указатели) из элемента управления.|
|[AtlAxCreateControlLic](#atlaxcreatecontrollic)|Создает лицензированный элемент управления ActiveX, инициализирует его и размещает в указанном окне.|
|[AtlAxCreateControlLicEx](#atlaxcreatecontrollicex)|Создает лицензированный элемент управления ActiveX, инициализирует его, размещает его в указанном окне и получает указатель интерфейса (или указатели) из элемента управления.|
|[AtlAxAttachControl](#atlaxattachcontrol)|Присоединяет ранее созданный элемент управления к указанному окну.|
|[AtlAxGetHost](#atlaxgethost)|Используется для получения прямого указателя интерфейса на контейнер для указанного окна (если таковой имеется) с учетом его обработчика.|
|[AtlAxGetControl](#atlaxgetcontrol)|Используется для получения прямого указателя интерфейса на элемент управления, содержащийся в заданном окне (если таковой имеется), по его маркеру.|
|[AtlSetChildSite](#atlsetchildsite)|Инициализирует объект `IUnknown` дочернего сайта.|
|[AtlAxWinInit](#atlaxwininit)|Инициализирует код размещения для объектов Аксвин.|
|[AtlAxWinTerm](#atlaxwinterm)|Отменяет инициализацию кода размещения для объектов Аксвин.|
|[AtlGetObjectSourceInterface](#atlgetobjectsourceinterface)|Возвращает сведения о исходном интерфейсе по умолчанию для объекта.|

## <a name="requirements"></a>Требования

**Заголовок:** атлхост.h

## <a name="atlaxdialogbox"></a><a name="atlaxdialogbox"></a> атлаксдиалогбокс

Создает модальное диалоговое окно на основе шаблона диалогового окна, предоставленного пользователем.

```
ATLAPI_(int) AtlAxDialogBox(
    HINSTANCE hInstance,
    LPCWSTR lpTemplateName,
    HWND hWndParent,
    DLGPROC lpDialogProc,
    LPARAM dwInitParam);
```

### <a name="parameters"></a>Параметры

*hInstance*<br/>
окне Определяет экземпляр модуля, исполняемый файл которого содержит шаблон диалогового окна.

*лптемплатенаме*<br/>
окне Указывает шаблон диалогового окна. Этот параметр является либо указателем на строку символов, завершающейся нулем, которая указывает имя шаблона диалогового окна, либо целочисленное значение, указывающее идентификатор ресурса шаблона диалогового окна. Если параметр указывает идентификатор ресурса, его слово в высоком порядке должно быть равно нулю, а его младшее слово должно содержать идентификатор. Это значение можно создать с помощью макроса [макеинтресаурце](/windows/win32/api/winuser/nf-winuser-makeintresourcew) .

*хвндпарент*<br/>
окне Определяет окно, которому принадлежит диалоговое окно.

*лпдиалогпрок*<br/>
окне Указывает на процедуру диалогового окна. Дополнительные сведения о процедуре диалогового окна см. в разделе [DialogProc](/windows/win32/api/winuser/nc-winuser-dlgproc).

*двинитпарам*<br/>
окне Указывает значение, передаваемое в диалоговое окно в параметре *lParam* сообщения WM_INITDIALOG.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

Для использования `AtlAxDialogBox` с шаблоном диалогового окна, который содержит элемент управления ActiveX, укажите допустимый идентификатор CLSID, AppID или строку URL-адреса в качестве *текстового* поля раздела **управления** ресурса диалогового окна, а также "AtlAxWin80" в качестве поля *имени класса* в том же разделе. Ниже показано, как может выглядеть допустимый раздел **управления** .

```
CONTROL    "{04FE35E9-ADBC-4f1d-83FE-8FA4D1F71C7F}", IDC_TEST,
    "AtlAxWin80", WS_GROUP | WS_TABSTOP, 0, 0, 100, 100
```

Дополнительные сведения об изменении сценариев ресурсов см. в разделе [как открыть файл скрипта ресурсов в текстовом формате](../../windows/how-to-open-a-resource-script-file-in-text-format.md). Дополнительные сведения об управлении инструкциями определения ресурсов см. в разделе [Общие параметры управления](/windows/win32/menurc/common-control-parameters) в разделе Windows SDK: SDK Tools.

Дополнительные сведения о диалоговых окнах см. в разделе [диалогбокс](/windows/win32/api/winuser/nf-winuser-dialogboxw) and [креатедиалогпарам](/windows/win32/api/winuser/nf-winuser-createdialogparamw) в Windows SDK.

## <a name="atlaxcreatedialog"></a><a name="atlaxcreatedialog"></a> атлакскреатедиалог

Создает немодальное диалоговое окно на основе шаблона диалогового окна, предоставленного пользователем.

```
ATLAPI_(HWND) AtlAxCreateDialog(
    HINSTANCE hInstance,
    LPCWSTR lpTemplateName,
    HWND hWndParent,
    DLGPROC lpDialogProc,
    LPARAM dwInitParam);
```

### <a name="parameters"></a>Параметры

*hInstance*<br/>
окне Определяет экземпляр модуля, исполняемый файл которого содержит шаблон диалогового окна.

*лптемплатенаме*<br/>
окне Указывает шаблон диалогового окна. Этот параметр является либо указателем на строку символов, завершающейся нулем, которая указывает имя шаблона диалогового окна, либо целочисленное значение, указывающее идентификатор ресурса шаблона диалогового окна. Если параметр указывает идентификатор ресурса, его слово в высоком порядке должно быть равно нулю, а его младшее слово должно содержать идентификатор. Это значение можно создать с помощью макроса [макеинтресаурце](/windows/win32/api/winuser/nf-winuser-makeintresourcew) .

*хвндпарент*<br/>
окне Определяет окно, которому принадлежит диалоговое окно.

*лпдиалогпрок*<br/>
окне Указывает на процедуру диалогового окна. Дополнительные сведения о процедуре диалогового окна см. в разделе [DialogProc](/windows/win32/api/winuser/nc-winuser-dlgproc).

*двинитпарам*<br/>
окне Указывает значение, передаваемое в диалоговое окно в параметре *lParam* сообщения WM_INITDIALOG.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

Полученное диалоговое окно может содержать элементы управления ActiveX.

См. раздел [креатедиалог](/windows/win32/api/winuser/nf-winuser-createdialogw) and [креатедиалогпарам](/windows/win32/api/winuser/nf-winuser-createdialogparamw) в Windows SDK.

## <a name="atlaxcreatecontrol"></a><a name="atlaxcreatecontrol"></a> атлакскреатеконтрол

Создает элемент управления ActiveX, инициализирует его и размещает в указанном окне.

```
ATLAPI AtlAxCreateControl(
    LPCOLESTR lpszName,
    HWND hWnd,
    IStream* pStream,
    IUnknown** ppUnkContainer);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, которая должна быть передана в элемент управления. Должен быть отформатирован одним из следующих способов:

- Идентификатор ProgID, например `"MSCAL.Calendar.7"`

- CLSID, например `"{8E27C92B-1264-101C-8A2F-040224009C02}"`

- URL-адрес, например `"<https://www.microsoft.com>"`

- Ссылка на активный документ, например `"file://\\\Documents\MyDoc.doc"`

- Фрагмент HTML-кода, например `"MSHTML:\<HTML>\<BODY>This is a line of text\</BODY>\</HTML>"`

   > [!NOTE]
   > `"MSHTML:"` должен предшествовать фрагменту HTML, чтобы он был обозначен как поток MSHTML.

*hWnd*<br/>
окне Обработчик для окна, к которому будет присоединен элемент управления.

*пстреам*<br/>
окне Указатель на поток, используемый для инициализации свойств элемента управления. Может иметь значение NULL.

*ппункконтаинер*<br/>
заполняет Адрес указателя, который получит `IUnknown` контейнер. Может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

Эта глобальная функция дает тот же результат, что и вызов [атлакскреатеконтролекс](#atlaxcreatecontrolex)(*лпсзнаме*, *HWND*, *пстреам*, null, null, null, null);.

Сведения о создании лицензированного элемента управления ActiveX см. в разделе [атлакскреатеконтроллик](#atlaxcreatecontrollic).

## <a name="atlaxcreatecontrolex"></a><a name="atlaxcreatecontrolex"></a> атлакскреатеконтролекс

Создает элемент управления ActiveX, инициализирует его и размещает в указанном окне. Можно также создать указатель интерфейса и приемник событий для нового элемента управления.

```
ATLAPI AtlAxCreateControlEx(
    LPCOLESTR lpszName,
    HWND hWnd,
    IStream* pStream,
    IUnknown** ppUnkContainer,
    IUnknown** ppUnkControl,
    REFIID iidSink = IID_NULL,
    IUnknown* punkSink = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, которая должна быть передана в элемент управления. Должен быть отформатирован одним из следующих способов:

- Идентификатор ProgID, например `"MSCAL.Calendar.7"`

- CLSID, например `"{8E27C92B-1264-101C-8A2F-040224009C02}"`

- URL-адрес, например `"<https://www.microsoft.com>"`

- Ссылка на активный документ, например `"file://\\\Documents\MyDoc.doc"`

- Фрагмент HTML-кода, например `"MSHTML:\<HTML>\<BODY>This is a line of text\</BODY>\</HTML>"`

   > [!NOTE]
   > `"MSHTML:"` должен предшествовать фрагменту HTML, чтобы он был обозначен как поток MSHTML.

*hWnd*<br/>
окне Обработчик для окна, к которому будет присоединен элемент управления.

*пстреам*<br/>
окне Указатель на поток, используемый для инициализации свойств элемента управления. Может иметь значение NULL.

*ппункконтаинер*<br/>
заполняет Адрес указателя, который получит `IUnknown` контейнер. Может иметь значение NULL.

*ппункконтрол*<br/>
заполняет Адрес указателя, который получит `IUnknown` созданный элемент управления. Может иметь значение NULL.

*иидсинк*<br/>
Идентификатор интерфейса для исходящего интерфейса в автономном объекте.

*пунксинк*<br/>
Указатель на `IUnknown` интерфейс объекта приемника, который должен быть подключен к точке подключения, заданной параметром *иидсинк* , в содержащемся объекте после успешного создания автономного объекта.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

`AtlAxCreateControlEx` аналогичен [атлакскреатеконтрол](#atlaxcreatecontrol) , но также позволяет получить указатель интерфейса на вновь созданный элемент управления и настроить приемник событий для получения событий, инициированных элементом управления.

Сведения о создании лицензированного элемента управления ActiveX см. в разделе [атлакскреатеконтроллицекс](#atlaxcreatecontrollicex).

## <a name="atlaxcreatecontrollic"></a><a name="atlaxcreatecontrollic"></a> атлакскреатеконтроллик

Создает лицензированный элемент управления ActiveX, инициализирует его и размещает в указанном окне.

```
ATLAPI AtlAxCreateControlLic(
    LPCOLESTR lpszName,
    HWND hWnd,
    IStream* pStream,
    IUnknown** ppUnkContainer,
    BSTR bstrLic = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, которая должна быть передана в элемент управления. Должен быть отформатирован одним из следующих способов:

- Идентификатор ProgID, например `"MSCAL.Calendar.7"`

- CLSID, например `"{8E27C92B-1264-101C-8A2F-040224009C02}"`

- URL-адрес, например `"<https://www.microsoft.com>"`

- Ссылка на активный документ, например `"file://\\\Documents\MyDoc.doc"`

- Фрагмент HTML-кода, например `"MSHTML:\<HTML>\<BODY>This is a line of text\</BODY>\</HTML>"`

   > [!NOTE]
   > `"MSHTML:"` должен предшествовать фрагменту HTML, чтобы он был обозначен как поток MSHTML.

*hWnd*<br/>
Обработчик для окна, к которому будет присоединен элемент управления.

*пстреам*<br/>
Указатель на поток, используемый для инициализации свойств элемента управления. Может иметь значение NULL.

*ппункконтаинер*<br/>
Адрес указателя, который получит `IUnknown` контейнер. Может иметь значение NULL.

*бстрлик*<br/>
Значение BSTR, содержащее лицензию для элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="example"></a>Пример

Пример использования см. в разделе [Размещение элементов управления ActiveX с помощью библиотеки ATL](../../atl/hosting-activex-controls-using-atl-axhost.md) `AtlAxCreateControlLic` .

## <a name="atlaxcreatecontrollicex"></a><a name="atlaxcreatecontrollicex"></a> атлакскреатеконтроллицекс

Создает лицензированный элемент управления ActiveX, инициализирует его и размещает в указанном окне. Можно также создать указатель интерфейса и приемник событий для нового элемента управления.

```
ATLAPI AtlAxCreateControlLicEx(
    LPCOLESTR lpszName,
    HWND hWnd,
    IStream* pStream,
    IUnknown** ppUnkContainer,
    IUnknown** ppUnkControl,
    REFIID iidSink = IID_NULL,
    IUnknown* punkSink = NULL,
    BSTR bstrLic = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, которая должна быть передана в элемент управления. Должен быть отформатирован одним из следующих способов:

- Идентификатор ProgID, например `"MSCAL.Calendar.7"`

- CLSID, например `"{8E27C92B-1264-101C-8A2F-040224009C02}"`

- URL-адрес, например `"<https://www.microsoft.com>"`

- Ссылка на активный документ, например `"file://\\\Documents\MyDoc.doc"`

- Фрагмент HTML-кода, например `"MSHTML:\<HTML>\<BODY>This is a line of text\</BODY>\</HTML>"`

   > [!NOTE]
   > `"MSHTML:"` должен предшествовать фрагменту HTML, чтобы он был обозначен как поток MSHTML.

*hWnd*<br/>
Обработчик для окна, к которому будет присоединен элемент управления.

*пстреам*<br/>
Указатель на поток, используемый для инициализации свойств элемента управления. Может иметь значение NULL.

*ппункконтаинер*<br/>
Адрес указателя, который получит `IUnknown` контейнер. Может иметь значение NULL.

*ппункконтрол*<br/>
заполняет Адрес указателя, который получит `IUnknown` созданный элемент управления. Может иметь значение NULL.

*иидсинк*<br/>
Идентификатор интерфейса для исходящего интерфейса в автономном объекте.

*пунксинк*<br/>
Указатель на `IUnknown` интерфейс объекта приемника, который должен быть подключен к точке подключения, заданной параметром *иидсинк* , в содержащемся объекте после успешного создания автономного объекта.

*бстрлик*<br/>
Значение BSTR, содержащее лицензию для элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

`AtlAxCreateControlLicEx` аналогичен [атлакскреатеконтроллик](#atlaxcreatecontrollic) , но также позволяет получить указатель интерфейса на вновь созданный элемент управления и настроить приемник событий для получения событий, инициированных элементом управления.

### <a name="example"></a>Пример

Пример использования см. в разделе [Размещение элементов управления ActiveX с помощью библиотеки ATL](../../atl/hosting-activex-controls-using-atl-axhost.md) `AtlAxCreateControlLicEx` .

## <a name="atlaxattachcontrol"></a><a name="atlaxattachcontrol"></a> атлаксаттачконтрол

Присоединяет ранее созданный элемент управления к указанному окну.

```
ATLAPI AtlAxAttachControl(
    IUnknown* pControl,
    HWND hWnd,
    IUnknown** ppUnkContainer);
```

### <a name="parameters"></a>Параметры

*pControl*<br/>
окне Указатель на `IUnknown` элемент управления.

*hWnd*<br/>
окне Обработчик для окна, в котором будет размещен элемент управления.

*ппункконтаинер*<br/>
заполняет Указатель на указатель на `IUnknown` объект контейнера.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

### <a name="remarks"></a>Примечания

Используйте [атлакскреатеконтролекс](#atlaxcreatecontrolex) и [атлакскреатеконтрол](#atlaxcreatecontrol) для одновременного создания и присоединения элемента управления.

> [!NOTE]
> Присоединяемый объект элемента управления должен быть правильно инициализирован перед вызовом `AtlAxAttachControl` .

## <a name="atlaxgethost"></a><a name="atlaxgethost"></a> атлаксжесост

Получает прямой указатель интерфейса на контейнер для указанного окна (если имеется) по его указателю.

```
ATLAPI AtlAxGetHost(HWND h, IUnknown** pp);
```

### <a name="parameters"></a>Параметры

*h*<br/>
окне Маркер окна, в котором размещается элемент управления.

*PP*<br/>
заполняет Объект `IUnknown` контейнера элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

## <a name="atlaxgetcontrol"></a><a name="atlaxgetcontrol"></a> атлаксжетконтрол

Получает прямой указатель интерфейса на элемент управления, который содержится в заданном окне (на основе его указателя).

```
ATLAPI AtlAxGetControl(HWND h, IUnknown** pp);
```

### <a name="parameters"></a>Параметры

*h*<br/>
окне Маркер окна, в котором размещается элемент управления.

*PP*<br/>
заполняет Объект `IUnknown` размещаемого элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Одно из стандартных значений HRESULT.

## <a name="atlsetchildsite"></a><a name="atlsetchildsite"></a> атлсетчилдсите

Вызовите эту функцию, чтобы задать сайт дочернего объекта в `IUnknown` родительском объекте.

```
HRESULT AtlSetChildSite(IUnknown* punkChild, IUnknown* punkParent);
```

### <a name="parameters"></a>Параметры

*пункчилд*<br/>
окне Указатель на `IUnknown` интерфейс дочернего элемента.

*пункпарент*<br/>
окне Указатель на `IUnknown` интерфейс родителя.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

## <a name="atlaxwininit"></a><a name="atlaxwininit"></a> атлаксвининит

Эта функция инициализирует код размещения элемента управления ATL, регистрируя классы окон **"AtlAxWin80"** и **"AtlAxWinLic80"** и пару настраиваемых оконных сообщений.

```
ATLAPI_(BOOL) AtlAxWinInit();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если инициализация кода размещения элемента управления прошла успешно; в противном случае — FALSE.

### <a name="remarks"></a>Примечания

Эта функция должна вызываться перед использованием API размещения элемента управления ATL. После вызова этой функции класс окна **"атлаксвин"** можно использовать в вызовах [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) или [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw), как описано в Windows SDK.

## <a name="atlaxwinterm"></a><a name="atlaxwinterm"></a> атлаксвинтерм

Эта функция выполняет отмену инициализации кода размещения элемента управления ATL путем отмены регистрации классов окон **"AtlAxWin80"** и " **AtlAxWinLic80"** .

```
inline BOOL AtlAxWinTerm();
```

### <a name="return-value"></a>Возвращаемое значение

Всегда возвращает значение TRUE.

### <a name="remarks"></a>Примечания

Эта функция просто вызывает [унрегистеркласс](/windows/win32/api/winuser/nf-winuser-unregisterclassw) , как описано в Windows SDK.

Вызывайте эту функцию для очистки после уничтожения всех существующих окон размещения, если вы вызвали [атлаксвининит](#atlaxwininit) и вам больше не нужно создавать ведущие окна. Если не вызвать эту функцию, класс Window будет автоматически отменена при завершении процесса.

## <a name="atlgetobjectsourceinterface"></a><a name="atlgetobjectsourceinterface"></a> атлжетобжектсаурцеинтерфаце

Вызывайте эту функцию для получения сведений об интерфейсе источника по умолчанию для объекта.

```
ATLAPI AtlGetObjectSourceInterface(
    IUnknown* punkObj,
    GUID* plibid,
    IID* piid,
    unsigned short* pdwMajor,
    unsigned short* pdwMinor);
```

### <a name="parameters"></a>Параметры

*пункобж*<br/>
окне Указатель на объект, для которого возвращаются сведения.

*плибид*<br/>
заполняет Указатель на идентификатор LIBID библиотеки типов, содержащей определение исходного интерфейса.

*пиид*<br/>
заполняет Указатель на идентификатор интерфейса исходного интерфейса по умолчанию объекта.

*пдвмажор*<br/>
заполняет Указатель на основной номер версии библиотеки типов, содержащей определение исходного интерфейса.

*pdwMinor*<br/>
заполняет Указатель на дополнительный номер версии библиотеки типов, содержащей определение исходного интерфейса.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

### <a name="remarks"></a>Примечания

`AtlGetObjectSourceInterface` может предоставить вам идентификатор интерфейса для исходного интерфейса по умолчанию, а также LIBID и основной и дополнительный номера версии библиотеки типов, описывающей этот интерфейс.

> [!NOTE]
> Чтобы эта функция успешно получала запрошенную информацию, объект, представленный *пункобж* , должен реализовывать `IDispatch` (и возвращать сведения о типе через `IDispatch::GetTypeInfo` ), а также должен реализовывать либо `IProvideClassInfo2` `IPersist` . Сведения о типе для исходного интерфейса должны быть в той же библиотеке типов, что и сведения о типе `IDispatch` .

### <a name="example"></a>Пример

В приведенном ниже примере показано, как можно определить класс приемника событий, `CEasySink` который сокращает количество аргументов шаблона, которые можно передать в исходное основное приложение `IDispEventImpl` . `EasyAdvise` и `EasyUnadvise` используют `AtlGetObjectSourceInterface` для инициализации элементов [IDispEventImpl](../../atl/reference/idispeventimpl-class.md) перед вызовом [диспевентадвисе](idispeventsimpleimpl-class.md#dispeventadvise) или [диспевентунадвисе](idispeventsimpleimpl-class.md#dispeventunadvise).

[!code-cpp[NVC_ATL_Windowing#93](../../atl/codesnippet/cpp/composite-control-global-functions_1.h)]

## <a name="see-also"></a>См. также

[Функции](../../atl/reference/atl-functions.md)<br/>
[Макросы составного элемента управления](../../atl/reference/composite-control-macros.md)
