---
title: Предупреждение компилятора (уровень 4) C4471
ms.date: 04/24/2017
f1_keywords:
- C4471
helpviewer_keywords:
- C4471
ms.assetid: ccfd8bd5-bc1b-4be7-a6ea-0e3a7add6607
ms.openlocfilehash: 5b8c3ef419a4c6eaf9a674827cd5545a1f1b2bfe
ms.sourcegitcommit: c1fd917a8c06c6504f66f66315ff352d0c046700
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2020
ms.locfileid: "90685506"
---
# <a name="compiler-warning-level-4-c4471"></a>Предупреждение компилятора (уровень 4) C4471

"*перечисление*": в прямом объявлении неограниченного перечисления должен присутствовать базовый тип (предполагается int)

Найдено перенаправленное объявление неограниченного перечисления без описателя для базового типа. По умолчанию Visual C++ предполагает, что **`int`** это базовый тип перечисления. Это может вызвать проблемы, если в определении перечисления используется другой тип, например, если задан другой явный тип или если другой тип неявно задан инициализатором. У вас также могут быть проблемы переносимости. другие компиляторы не предполагают, что **`int`** это базовый тип перечисления.

Это предупреждение отключено по умолчанию. Вы можете использовать/Wall или/w*N*4471, чтобы включить его в командной строке, или использовать [предупреждение](../../preprocessor/warning.md) #pragma в исходном файле.

## <a name="examples"></a>Примеры

В некоторых случаях это предупреждение является ложным. Если после определения появляется упреждающее объявление перечисления, это предупреждение может сработать. Например, этот код допустим, даже если он может вызвать C4471:

```cpp
// C4471a.cpp
// Compile with: cl /c /w14471 C4471a.cpp
enum Example { item = 0x80000000UL };
enum Example;    // Spurious C4471
// ...
```

В общем случае можно использовать полное определение неограниченного перечисления вместо прямого объявления. Определение можно поместить в файл заголовка и включить его в исходные файлы, которые ссылаются на него. Это работает в коде, написанном для C++ 98 и более поздних версий. Мы рекомендуем использовать это решение для обеспечения переносимости и простоты обслуживания.

```cpp
// C4471b.cpp
// Compile with: cl /c /w14471 C4471b.cpp
enum Example;    // C4471
// To fix, replace the line above with the enumeration definition:
// enum Example { item = 0x80000000UL };
// ...
```

В C++ 11 можно добавить явный тип в перечисление неограниченного уровня и на его прямое объявление. Это решение рекомендуется использовать только в том случае, если сложная логика включения заголовка предотвращает использование определения вместо прямого объявления. Это решение может привести к проблемам с обслуживанием. при изменении базового типа, используемого для определения перечисления, необходимо также изменить все перенаправленные объявления на Match или в коде могут возникать ошибки. Чтобы избежать этой проблемы, можно разместить прямую декларацию в файле заголовка.

```cpp
// C4471c.cpp
// Client code for enumeration defined in C4471d.cpp
// Compile with: cl /c /w14471 C4471c.cpp C4471d.cpp
enum Example;    // C4471, int assumed
// To fix, replace the lines above with the forward declarations:
// enum Example : unsigned;
// ...
```

```cpp
// C4471d.cpp
// Definition for enumeration used in C4471c.cpp
// Compile with: cl /c /w14471 C4471c.cpp C4471d.cpp
enum Example : unsigned { item = 0x80000000 }; // explicit type
// ...
```

Если для перечисления указан явный тип, рекомендуется также включить предупреждение [C4369](compiler-warning-level-1-C4369.md), которое включено по умолчанию. Это определяет случаи, когда для элемента перечисления требуется тип, отличный от типа явно указанного.

Вы можете изменить код, чтобы использовать перечисление с заданной областью, новую функцию в C++ 11. Как определение, так и любой клиентский код, использующий тип перечисления, необходимо изменить, чтобы использовать перечисление с заданной областью. Рекомендуется использовать перечисление с заданной областью, если возникли проблемы с засорением пространства имен, так как имена определенных элементов перечисления ограничены областью перечисления. Другой компонент перечисления с областью видимости заключается в том, что его члены не могут быть неявно преобразованы в другой тип целого числа или перечисления, что может быть источником незначительных ошибок.

```cpp
// C4471e.cpp
// Client code for scoped enumeration defined in C4471f.cpp
// Compile with: cl /c /w14471 C4471e.cpp C4471f.cpp
enum Example;    // C4471
// To fix, replace the line above with the forward declaration:
// enum class Example;
// ...
```

```cpp
// C4471f.cpp
// Definition for scoped enumeration used in C4471e.cpp
// Compile with: cl /c /w14471 C4471e.cpp C4471f.cpp
enum class Example { item = 0 };
// ...
```
