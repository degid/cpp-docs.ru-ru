---
title: __hook
ms.date: 11/04/2016
f1_keywords:
- __hook_cpp
helpviewer_keywords:
- __hook keyword [C++]
- event handlers [C++], connecting events to
ms.assetid: f4cabb10-d293-4c0e-a1d2-4745ef9cc22c
ms.openlocfilehash: 5a0eaf0a3bc0617dbcd1f43805af8a95291e7e47
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87188171"
---
# <a name="__hook"></a>__hook

Связывает метод обработчика с событием.

## <a name="syntax"></a>Синтаксис

```
long __hook(
    &SourceClass::EventMethod,
    source,
    &ReceiverClass::HandlerMethod
    [, receiver = this]
);
long __hook(
    interface,
    source
);
```

### <a name="parameters"></a>Параметры

*&SourceClass:: Евентмесод*<br/>
Указатель на метод события, к которому присоединяется метод обработчика событий.

- Собственные события C++: *SourceClass* является классом источника событий, а *евентмесод* — событием.

- COM-события: *SourceClass* — это интерфейс источника событий, а *евентмесод* — один из его методов.

- Управляемые события: *SourceClass* является классом источника событий, а *евентмесод* — событием.

*interface*<br/>
Имя интерфейса, подключенного к *получателю*, только для приемников событий COM, в которых параметром *layout_dependent* атрибута [event_receiver](../windows/attributes/event-receiver.md) является **`true`** .

*source*<br/>
Указатель на экземпляр источника события. В зависимости от кода `type` , указанного в `event_receiver` , *источником* может быть один из следующих:

- Собственный указатель на объект источника события.

- `IUnknown`Указатель на основе объекта (com-источник).

- Указатель на управляемый объект (для управляемых событий).

*&Рецеиверкласс:: Хандлермесод*<br/>
Указатель на метод обработчика событий, который необходимо присоединить к событию. Обработчик указывается как метод класса или ссылки на один и тот же объект. Если имя класса не указано, **`__hook`** предполагается, что класс будет называться.

- Собственные события C++: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

- COM-события: *рецеиверкласс* — это интерфейс приемника событий, который `HandlerMethod` является одним из его обработчиков.

- Управляемые события: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

*получателю*<br/>
Используемых Указатель на экземпляр класса приемника событий. Если получатель не указан, по умолчанию используется класс получателя или структура, в которой **`__hook`** вызывается.

## <a name="usage"></a>Использование

Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.

## <a name="remarks"></a>Примечания

Используйте встроенную функцию **`__hook`** в приемнике событий, чтобы связать метод обработчика или привязать его к методу события. Затем, когда этот источник вызывает указанное событие, вызывается указанный обработчик. Можно подключить несколько обработчиков к одному событию или несколько событий к одному обработчику.

Существует две формы **`__hook`** . В большинстве случаев можно использовать первую форму (с четырьмя аргументами), в частности, для приемников событий COM, в которых параметром *layout_dependent* атрибута [event_receiver](../windows/attributes/event-receiver.md) является **`false`** .

В таких случаях не требуется присоединять все методы в интерфейсе перед порождением события в одном из методов; достаточно присоединить только метод, обрабатывающий событие. Вторую форму (с двумя аргументами) можно использовать **`__hook`** только для приемника событий COM, в котором *layout_dependent* **= true**.

**`__hook`** Возвращает значение типа long. Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создают исключение).

Компилятор проверяет наличие события и соответствие сигнатур события и делегата.

За исключением событий COM **`__hook`** и **`__unhook`** может вызываться за пределами приемника событий.

Альтернативой использованию **`__hook`** является использование оператора + =.

Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [event](../extensions/event-cpp-component-extensions.md).

> [!NOTE]
> Класс-шаблон или структура не могут содержать события.

## <a name="example"></a>Пример

Примеры см. [в разделе Обработка событий в машинном коде C++](../cpp/event-handling-in-native-cpp.md) и [Обработка событий в com](../cpp/event-handling-in-com.md) .

## <a name="see-also"></a>См. также раздел

[Ключевые слова](../cpp/keywords-cpp.md)<br/>
[Обработка событий](../cpp/event-handling.md)<br/>
[event_source](../windows/attributes/event-source.md)<br/>
[event_receiver](../windows/attributes/event-receiver.md)<br/>
[__unhook](../cpp/unhook.md)<br/>
[__raise](../cpp/raise.md)<br/>
