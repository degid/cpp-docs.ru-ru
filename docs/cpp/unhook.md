---
title: __unhook
ms.date: 11/04/2016
f1_keywords:
- __unhook
- __unhook_cpp
helpviewer_keywords:
- event handlers [C++], dissociating events
- __unhook keyword [C++]
ms.assetid: 953a14f3-5199-459d-81e5-fcf015a19878
ms.openlocfilehash: 84df5ad0ff27e6b09134b0f92f14f8e9b6fdc817
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87233578"
---
# <a name="__unhook"></a>__unhook

Отменяет связь метода обработчика с событием.

## <a name="syntax"></a>Синтаксис

```cpp
long  __unhook(
   &SourceClass::EventMethod,
   source,
   &ReceiverClass::HandlerMethod
   [, receiver = this]
);
long  __unhook(
   interface,
   source
);
long  __unhook(
   source
);
```

#### <a name="parameters"></a>Параметры

**&***SourceClass* `::` *Евентмесод* Указатель на метод события, из которого отменяется подключение метода обработчика событий:

- Собственные события C++: *SourceClass* является классом источника событий, а *евентмесод* — событием.

- COM-события: *SourceClass* — это интерфейс источника событий, а *евентмесод* — один из его методов.

- Управляемые события: *SourceClass* является классом источника событий, а *евентмесод* — событием.

*interface*<br/>
Имя интерфейса, которое отсоединяется от *получателя*, только для приемников событий COM, в которых параметром *layout_dependent* атрибута [event_receiver](../windows/attributes/event-receiver.md) является **`true`** .

*source*<br/>
Указатель на экземпляр источника события. В зависимости от кода `type` , указанного в `event_receiver` , *источником* может быть один из следующих:

- Собственный указатель на объект источника события.

- `IUnknown`Указатель на основе объекта (com-источник).

- Указатель на управляемый объект (для управляемых событий).

**&***Рецеиверкласс* `::` `HandlerMethod`Указатель на метод обработчика событий, который необходимо отсоединить от события. Обработчик указывается как метод класса или ссылки на один и тот же объект. Если имя класса не указано, **`__unhook`** предполагается, что класс будет называться.

- Собственные события C++: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

- COM-события: *рецеиверкласс* — это интерфейс приемника событий, который `HandlerMethod` является одним из его обработчиков.

- Управляемые события: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

*получатель*(необязательно) указатель на экземпляр класса приемника событий. Если получатель не указан, по умолчанию используется класс получателя или структура, в которой **`__unhook`** вызывается.

## <a name="usage"></a>Использование

Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.

## <a name="remarks"></a>Примечания

Используйте встроенную функцию **`__unhook`** в приемнике событий, чтобы отменить связь или отсоединить метод обработчика от метода события.

Существует три формы **`__unhook`** . В большинстве случаев можно использовать первую форму (четыре аргумента). Вторую форму (с двумя аргументами) можно использовать **`__unhook`** только для приемника событий COM; это позволяет отсоединить весь интерфейс событий. Третья форма (один аргумент) используется для отсоединения всех делегатов от указанного источника.

Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создадут исключение).

При вызове **`__unhook`** для события и обработчика событий, которые еще не были подключены, они не будут действовать.

Во время компиляции компилятор проверяет, что событие существует, и выполняет проверку типа параметра с указанным обработчиком.

За исключением событий COM **`__hook`** и **`__unhook`** может вызываться за пределами приемника событий.

Альтернативой использованию **`__unhook`** является использование оператора-=.

Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [event](../extensions/event-cpp-component-extensions.md).

> [!NOTE]
> Класс-шаблон или структура не могут содержать события.

## <a name="example"></a>Пример

Примеры см. [в разделе Обработка событий в машинном коде C++](../cpp/event-handling-in-native-cpp.md) и [Обработка событий в com](../cpp/event-handling-in-com.md) .

## <a name="see-also"></a>См. также статью

[Ключевые слова](../cpp/keywords-cpp.md)<br/>
[event_source](../windows/attributes/event-source.md)<br/>
[event_receiver](../windows/attributes/event-receiver.md)<br/>
[__event](../cpp/event.md)<br/>
[__hook](../cpp/hook.md)<br/>
[__raise](../cpp/raise.md)
