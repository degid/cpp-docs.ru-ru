---
title: __fastfail
ms.date: 09/02/2019
ms.assetid: 9cd32639-e395-4c75-9f3a-ac3ba7f49921
ms.openlocfilehash: 34198409c6a57eb494bfe819b367b71405a84e64
ms.sourcegitcommit: 6e1c1822e7bcf3d2ef23eb8fac6465f88743facf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/03/2019
ms.locfileid: "70222198"
---
# <a name="__fastfail"></a>__fastfail

**Блок, относящийся только к системам Microsoft**

Немедленно завершает вызывающий процесс с минимальными издержками.

## <a name="syntax"></a>Синтаксис

```C
void __fastfail(unsigned int code);
```

### <a name="parameters"></a>Параметры

*приведен*\
окне `FAST_FAIL_<description>` Символьная константа из Winnt.h или WDM.h, указывающая причину завершения процесса.

## <a name="return-value"></a>Возвращаемое значение

Встроенная `__fastfail` не возвращается.

## <a name="remarks"></a>Примечания

Встроенная функция предоставляет механизм для запроса *быстрого сбоя* — способ, с помощью которого потенциально поврежденный процесс запрашивает немедленное завершение процесса. `__fastfail` Критические сбои, которые могут привести к повреждению состояния программы и стека после восстановления, не могут быть обработаны обычным механизмом обработки исключений. Используйте `__fastfail` для завершения процесса с минимальными издержками.

Внутренне `__fastfail` реализуется с помощью несколько механизмов в зависимости от конкретной архитектуры:

|Архитектура|Инструкция|Расположение аргумента кода|
|------------------|-----------------|-------------------------------|
|x86|int 0x29|`ecx`|
|X64|int 0x29|`rcx`|
|ARM|Код операции 0xDEFB|`r0`|
|ARM64|Код операции 0xF003|`x0`|

Запрос быстрого сбоя является самодостаточным и обычно требует только две команды для выполнения. После выполнения запроса быстрого сбоя ядро выполняет соответствующее действие. В коде пользовательского режима отсутствуют зависимости памяти за пределами самого указателя инструкций, когда происходит событие быстрого сбоя. Это позволяет максимально повысить надежность даже в случае повреждения серьезной памяти.

Аргумент, одна `FAST_FAIL_<description>` из символьных констант из Winnt.h или WDM.h, описывает тип условия сбоя. `code` Он включен в отчеты о сбоях в конкретном окружении.

Запросы быстрого сбоя в пользовательском режиме отображаются в виде второго шанса непостоянного исключения с кодом исключения 0xC0000409 и по крайней мере с одним параметром исключения. Первый параметр исключения — значение `code` . Этот код исключения указывает на отчеты об ошибках Windows (WER) и инфраструктуру отладки, которая повреждена в процессе, и в ответ на ошибку должны быть выполнены минимальные выполняемые действия. Запросы быстрого сбоя в режиме ядра реализованы с помощью особого отладочного кода, `KERNEL_SECURITY_CHECK_FAILURE` (0x139). В обоих случаях обработчики исключений не вызываются, поскольку программа предположительно в поврежденном состоянии. При наличии отладчика можно проверить состояние программы перед завершением работы.

Поддержка собственного механизма быстрого сбоя началась с Windows 8. Операционные системы Windows, которые изначально не поддерживают инструкцию быстрого сбоя, обычно обрабатывают запросы быстрого сбоя в случае нарушения прав доступа или в `UNEXPECTED_KERNEL_MODE_TRAP` качестве критической ошибки. В этих случаях программа по-прежнему завершается, но не обязательно как можно быстрее.

`__fastfail`доступен только в качестве встроенного.

## <a name="requirements"></a>Требования

|Встроенная функция|Архитектура|
|---------------|------------------|
|`__fastfail`|x86, x64, ARM, ARM64|

**Заголовочный файл** \<> Intrin.h

**Завершение блока, относящегося только к системам Майкрософт**

## <a name="see-also"></a>См. также

[Встроенные функции компилятора](../intrinsics/compiler-intrinsics.md)
